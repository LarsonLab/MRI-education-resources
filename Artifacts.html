

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Artifacts &#8212; Principles of MRI</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=UA-51903906-1"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'UA-51903906-1');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Artifacts';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="RF Pulses" href="RF%20Pulses.html" />
    <link rel="prev" title="The MRI Signal Equation and K-space" href="MRI%20Signal%20Equation.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="Introduction.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/HPBrain-Anime.png" class="logo__image only-light" alt="Principles of MRI - Home"/>
    <script>document.write(`<img src="_static/HPBrain-Anime.png" class="logo__image only-dark" alt="Principles of MRI - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="Introduction.html">
                    Introduction to Principles of MRI
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Magnetic Resonance Physics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="MRI%20System.html">The MRI System</a></li>
<li class="toctree-l1"><a class="reference internal" href="Spin%20Physics.html">Spin Physics</a></li>
<li class="toctree-l1"><a class="reference internal" href="MR%20Physics%20-%20Bloch%20Equation.html">Bloch Equation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Magnetic%20Fields%20and%20RF%20Coils.html">Magnetic fields in MRI</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">MR Experiment</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Pulse%20Sequence.html">The Pulse Sequence</a></li>
<li class="toctree-l1"><a class="reference internal" href="Gradient%20and%20Spin%20Echoes.html">Gradient and Spin Echo Pulse Sequences</a></li>
<li class="toctree-l1"><a class="reference internal" href="MRI%20Contrast.html">MRI Contrast</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Image Formation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Spatial%20Encoding.html">Spatial Encoding</a></li>
<li class="toctree-l1"><a class="reference internal" href="Image%20Reconstruction.html">Image Reconstruction</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Image Characteristics</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Signal%20to%20Noise%20Ratio.html">Signal to Noise Ratio (SNR)</a></li>

<li class="toctree-l1"><a class="reference internal" href="FOV%20and%20Resolution.html">Field of View (FOV) and Resolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="MRI%20Signal%20Equation.html">The MRI Signal Equation and K-space</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Artifacts</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Radiofrequency Pulses</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="RF%20Pulses.html">RF Pulses</a></li>
<li class="toctree-l1"><a class="reference internal" href="Spectral-Spatial%20RF%20Pulses.html">Spectral-Spatial RF Pulses</a></li>
<li class="toctree-l1"><a class="reference internal" href="Fun%20with%20RF%20Pulses.html">Fun with RF Pulses?</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Fast Imaging</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Fast%20Imaging%20Pulse%20Sequences.html">Fast Imaging Pulse Sequences</a></li>
<li class="toctree-l1"><a class="reference internal" href="Accelerated%20Imaging%20Methods.html">Accelerated Imaging Methods</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Summary</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Key%20MRI%20Concepts.html">Key MRI Concepts and Equations</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Reference Material</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="MRI%20Notation.html">MRI Notation and Terminology</a></li>
<li class="toctree-l1"><a class="reference internal" href="MRI%20Math%20Concepts.html">MRI Math Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="Software_Resources.html">MRI Software Resources</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/larsonlab/MRI-education-resources" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/larsonlab/MRI-education-resources/issues/new?title=Issue%20on%20page%20%2FArtifacts.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Artifacts.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Artifacts</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-goals">Learning Goals</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#artifact-comparison">Artifact Comparison</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#displacement-artifacts">Displacement Artifacts</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#motion-and-flow-artifacts">Motion and Flow Artifacts</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simulations-of-artifacts">Simulations of Artifacts</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">setup</span> <span class="n">MRI</span><span class="o">-</span><span class="n">education</span><span class="o">-</span><span class="n">resources</span> <span class="n">path</span> <span class="ow">and</span> <span class="n">requirements</span>
<span class="n">cd</span> <span class="o">../</span>
<span class="n">startup</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>loading image
loading signal
</pre></div>
</div>
</div>
</div>
<section class="tex2jax_ignore mathjax_ignore" id="artifacts">
<h1>Artifacts<a class="headerlink" href="#artifacts" title="Permalink to this heading">#</a></h1>
<p>This notebook includes a simulation of various MRI artifacts, as well as a high-level Artifact Comparison below.  The wikipedia entry <a class="reference external" href="https://en.wikipedia.org/wiki/MRI_artifact">https://en.wikipedia.org/wiki/MRI_artifact</a> is also very comprehensive.</p>
<section id="learning-goals">
<h2>Learning Goals<a class="headerlink" href="#learning-goals" title="Permalink to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Identify artifacts and how to mitigate them</p></li>
</ol>
</section>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading">#</a></h2>
<p>Many of the artifacts that occur in MRI can be understood and analyzed using the k-space perspective.  In particular, they can be understood as the k-space data being modified by some function.  This is described mathematically in
<a class="reference internal" href="MRI%20Signal%20Equation.html"><span class="doc std std-doc">MRI Signal Equation and K-space</span></a> in the K-space Data Weighting section.</p>
</section>
<section id="artifact-comparison">
<h2>Artifact Comparison<a class="headerlink" href="#artifact-comparison" title="Permalink to this heading">#</a></h2>
<p>MRI artifacts can generally be categorized as originating from the sample, the sequence, or the system (Source in table below).  The table below provides a high-level comparison of these artifacts.</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Artifact Name</p></th>
<th class="head"><p>Source</p></th>
<th class="head"><p>Appearance</p></th>
<th class="head"><p>What to do?</p></th>
<th class="head"><p>Frequency or Phase encoding</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Aliasing</p></td>
<td><p>Sequence - FOV too small</p></td>
<td><p>Signal folds across image</p></td>
<td><p>Increase FOV, swap PE/FE</p></td>
<td><p>Phase encoding</p></td>
</tr>
<tr class="row-odd"><td><p>Gibbs Ringing/Truncation</p></td>
<td><p>Sequence - due to Fourier encoding of edges</p></td>
<td><p>Ripples/ringing at sharp edges</p></td>
<td><p>Filtering of data</p></td>
<td><p>N/A</p></td>
</tr>
<tr class="row-even"><td><p>Boundary Artifacts/Partial Volume</p></td>
<td><p>Sequence and Sample - opposite <span class="math notranslate nohighlight">\(M_{XY}\)</span> phases with a voxel due to inversion or chemical shift</p></td>
<td><p>Artificial dark lines at tissue boundaries</p></td>
<td><p>fat suppresion, fat/water imaging</p></td>
<td><p>N/A</p></td>
</tr>
<tr class="row-odd"><td><p>Motion/Flow</p></td>
<td><p>Sample - signal modulated during spatial encoding</p></td>
<td><p>Copies or “Ghosts” of image regions that are changing due to motion or flow</p></td>
<td><p>Breath-hold, gating, triggering, flow compensation, swap PE/FE</p></td>
<td><p>Phase encoding</p></td>
</tr>
<tr class="row-even"><td><p>Image Displacement/Distortion</p></td>
<td><p>Sample - chemical shift (fat) and off-resonance (e.g. magnetic susceptibility differences)</p></td>
<td><p>Shifts in image</p></td>
<td><p>Increase bandwidths, shimming, fat suppression, fat/water imaging, swap PE/FE</p></td>
<td><p>Frequency encoding (2DFT), Phase encoding (EPI)</p></td>
</tr>
<tr class="row-odd"><td><p>Slice Displacement</p></td>
<td><p>Sample chemical shift (fat) and off-resonance (e.g. magnetic susceptibility differences)</p></td>
<td><p>Slice location shifts</p></td>
<td><p>Increase RF bandwidth, shimming, 3D</p></td>
<td><p>N/A</p></td>
</tr>
<tr class="row-even"><td><p>T2*</p></td>
<td><p>Sample - magnetic suscpetibility differences (e.g. implants, air)</p></td>
<td><p>Signal loss</p></td>
<td><p>Spin-echo, shimming</p></td>
<td><p>N/A</p></td>
</tr>
<tr class="row-odd"><td><p>Dielectric Shading</p></td>
<td><p>System - RF propogates unevenly, creating B1 inhomogeneity</p></td>
<td><p>Shading across entire image, particularly large FOV, higher B0</p></td>
<td><p>B1-insensitive pulse sequences (e.g. adiabatic pulses), image bias correction</p></td>
<td><p>N/A</p></td>
</tr>
<tr class="row-even"><td><p>RF interference/Zipper</p></td>
<td><p>System - unwanted RF signal in data</p></td>
<td><p>Line of noisy signal on top of image</p></td>
<td><p>RF shielding (close door), check RF hardware, check room lights</p></td>
<td><p>At a specific frequency encoding location</p></td>
</tr>
<tr class="row-odd"><td><p>Gradient non-linearity</p></td>
<td><p>System - magnetic field gradients are not linear, especially away from isocenter</p></td>
<td><p>Distortion of subject, particularly near edges of large FOV</p></td>
<td><p>Gradient warping correction</p></td>
<td><p>N/A</p></td>
</tr>
<tr class="row-even"><td><p>Spike Noise</p></td>
<td><p>System - intermittent unwanted signal</p></td>
<td><p>Specific spatial frequency on top of entire image</p></td>
<td><p>check RF hardware (loose connections, broken components)</p></td>
<td><p>N/A</p></td>
</tr>
</tbody>
</table>
</section>
<section id="displacement-artifacts">
<h2>Displacement Artifacts<a class="headerlink" href="#displacement-artifacts" title="Permalink to this heading">#</a></h2>
<p>Since MRI relies on frequency to encode spatial information, unknown frequency shifts can lead to disortions of the image.  These frequency shifts are due to chemical shift (e.g. fat) and/or off-resonance (e.g. main field inhomogeneities, susceptibility differences).</p>
<p>There will be a shift during frequency encoding of</p>
<div class="math notranslate nohighlight">
\[\Delta_{FE} = \frac{\Delta f}{RBW} FOV_{FE}\]</div>
<p>where <span class="math notranslate nohighlight">\(\Delta f\)</span> is the frequency shift, <span class="math notranslate nohighlight">\(RBW\)</span> is the receiver bandwidth, and <span class="math notranslate nohighlight">\(FOV_{FE}\)</span> is the field of view in the frequency encoding direction.</p>
<p>During EPI, there is typically a much larger shift in the phase encoding direction that depends on the echo spacing, <span class="math notranslate nohighlight">\(t_{esp}\)</span>.  For simplicity, I convert the echo spacing into a “phase encoding bandwidth”, <span class="math notranslate nohighlight">\(BW_{PE} = 1/t_{esp}\)</span>:</p>
<div class="math notranslate nohighlight">
\[\Delta_{PE} = \frac{\Delta f}{BW_{PE} N_{interleaves}} FOV_{PE}\]</div>
<p>where <span class="math notranslate nohighlight">\(N_{interleaves}\)</span> is the number of interleaves that can be used to reduce the displacement.</p>
<p>Finally, there will also be a displacement of the slice selection, and this will be</p>
<div class="math notranslate nohighlight">
\[\Delta_{SS} = \frac{\Delta f}{BW_{rf}} \Delta_z\]</div>
<p>where <span class="math notranslate nohighlight">\(BW_{rf}\)</span> is the slice select pulse bandwidth.</p>
</section>
<section id="motion-and-flow-artifacts">
<h2>Motion and Flow Artifacts<a class="headerlink" href="#motion-and-flow-artifacts" title="Permalink to this heading">#</a></h2>
<p>Motion, including flow, can result in artifacts in MRI if it leads to inconsistency in the data.</p>
<p>Periodic motion such as breathing, heart beating, and pulsatile flow will lead to distinct ghosting artifacts in the phase encoding direction.  The location of ghosting artifacts in sequential phase encoding, will be at predictable intervals in the phase encoding direction:</p>
<div class="math notranslate nohighlight">
\[\Delta_{PE} = \frac{TR}{T_{motion}} FOV_{PE}\]</div>
<p>where <span class="math notranslate nohighlight">\(T_{motion}\)</span> is the period of the motion (e.g. <span class="math notranslate nohighlight">\(T_{motion} = 1 s\)</span> for a heart rate of 60 beats per minute ).</p>
<p>Incoherent or more random motion such as irregular breathing, arrhytthmias, coughing, bulk motion will lead to more diffuse ghosting artifacts.</p>
</section>
<section id="simulations-of-artifacts">
<h2>Simulations of Artifacts<a class="headerlink" href="#simulations-of-artifacts" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">load</span> <span class="n">k</span><span class="o">-</span><span class="n">space</span> <span class="n">data</span>
<span class="n">dataname</span> <span class="o">=</span> <span class="s1">&#39;Data/se_t1_sag_data&#39;</span><span class="p">;</span>
<span class="n">load</span><span class="p">(</span><span class="n">dataname</span><span class="p">)</span>
<span class="n">kdata</span> <span class="o">=</span> <span class="n">data</span><span class="p">;</span>
<span class="n">S</span> <span class="o">=</span> <span class="n">size</span><span class="p">(</span><span class="n">kdata</span><span class="p">);</span>

<span class="n">im_original</span> <span class="o">=</span> <span class="n">ifft2c</span><span class="p">(</span><span class="n">kdata</span><span class="p">);</span>

<span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">imagesc</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">kdata</span><span class="p">)),</span> <span class="p">[</span><span class="mi">0</span> <span class="nb">max</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">kdata</span><span class="p">(:))))])</span>
<span class="n">colormap</span><span class="p">(</span><span class="n">gray</span><span class="p">),</span> <span class="n">axis</span> <span class="n">equal</span> <span class="n">tight</span> <span class="n">off</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<span class="n">imagesc</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">im_original</span><span class="p">),</span> <span class="p">[</span><span class="mi">0</span> <span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">im_original</span><span class="p">(:)))])</span>
<span class="n">colormap</span><span class="p">(</span><span class="n">gray</span><span class="p">),</span> <span class="n">axis</span> <span class="n">equal</span> <span class="n">tight</span> <span class="n">off</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>warning: load: &#39;C:\Users\PLarson\Documents\GitHub\MRI-education-resources\Data\se_t1_sag_data.mat&#39; found by searching load path
</pre></div>
</div>
<img alt="_images/ea82c69832987a9d5fb820bf9ec303da3abfa36fc3c9b49936b9b5b0cf324801.png" src="_images/ea82c69832987a9d5fb820bf9ec303da3abfa36fc3c9b49936b9b5b0cf324801.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span> <span class="n">aliasing</span>
<span class="n">N_undersamp</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>  <span class="o">%</span> <span class="o">&gt;=</span> <span class="mi">1</span>
<span class="n">data_undersamp</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">kdata</span><span class="p">));</span>
<span class="n">Iundersamp</span> <span class="o">=</span> <span class="mi">1</span><span class="p">:</span><span class="n">N_undersamp</span><span class="p">:</span><span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="n">data_undersamp</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">Iundersamp</span><span class="p">),:)</span> <span class="o">=</span> <span class="n">kdata</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">Iundersamp</span><span class="p">),:);</span>
<span class="n">im_undersamp</span> <span class="o">=</span> <span class="n">ifft2c</span><span class="p">(</span><span class="n">data_undersamp</span><span class="p">);</span>


<span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">imagesc</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">data_undersamp</span><span class="p">)),</span> <span class="p">[</span><span class="mi">0</span> <span class="nb">max</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">kdata</span><span class="p">(:))))])</span>
<span class="n">colormap</span><span class="p">(</span><span class="n">gray</span><span class="p">),</span> <span class="n">axis</span> <span class="n">equal</span> <span class="n">tight</span> <span class="n">off</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<span class="n">imagesc</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">im_undersamp</span><span class="p">),</span> <span class="p">[</span><span class="mi">0</span> <span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">im_original</span><span class="p">(:)))])</span>
<span class="n">colormap</span><span class="p">(</span><span class="n">gray</span><span class="p">),</span> <span class="n">axis</span> <span class="n">equal</span> <span class="n">tight</span> <span class="n">off</span>

</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/fff59d61f65e59d048cdb69f435b538b205434c6ad6d87248ce8e2dca0897b6d.png" src="_images/fff59d61f65e59d048cdb69f435b538b205434c6ad6d87248ce8e2dca0897b6d.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span> <span class="n">spike</span> <span class="n">noise</span>
<span class="n">spike_location</span> <span class="o">=</span> <span class="p">[</span><span class="mf">.6</span> <span class="mf">.53</span><span class="p">];</span>

<span class="n">data_spike</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">kdata</span><span class="p">));</span>
<span class="n">data_spike</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">spike_location</span><span class="p">(</span><span class="mi">1</span><span class="p">)),</span> <span class="nb">round</span><span class="p">(</span><span class="n">S</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">spike_location</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">kdata</span><span class="p">(:))</span><span class="o">/</span><span class="mf">1.5</span><span class="p">;</span>
<span class="n">im_spike</span> <span class="o">=</span> <span class="n">ifft2c</span><span class="p">(</span><span class="n">kdata</span> <span class="o">+</span> <span class="n">data_spike</span><span class="p">);</span>


<span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">imagesc</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">kdata</span> <span class="o">+</span> <span class="n">data_spike</span><span class="p">)),</span> <span class="p">[</span><span class="mi">0</span> <span class="nb">max</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">kdata</span><span class="p">(:))))])</span>
<span class="n">colormap</span><span class="p">(</span><span class="n">gray</span><span class="p">),</span> <span class="n">axis</span> <span class="n">equal</span> <span class="n">tight</span> <span class="n">off</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<span class="n">imagesc</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">im_spike</span><span class="p">),</span> <span class="p">[</span><span class="mi">0</span> <span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">im_original</span><span class="p">(:)))])</span>
<span class="n">colormap</span><span class="p">(</span><span class="n">gray</span><span class="p">),</span> <span class="n">axis</span> <span class="n">equal</span> <span class="n">tight</span> <span class="n">off</span>

</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/31ef484910bf1dd3b1901babe193e62d75a4a3a3972a7dea430aedf6e02fcac5.png" src="_images/31ef484910bf1dd3b1901babe193e62d75a4a3a3972a7dea430aedf6e02fcac5.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span> <span class="n">Ringing</span> <span class="p">(</span><span class="k">with</span> <span class="n">rect</span> <span class="nb">object</span><span class="p">)</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">32</span><span class="p">;</span>
<span class="n">kx</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">:</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">N</span><span class="p">;</span>
<span class="n">N_rect</span> <span class="o">=</span> <span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span><span class="p">;</span>
<span class="n">kdata</span> <span class="o">=</span> <span class="n">sinc</span><span class="p">(</span><span class="n">kx</span> <span class="o">*</span><span class="n">N_rect</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39; * sinc(kx *N_rect);</span>

<span class="n">rect_ringing</span> <span class="o">=</span> <span class="n">ifft2c</span><span class="p">(</span><span class="n">kdata</span><span class="p">);</span>

<span class="n">subplot</span><span class="p">(</span><span class="mi">221</span><span class="p">)</span>
<span class="n">imagesc</span><span class="p">((</span><span class="nb">abs</span><span class="p">(</span><span class="n">kdata</span><span class="p">)),</span> <span class="p">[</span><span class="mi">0</span> <span class="p">(</span><span class="mi">1</span><span class="p">)])</span>
<span class="n">colormap</span><span class="p">(</span><span class="n">gray</span><span class="p">),</span> <span class="n">axis</span> <span class="n">equal</span> <span class="n">tight</span> <span class="n">off</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">222</span><span class="p">)</span>
<span class="n">imagesc</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">rect_ringing</span><span class="p">),</span> <span class="p">[</span><span class="mi">0</span> <span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">rect_ringing</span><span class="p">(:)))])</span>
<span class="n">colormap</span><span class="p">(</span><span class="n">gray</span><span class="p">),</span> <span class="n">axis</span> <span class="n">equal</span> <span class="n">tight</span> <span class="n">off</span>
<span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Ringing&#39;</span><span class="p">)</span>

<span class="n">kdata_windowed</span> <span class="o">=</span> <span class="n">kdata</span> <span class="o">.*</span> <span class="p">(</span><span class="n">hamming</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="n">hamming</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;);</span>
<span class="n">rect_windowed</span> <span class="o">=</span> <span class="n">ifft2c</span><span class="p">(</span><span class="n">kdata_windowed</span><span class="p">);</span>


<span class="n">subplot</span><span class="p">(</span><span class="mi">223</span><span class="p">)</span>
<span class="n">imagesc</span><span class="p">((</span><span class="nb">abs</span><span class="p">(</span><span class="n">kdata_windowed</span><span class="p">)),</span> <span class="p">[</span><span class="mi">0</span> <span class="p">(</span><span class="mi">1</span><span class="p">)])</span>
<span class="n">colormap</span><span class="p">(</span><span class="n">gray</span><span class="p">),</span> <span class="n">axis</span> <span class="n">equal</span> <span class="n">tight</span> <span class="n">off</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">224</span><span class="p">)</span>
<span class="n">imagesc</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">rect_windowed</span><span class="p">),</span> <span class="p">[</span><span class="mi">0</span> <span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">rect_windowed</span><span class="p">(:)))])</span>
<span class="n">colormap</span><span class="p">(</span><span class="n">gray</span><span class="p">),</span> <span class="n">axis</span> <span class="n">equal</span> <span class="n">tight</span> <span class="n">off</span>
<span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Windowed&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/627b77b971d883360a4663a57e9447bf755cf2edb90fbf9a89b78f41d39d97bc.png" src="_images/627b77b971d883360a4663a57e9447bf755cf2edb90fbf9a89b78f41d39d97bc.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span> <span class="n">RF</span> <span class="n">interference</span>
<span class="n">relative_RF_frequency</span> <span class="o">=</span> <span class="mf">0.6</span><span class="p">;</span>

<span class="o">%</span><span class="n">single</span> <span class="n">frequency</span><span class="p">,</span> <span class="n">phase</span> <span class="n">modulated</span>
<span class="n">ph_int</span> <span class="o">=</span> <span class="n">pi</span><span class="o">*</span><span class="n">rand</span><span class="p">(</span><span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">);</span>
<span class="n">rfint</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span> <span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">)]</span> <span class="o">*</span><span class="n">relative_RF_frequency</span><span class="o">/</span><span class="mi">2</span> <span class="p">)</span> <span class="o">*</span>  <span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">kdata</span><span class="p">(:)))</span><span class="o">/</span><span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mf">1.5</span><span class="p">;</span>
<span class="n">data_rfint</span> <span class="o">=</span> <span class="n">repmat</span><span class="p">(</span><span class="n">rfint</span><span class="p">,</span> <span class="p">[</span><span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">])</span> <span class="o">.*</span> <span class="n">repmat</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="n">ph_int</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">S</span><span class="p">(</span><span class="mi">2</span><span class="p">)]);</span>
<span class="n">im_rfint</span> <span class="o">=</span> <span class="n">ifft2c</span><span class="p">(</span><span class="n">kdata</span> <span class="o">+</span> <span class="n">data_rfint</span><span class="p">);</span>

<span class="n">figure</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">imagesc</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">kdata</span> <span class="o">+</span> <span class="n">data_rfint</span><span class="p">)),</span> <span class="p">[</span><span class="mi">0</span> <span class="nb">max</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">kdata</span><span class="p">(:))))])</span>
<span class="n">colormap</span><span class="p">(</span><span class="n">gray</span><span class="p">),</span> <span class="n">axis</span> <span class="n">equal</span> <span class="n">tight</span> <span class="n">off</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<span class="n">imagesc</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">im_rfint</span><span class="p">),</span> <span class="p">[</span><span class="mi">0</span> <span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">im_original</span><span class="p">(:)))])</span>
<span class="n">colormap</span><span class="p">(</span><span class="n">gray</span><span class="p">),</span> <span class="n">axis</span> <span class="n">equal</span> <span class="n">tight</span> <span class="n">off</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ca1efedabfd4c25ebe042a9d23e730ed5c96b84d494a7a91472b7c5ff43915a2.png" src="_images/ca1efedabfd4c25ebe042a9d23e730ed5c96b84d494a7a91472b7c5ff43915a2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">RF</span> <span class="n">interference</span> <span class="o">-</span><span class="n">simulate</span> <span class="n">amplitude</span> <span class="n">modulated</span> <span class="n">interference</span>
<span class="n">relative_RF_frequency</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">;</span>
<span class="n">rfint</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span> <span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">)]</span><span class="o">/</span><span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">relative_RF_frequency</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span>  <span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">kdata</span><span class="p">(:)))</span><span class="o">/</span><span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span><span class="p">;</span>
<span class="n">data_rfint</span> <span class="o">=</span> <span class="n">randn</span><span class="p">(</span><span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">rfint</span><span class="p">;</span>
<span class="n">im_rfint</span> <span class="o">=</span> <span class="n">ifft2c</span><span class="p">(</span><span class="n">kdata</span> <span class="o">+</span> <span class="n">data_rfint</span><span class="p">);</span>

<span class="n">figure</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">imagesc</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">kdata</span> <span class="o">+</span> <span class="n">data_rfint</span><span class="p">)),</span> <span class="p">[</span><span class="mi">0</span> <span class="nb">max</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">kdata</span><span class="p">(:))))])</span>
<span class="n">colormap</span><span class="p">(</span><span class="n">gray</span><span class="p">),</span> <span class="n">axis</span> <span class="n">equal</span> <span class="n">tight</span> <span class="n">off</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<span class="n">imagesc</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">im_rfint</span><span class="p">),</span> <span class="p">[</span><span class="mi">0</span> <span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">im_original</span><span class="p">(:)))])</span>
<span class="n">colormap</span><span class="p">(</span><span class="n">gray</span><span class="p">),</span> <span class="n">axis</span> <span class="n">equal</span> <span class="n">tight</span> <span class="n">off</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/7a809d780b5224b493a41b101a6eb3e8d9a24cc1987f83d568ec280234a0a4af.png" src="_images/7a809d780b5224b493a41b101a6eb3e8d9a24cc1987f83d568ec280234a0a4af.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">RF</span> <span class="n">interference</span> <span class="o">-</span> <span class="n">simulate</span> <span class="n">frequency</span> <span class="n">modulated</span> <span class="n">interference</span>
<span class="n">relative_RF_frequency</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">randn</span><span class="p">(</span><span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">relative_RF_frequency</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
<span class="n">data_rfint</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span> <span class="n">f</span><span class="o">*</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">)]</span><span class="o">/</span><span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="p">)</span> <span class="o">*</span>  <span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">kdata</span><span class="p">(:)))</span><span class="o">/</span><span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mf">1.5</span><span class="p">;</span>
<span class="n">im_rfint</span> <span class="o">=</span> <span class="n">ifft2c</span><span class="p">(</span><span class="n">kdata</span> <span class="o">+</span> <span class="n">data_rfint</span><span class="p">);</span>

<span class="n">figure</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">imagesc</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">kdata</span> <span class="o">+</span> <span class="n">data_rfint</span><span class="p">)),</span> <span class="p">[</span><span class="mi">0</span> <span class="nb">max</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">kdata</span><span class="p">(:))))])</span>
<span class="n">colormap</span><span class="p">(</span><span class="n">gray</span><span class="p">),</span> <span class="n">axis</span> <span class="n">equal</span> <span class="n">tight</span> <span class="n">off</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<span class="n">imagesc</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">im_rfint</span><span class="p">),</span> <span class="p">[</span><span class="mi">0</span> <span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">im_original</span><span class="p">(:)))])</span>
<span class="n">colormap</span><span class="p">(</span><span class="n">gray</span><span class="p">),</span> <span class="n">axis</span> <span class="n">equal</span> <span class="n">tight</span> <span class="n">off</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b0a62903d5bba0f40549c6ad3128e19cf54016f795a724ae26a7fc7cf2642cb1.png" src="_images/b0a62903d5bba0f40549c6ad3128e19cf54016f795a724ae26a7fc7cf2642cb1.png" />
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "octave"
        },
        kernelOptions: {
            name: "octave",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'octave'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="MRI%20Signal%20Equation.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">The MRI Signal Equation and K-space</p>
      </div>
    </a>
    <a class="right-next"
       href="RF%20Pulses.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">RF Pulses</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-goals">Learning Goals</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#artifact-comparison">Artifact Comparison</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#displacement-artifacts">Displacement Artifacts</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#motion-and-flow-artifacts">Motion and Flow Artifacts</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simulations-of-artifacts">Simulations of Artifacts</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Peder Larson
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  Citation - DOI <a href="https://doi.org/10.5281/zenodo.5547020">10.5281/zenodo.5547020</a>
</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>