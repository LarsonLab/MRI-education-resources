

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Spin Physics &#8212; Principles of MRI</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=UA-51903906-1"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'UA-51903906-1');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Spin Physics';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="The MRI System" href="MRI%20System.html" />
    <link rel="prev" title="Introduction to Principles of MRI" href="Introduction.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="Introduction.html">
  
  
  
  
    
    
      
    
    
    <img src="_static/HPBrain-Anime.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="_static/HPBrain-Anime.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="Introduction.html">
                    Introduction to Principles of MRI
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">MR Physics</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Spin Physics</a></li>
<li class="toctree-l1"><a class="reference internal" href="MRI%20System.html">The MRI System</a></li>
<li class="toctree-l1"><a class="reference internal" href="MR%20Physics%20-%20Bloch%20Equation.html">Bloch Equation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Magnetic%20Fields%20and%20RF%20Coils.html">Magnetic fields in MRI</a></li>
<li class="toctree-l1"><a class="reference internal" href="MRI%20Contrast.html">MRI Contrast</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Image Formation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="MRI%20Signal%20Equation.html">Building Up the MRI Signal Equation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Spatial%20Encoding.html">Spatial Encoding</a></li>
<li class="toctree-l1"><a class="reference internal" href="Image%20Reconstruction.html">Image Reconstruction (In Progress Page)</a></li>
<li class="toctree-l1"><a class="reference internal" href="Signal%20to%20Noise%20Ratio.html">Signal to Noise Ratio (SNR)</a></li>

<li class="toctree-l1"><a class="reference internal" href="Artifacts.html">Artifacts</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">RF Pulses</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="RF%20Pulses.html">RF Pulses</a></li>
<li class="toctree-l1"><a class="reference internal" href="Spectral-Spatial%20RF%20Pulses.html">Spectral-Spatial RF Pulses</a></li>
<li class="toctree-l1"><a class="reference internal" href="Fun%20with%20RF%20Pulses.html">Fun? RF Pulses?</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Reference Material</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="MRI%20Notation.html">MRI Notation</a></li>
<li class="toctree-l1"><a class="reference internal" href="MRI%20Math%20Concepts.html">MRI Math Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="Software_Resources.html">MRI Software Resources</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/larsonlab/MRI-education-resources" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/larsonlab/MRI-education-resources/issues/new?title=Issue%20on%20page%20%2FSpin Physics.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Spin Physics.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Spin Physics</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-goals">Learning Goals</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nuclear-spin">Nuclear Spin</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#polarization">Polarization</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#equilibrium-magnetization">Equilibrium Magnetization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fractional-polarization">Fractional Polarization</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#resonance">Resonance</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#resonance-frequency">Resonance Frequency</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simulation-of-resonance">Simulation of Resonance</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#precession">Precession</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#excitation">Excitation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simulation-of-precession">Simulation of Precession</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#relaxation">Relaxation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simulation-of-relaxation">Simulation of Relaxation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#relaxation-equations">Relaxation Equations</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="spin-physics">
<h1>Spin Physics<a class="headerlink" href="#spin-physics" title="Permalink to this heading">#</a></h1>
<p>Before opening up the MRI scanner, we must first understand what is fundamentally being measured by MRI, which are nuclear “spins”, and how they behave in a magnetic field which includes the resonance phenomenom that forms the basis of MRI.</p>
<section id="learning-goals">
<h2>Learning Goals<a class="headerlink" href="#learning-goals" title="Permalink to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Understand what MRI is measuring</p></li>
<li><p>Describe the concepts of polarization, resonance, and relaxation</p></li>
</ol>
</section>
<section id="nuclear-spin">
<h2>Nuclear Spin<a class="headerlink" href="#nuclear-spin" title="Permalink to this heading">#</a></h2>
<p>A nuclear spin is defined as a nucleus with a non-zero net angular momentum.  This means that the nucleus has a net magnetic moment, <span class="math notranslate nohighlight">\(\mu\)</span>, meaning it can act as a small magnet.  It also experiences magnetic resonance, which means it will respond to a specific frequency of electromagnetic fields.  This resonance is the basis for the MRI signal.</p>
<p>In MRI, we are tyipcally imaging hydrogen nuclei (<span class="math notranslate nohighlight">\(^1 H\)</span>) which are about 80% of the atoms in our bodies.  The primary source of <span class="math notranslate nohighlight">\(^1 H\)</span>, also referred to as protons, is water, although protons in lipids are also imaged.</p>
<p>Other nuclei also have spin, including <span class="math notranslate nohighlight">\(^{13}C, ^{19}F, ^{23}Na, ^{31}P\)</span>, but these are much less abundant and thus have less available signal compared to protons.</p>
</section>
<section id="polarization">
<h2>Polarization<a class="headerlink" href="#polarization" title="Permalink to this heading">#</a></h2>
<p>In the absence of a magnetic field, nuclear spins will be randomly aligned.  However when spins experience a magnetic field, they will preferentially align with that magnetic field.  In MRI, we cannot measure individual spins, but we observe the ensemble of spins,  which is is known as the Net Magnetization, <span class="math notranslate nohighlight">\(\vec{M}(\vec{r},t)\)</span>.</p>
<p>FIGURES</p>
<p>Equilibrium magnetization before and after application of a strong magnetic field that polarizes the spins as reflected in increased density of arrows in the direction of the field (here vertical).  The large arrow pointing up represents the sum of all these spins, or the Net Magnetization. Source <a class="reference external" href="https://www.drcmr.dk/mr">https://www.drcmr.dk/mr</a></p>
<section id="equilibrium-magnetization">
<h3>Equilibrium Magnetization<a class="headerlink" href="#equilibrium-magnetization" title="Permalink to this heading">#</a></h3>
<p>In MRI, we define the main magnetic field, <span class="math notranslate nohighlight">\(B_0\)</span>, to be oriented along the z-axis.  When a subject is placed in a MRI scanner, the equilibrium magnetic field is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\vec{B}(\vec{r},0) = 
\begin{bmatrix}
0 \\
0 \\
B_0 
\end{bmatrix}\end{split}\]</div>
<p>Under this condition of equilibrium, the net magnetization is oriented in the direction of the main magnetic field</p>
<div class="math notranslate nohighlight">
\[\begin{split}\vec{M}(\vec{r},0) = 
\begin{bmatrix}
0 \\
0 \\
M_0(\vec{r})
\end{bmatrix}\end{split}\]</div>
<p>And has an amplitude of that is defined as the Equilibrium Magnetization:</p>
<div class="math notranslate nohighlight">
\[M_0(\vec{r}) = \frac{N(\vec{r}) \bar{\gamma}^2 h^2 I_Z (I_Z +1) B_0}{3 k T}\]</div>
<p>that depends on</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N(\vec{r})\)</span> is the spin density</p></li>
<li><p><span class="math notranslate nohighlight">\(h\)</span> is the Planck constant (<span class="math notranslate nohighlight">\(6.63 \times 10^{-34}\)</span> J/Hz)</p></li>
<li><p><span class="math notranslate nohighlight">\(\bar{\gamma}\)</span> is the gyromagnetic ratio (<span class="math notranslate nohighlight">\(42.58 \times 10^6\)</span> Hz/T for hydrogen)</p></li>
<li><p><span class="math notranslate nohighlight">\(B_0\)</span> is the magnetic field (e.g. 3 T)</p></li>
<li><p><span class="math notranslate nohighlight">\(I_Z\)</span> is the spin number (1/2 for hydrogen)</p></li>
<li><p><span class="math notranslate nohighlight">\(k\)</span> is Boltzmann’s constant (<span class="math notranslate nohighlight">\(1.38 \times 10^{-23}\)</span> J/K)</p></li>
<li><p><span class="math notranslate nohighlight">\(T\)</span> is temperature (human body temperature = 310 K)</p></li>
</ul>
</section>
<section id="fractional-polarization">
<h3>Fractional Polarization<a class="headerlink" href="#fractional-polarization" title="Permalink to this heading">#</a></h3>
<p>Another helpful formulation to describe the preference of spins to align with the magnetic field is to look at the fraction of spins that, if observed, would be aligned with the magnetic field.  This can be done using the Boltzman distribution that describes the ratio of spins in the spin-up, <span class="math notranslate nohighlight">\(N_\uparrow\)</span>, to the spin-down, <span class="math notranslate nohighlight">\(N_-\)</span>, states.</p>
<div class="math notranslate nohighlight">
\[ \frac{N_\uparrow}{N_\downarrow} = e^{h \bar{\gamma} B_0 / kT}\]</div>
<p>(This can also be used to derive the equilibrium magnetization above.)</p>
<p>From this distribution, a fractional polarization can be defined as the difference between spin up and spin down states, divided by the total number of spins, which describes the fraction of spins that contribute to the MR signal:</p>
<div class="math notranslate nohighlight">
\[P = \frac{N_\uparrow - N_\downarrow}{N_\uparrow + N_\downarrow} = \frac{ 1 - e^{-h \bar{\gamma} B_0 / kT} }{ 1 + e^{-h \bar{\gamma} B_0 / kT} }\]</div>
<p>If the exponent is small (or, when the polarization is low), this simplifies to</p>
<div class="math notranslate nohighlight">
\[ P = \frac{N_\uparrow - N_\downarrow}{N_\uparrow + N_\downarrow} \approx \frac{h \bar{\gamma} B_0}{2 kT}\]</div>
<p>Suppose we are studying protons in a “high” 3 T magnetic field in the human body (temperature is 310 K), how many spins are mismatched and contribute to detectable signal?</p>
<p>The answer is <span class="math notranslate nohighlight">\(P \approx 0.0000099\)</span>, around 10 ppm, which means out of every million spins in the sample only about 10 are unmatched don’t have a partner in the high energy state and are giving NMR signal. For this reason we say NMR is actually a pretty <strong>insensitive</strong>!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-octave notranslate"><div class="highlight"><pre><span></span><span class="n">B0</span> <span class="p">=</span> <span class="mi">3</span><span class="p">;</span> <span class="c">% T</span>
<span class="n">h</span> <span class="p">=</span> <span class="mf">6.63e-34</span><span class="p">;</span> <span class="c">% J/Hz</span>
<span class="n">gammabar</span> <span class="p">=</span> <span class="mf">42.58e6</span><span class="p">;</span> <span class="c">% Hz/T</span>
<span class="n">k</span> <span class="p">=</span> <span class="mf">1.38e-23</span><span class="p">;</span> <span class="c">% J/K</span>
<span class="n">T</span> <span class="p">=</span> <span class="mi">310</span><span class="p">;</span> <span class="c">% K</span>

<span class="n">P</span> <span class="p">=</span> <span class="n">h</span> <span class="o">*</span> <span class="n">gammabar</span> <span class="o">*</span> <span class="n">B0</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="n">T</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>warning: using the gnuplot graphics toolkit is discouraged

The gnuplot graphics toolkit is not actively maintained and has a number
of limitations that are ulikely to be fixed.  Communication with gnuplot
uses a one-directional pipe and limited information is passed back to the
Octave interpreter so most changes made interactively in the plot window
will not be reflected in the graphics properties managed by Octave.  For
example, if the plot window is closed with a mouse click, Octave will not
be notified and will not update it&#39;s internal list of open figure windows.
We recommend using the qt toolkit instead.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>P = 9.8985e-06
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="resonance">
<h2>Resonance<a class="headerlink" href="#resonance" title="Permalink to this heading">#</a></h2>
<p>When in a mangetic field, spins and therefore the net magnetization experience magnetic resonance, which means they will respond strongly to a specific frequency of electromagnetic fields.</p>
<p>An analogy for resonance is to consider a swing: In order to swing higher and higher, you must move your legs back and forth at the right rate.  If you move your legs at the wrong rate, you will simply not move much higher.</p>
<p>In MRI, we can perturb the net magnetization from equilibrium by applying a time-varying magnetic field (<span class="math notranslate nohighlight">\(B_1\)</span>) at the “resonance frequency”.  This will perturb or “tip” the net magnetization away its equilibrium where it is in alignment with the magnetic field.</p>
<section id="resonance-frequency">
<h3>Resonance Frequency<a class="headerlink" href="#resonance-frequency" title="Permalink to this heading">#</a></h3>
<p>The magnetic resonance frequency is proportional to the magnetic field amplitude</p>
<div class="math notranslate nohighlight">
\[f = \bar{\gamma} \|\vec{B}\|\]</div>
<p>When the magnetic field is simply our main field, <span class="math notranslate nohighlight">\(B_0\)</span>, then we get the so-called Larmor frequency</p>
<div class="math notranslate nohighlight">
\[f_0 = \bar{\gamma} B_0\]</div>
</section>
<section id="simulation-of-resonance">
<h3>Simulation of Resonance<a class="headerlink" href="#simulation-of-resonance" title="Permalink to this heading">#</a></h3>
<p>For this simulation use the <a class="reference external" href="https://www.drcmr.dk/CompassMR/">CompassMR</a> simulator for visualizing resonance.  To simulate</p>
<ol class="arabic simple">
<li><p>Start in the default compass mode, with an applied <span class="math notranslate nohighlight">\(B_0\)</span> field(default)</p></li>
<li><p>Move the <span class="math notranslate nohighlight">\(B_1\)</span> magnetic field slider - this should change the angle of the compass slightly</p></li>
<li><p>Now adjust the <span class="math notranslate nohighlight">\(B_1\)</span> freq(uency) slider - if you choose the correct frequency, then you should be able to create large oscillations in the compass</p></li>
<li><p>Change the main field, <span class="math notranslate nohighlight">\(B_0\)</span>, and see that now you need a new <span class="math notranslate nohighlight">\(B_1\)</span> freq(uency) to achieve resonance</p></li>
<li><p>Switch to using the Coil for <span class="math notranslate nohighlight">\(B_1\)</span> in the top right checkbox and repeat.  This is one step closer to a real experiment.</p></li>
</ol>
</section>
</section>
<section id="precession">
<h2>Precession<a class="headerlink" href="#precession" title="Permalink to this heading">#</a></h2>
<p>Precession refers to the rotation of the spins and therefore the net magnetization around the magnetic field.  This precession is part of the magnetic resonance phenomenom and is what creates signal in MRI.  The spins and net magnetization will rotate around the magnetic field, with the resonance frequency.</p>
<section id="excitation">
<h3>Excitation<a class="headerlink" href="#excitation" title="Permalink to this heading">#</a></h3>
<p>In order for precession to occur, the spins or net magnetization must not be aligned with the magnetic field.  As the nuclear spins are only preferentially aligned with the magnetic field, many of them will experience precession at any given time.  However, the net magnetization will be aligned with the magnetic field at equilibrium, and therefore will not precess.</p>
<p>To cause the net magnetization to precess, an time-varying magnetic field (<span class="math notranslate nohighlight">\(B_1\)</span>) is applied at the resonance frequency.  This perturbs the net magnetization away from alignment with the magnetic field, and it will continue to precess after the <span class="math notranslate nohighlight">\(B_1\)</span> field is turned off.</p>
<p>Once we have precession of the net magnetization, it creates a time-varying magnetic field that can then be detected as MRI signal.</p>
</section>
<section id="simulation-of-precession">
<h3>Simulation of Precession<a class="headerlink" href="#simulation-of-precession" title="Permalink to this heading">#</a></h3>
<p>Again, use the <a class="reference external" href="https://www.drcmr.dk/CompassMR/">CompassMR</a> simulator for visualizing resonance and precession.</p>
<ol class="arabic simple">
<li><p>Start in the default compass mode again</p></li>
<li><p>Hit the Push button in the top right.  Notice how the needle now precesses at a specific frequency</p></li>
<li><p>Switch on using the Coil for <span class="math notranslate nohighlight">\(B_1\)</span> in the top right checkbox, and hit Push again.  Now the blue trace highlights the signal created in this coil by the precessing needle.  This is because the needle will also create a time-varying magnetic field that can be detected</p></li>
<li><p>Now switch to the Spin mode in the top right checkbox, and Push the spin.  It will now precess in 3D around the up-down direction of <span class="math notranslate nohighlight">\(B_0\)</span></p></li>
</ol>
</section>
</section>
<section id="relaxation">
<h2>Relaxation<a class="headerlink" href="#relaxation" title="Permalink to this heading">#</a></h2>
<p>Relaxation refers to the process by which the net magnetization, our ensemble of individual spins, returns to thermal equilibrium.  This is governed by 2 time constants, <span class="math notranslate nohighlight">\(T_1(\vec{r})\)</span> - the longitudinal (<span class="math notranslate nohighlight">\(M_Z\)</span>) or spin-lattice relaxation time constant, and <span class="math notranslate nohighlight">\(T_2(\vec{r})\)</span> - the transverse (<span class="math notranslate nohighlight">\(M_{XY}\)</span>) or spin-spin relaxation time constant.  These time constants differ depending on tissue composition and structure, and both of these relaxation time constants are valuable sources of MRI contrast.</p>
<section id="simulation-of-relaxation">
<h3>Simulation of Relaxation<a class="headerlink" href="#simulation-of-relaxation" title="Permalink to this heading">#</a></h3>
<p>One last time in this chapter, use the <a class="reference external" href="https://www.drcmr.dk/CompassMR/">CompassMR</a> simulator.</p>
<ol class="arabic simple">
<li><p>Start in the default compass mode</p></li>
<li><p>Hit the Push button in the top right.  The needle will begin to precesses but then returns to alignment with the <span class="math notranslate nohighlight">\(B_0\)</span> magnetic field (in the vertical direction).  This return to equilibrium is relaxation</p></li>
</ol>
</section>
<section id="relaxation-equations">
<h3>Relaxation Equations<a class="headerlink" href="#relaxation-equations" title="Permalink to this heading">#</a></h3>
<p>How the net magnetization, <span class="math notranslate nohighlight">\(\vec{M}(\vec{r},t)\)</span>, behaves in returning to equilibrium is governed by the Bloch equation.  The full Bloch equation is covered in a later chapter, but we will begin here introducing the result for relaxation:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\vec{M}(\vec{r},t) =
\begin{bmatrix}
e^{-t/T_2(\vec{r})} &amp; 0 &amp; 0 \\
0 &amp; e^{-t/T_2(\vec{r})} &amp; 0 \\
0 &amp; 0 &amp; 1
\end{bmatrix}
\vec{M}(\vec{r},0)
+
\begin{bmatrix}
 0 \\
 0 \\
M_0(\vec{r})(1-e^{-t/T_1(\vec{r})})
\end{bmatrix}
\end{split}\]</div>
<p>It is extremely convenient to divide up the net magnetization vector into the separate transverse (XY) and longitudinal (Z) components.  The longitudinal component, <span class="math notranslate nohighlight">\(M_Z\)</span>, by convention is always aligned with <span class="math notranslate nohighlight">\(B_0\)</span>, the main magnetic field, whereas the transverse components, <span class="math notranslate nohighlight">\(M_X\)</span> and <span class="math notranslate nohighlight">\(M_Y\)</span> are both perpendicular to the direction of <span class="math notranslate nohighlight">\(B_0\)</span>.</p>
<p>For the transverse magnetization:</p>
<div class="math notranslate nohighlight">
\[M_{XY}(\vec{r},t) = M_{XY}(\vec{r},0) e^{-t/T_2(\vec{r})}\]</div>
<p>This equation means that the transverse magnetization decays from its original value (when <span class="math notranslate nohighlight">\(t=0\)</span>) down to 0, with an exponential time constant <span class="math notranslate nohighlight">\(T_2(\vec{r})\)</span>.</p>
<p>For the longitudinal magnetization:</p>
<div class="math notranslate nohighlight">
\[M_Z(\vec{r},t) = M_Z(\vec{r},0)e^{-t/T_1} + M_0(\vec{r},)(1- e^{-t/T_1(\vec{r})})\]</div>
<p>This equation means that the longitudinal magnetization returns or recovers to its equilibrium value, <span class="math notranslate nohighlight">\(M_0(\vec{r})\)</span>, with an exponential time constant <span class="math notranslate nohighlight">\(T_1(\vec{r})\)</span>.</p>
<p>Both are illustrated below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-octave notranslate"><div class="highlight"><pre><span></span><span class="c">% setup MRI-education-resources path and requirements</span>
<span class="n">cd</span> <span class="p">.</span><span class="o">./</span>
<span class="n">startup</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>loading image
loading signal
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-octave notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="p">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span> <span class="c">% s</span>

<span class="n">T1</span> <span class="p">=</span> <span class="p">.</span><span class="mi">8</span><span class="p">;</span>  <span class="n">T2</span> <span class="p">=</span> <span class="p">.</span><span class="mi">1</span><span class="p">;</span> <span class="c">% s</span>
<span class="n">M0</span> <span class="p">=</span> <span class="mi">1</span><span class="p">;</span>

<span class="n">M_start</span> <span class="p">=</span> <span class="p">[</span><span class="n">M0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">].</span><span class="o">&#39;</span><span class="p">;</span> <span class="c">% start along MX</span>

<span class="n">Mall</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="nb">length</span><span class="p">(</span><span class="n">t</span><span class="p">));</span>

<span class="k">for</span> <span class="n">It</span> <span class="p">=</span> <span class="mi">1</span><span class="p">:</span><span class="nb">length</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="n">Mall</span><span class="p">(:,</span><span class="n">It</span><span class="p">)</span> <span class="p">=</span> <span class="n">bloch_relax</span><span class="p">(</span><span class="n">M_start</span><span class="p">,</span><span class="n">t</span><span class="p">(</span><span class="n">It</span><span class="p">),</span><span class="n">M0</span><span class="p">,</span><span class="n">T1</span><span class="p">,</span> <span class="n">T2</span><span class="p">);</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-octave notranslate"><div class="highlight"><pre><span></span><span class="nb">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">Mall</span><span class="p">)</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;time (s)&#39;</span><span class="p">),</span> <span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;Magnetization&#39;</span><span class="p">)</span>
<span class="nb">legend</span><span class="p">({</span><span class="s">&#39;M_X&#39;</span><span class="p">,</span> <span class="s">&#39;M_Y&#39;</span><span class="p">,</span> <span class="s">&#39;M_Z&#39;</span><span class="p">},</span> <span class="s">&#39;location&#39;</span><span class="p">,</span> <span class="s">&#39;north&#39;</span><span class="p">),</span> <span class="nb">legend</span> <span class="n">boxoff</span>
<span class="nb">title</span><span class="p">([</span><span class="s">&#39;Relaxation&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ans = -9.5540
ans = -9.5540
</pre></div>
</div>
<img alt="_images/b1751411d9ca32cff1d41cc0a922190c9a56c74d5ca81b65cebb6e7e9e463178.png" src="_images/b1751411d9ca32cff1d41cc0a922190c9a56c74d5ca81b65cebb6e7e9e463178.png" />
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "octave"
        },
        kernelOptions: {
            name: "octave",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'octave'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="Introduction.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Introduction to Principles of MRI</p>
      </div>
    </a>
    <a class="right-next"
       href="MRI%20System.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">The MRI System</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-goals">Learning Goals</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nuclear-spin">Nuclear Spin</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#polarization">Polarization</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#equilibrium-magnetization">Equilibrium Magnetization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fractional-polarization">Fractional Polarization</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#resonance">Resonance</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#resonance-frequency">Resonance Frequency</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simulation-of-resonance">Simulation of Resonance</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#precession">Precession</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#excitation">Excitation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simulation-of-precession">Simulation of Precession</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#relaxation">Relaxation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simulation-of-relaxation">Simulation of Relaxation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#relaxation-equations">Relaxation Equations</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Peder Larson
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2021.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  Citation - DOI <a href="https://doi.org/10.5281/zenodo.5547020">10.5281/zenodo.5547020</a>
</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>