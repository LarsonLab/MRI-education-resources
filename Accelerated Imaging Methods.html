

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Accelerated Imaging Methods &#8212; Principles of MRI</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=UA-51903906-1"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'UA-51903906-1');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Accelerated Imaging Methods';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Key MRI Concepts and Equations" href="Key%20MRI%20Concepts.html" />
    <link rel="prev" title="Fast Imaging Pulse Sequences" href="Fast%20Imaging%20Pulse%20Sequences.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="Introduction.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/HPBrain-Anime.png" class="logo__image only-light" alt="Principles of MRI - Home"/>
    <script>document.write(`<img src="_static/HPBrain-Anime.png" class="logo__image only-dark" alt="Principles of MRI - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="Introduction.html">
                    Introduction to Principles of MRI
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Magnetic Resonance Physics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="MRI%20System.html">The MRI System</a></li>
<li class="toctree-l1"><a class="reference internal" href="Spin%20Physics.html">Spin Physics</a></li>
<li class="toctree-l1"><a class="reference internal" href="MR%20Physics%20-%20Bloch%20Equation.html">Bloch Equation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Magnetic%20Fields%20and%20RF%20Coils.html">Magnetic fields in MRI</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">MR Experiment</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Pulse%20Sequence.html">The Pulse Sequence</a></li>
<li class="toctree-l1"><a class="reference internal" href="Gradient%20and%20Spin%20Echoes.html">Gradient and Spin Echo Pulse Sequences</a></li>
<li class="toctree-l1"><a class="reference internal" href="MRI%20Contrast.html">MRI Contrast</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Image Formation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Spatial%20Encoding.html">Spatial Encoding</a></li>
<li class="toctree-l1"><a class="reference internal" href="Image%20Reconstruction.html">Image Reconstruction</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Image Characteristics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Signal%20to%20Noise%20Ratio.html">Signal to Noise Ratio (SNR)</a></li>

<li class="toctree-l1"><a class="reference internal" href="FOV%20and%20Resolution.html">Field of View (FOV) and Resolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="MRI%20Signal%20Equation.html">The MRI Signal Equation and K-space</a></li>
<li class="toctree-l1"><a class="reference internal" href="Artifacts.html">Artifacts</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Radiofrequency Pulses</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="RF%20Pulses.html">RF Pulses</a></li>
<li class="toctree-l1"><a class="reference internal" href="Spectral-Spatial%20RF%20Pulses.html">Spectral-Spatial RF Pulses</a></li>
<li class="toctree-l1"><a class="reference internal" href="Fun%20with%20RF%20Pulses.html">Fun with RF Pulses?</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Fast Imaging</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Fast%20Imaging%20Pulse%20Sequences.html">Fast Imaging Pulse Sequences</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Accelerated Imaging Methods</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Summary</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Key%20MRI%20Concepts.html">Key MRI Concepts and Equations</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Reference Material</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="MRI%20Notation.html">MRI Notation and Terminology</a></li>
<li class="toctree-l1"><a class="reference internal" href="MRI%20Math%20Concepts.html">MRI Math Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="Software_Resources.html">MRI Software Resources</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/larsonlab/MRI-education-resources" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/larsonlab/MRI-education-resources/issues/new?title=Issue%20on%20page%20%2FAccelerated Imaging Methods.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Accelerated Imaging Methods.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Accelerated Imaging Methods</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-goals">Learning Goals</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#general-formulation-of-mri-reconstruction">General Formulation of MRI Reconstruction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#partial-fourier-imaging">Partial Fourier Imaging</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#parallel-imaging">Parallel Imaging</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#model-based-methods">Model-based Methods</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-predictability-methods">Linear Predictability Methods</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#snr-in-parallel-imaging">SNR in Parallel Imaging</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#artifacts-with-parallel-imaging">Artifacts with Parallel Imaging</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compressed-sensing-methods">Compressed Sensing Methods</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#snr-in-compressed-sensing">SNR in Compressed Sensing</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#artifacts-with-compressed-sensing">Artifacts with Compressed Sensing</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#deep-learning-reconstructions">Deep Learning Reconstructions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deep-learning-requirements">Deep Learning Requirements</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#snr-in-dl-reconstructions">SNR in DL Reconstructions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#artifacts-with-dl-reconstructions">Artifacts with DL Reconstructions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reference">Reference</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="accelerated-imaging-methods">
<h1>Accelerated Imaging Methods<a class="headerlink" href="#accelerated-imaging-methods" title="Permalink to this heading">#</a></h1>
<p>MRI scans can be accelerated by applying methods that reduce the number of k-space samples required, also known as undersampling.  These require a corresponding advanced image reconstruction method to allow for the reduced sampling.  The techniques covered here include parallel imaging, compressed sensing, and deep learning methods.</p>
<section id="learning-goals">
<h2>Learning Goals<a class="headerlink" href="#learning-goals" title="Permalink to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Describe how images are formed</p>
<ul class="simple">
<li><p>Describe how accelerated imaging methods work</p></li>
</ul>
</li>
<li><p>Understand the constraints and tradeoffs in MRI</p>
<ul class="simple">
<li><p>Identify accelerated imaging methods</p></li>
<li><p>Understand when accelerated imaging methods can be applied</p></li>
</ul>
</li>
<li><p>Manipulate MRI sequence parameters to improve performance</p>
<ul class="simple">
<li><p>Define which parameters are modified when accelerated imaging methods are applied</p></li>
</ul>
</li>
<li><p>Manipulate and analyze MRI data</p>
<ul class="simple">
<li><p>Reconstruct an image from undersampled raw data</p></li>
</ul>
</li>
</ol>
</section>
<section id="general-formulation-of-mri-reconstruction">
<h2>General Formulation of MRI Reconstruction<a class="headerlink" href="#general-formulation-of-mri-reconstruction" title="Permalink to this heading">#</a></h2>
<p>For advanced image reconstruction methods, it is helpful to reformulate the reconstruction problem as a linear system and using standard mathematical notation describing linear systems as:</p>
<div class="math notranslate nohighlight">
\[  y = \mathbf{E}x + n \]</div>
<p>where <span class="math notranslate nohighlight">\(y\)</span> is the acquired data, <span class="math notranslate nohighlight">\(\mathbf{E}\)</span> is the encoding matrix, <span class="math notranslate nohighlight">\(x\)</span> is the spatial distribution of the transverse magnetization (e.g. image), and <span class="math notranslate nohighlight">\(n\)</span> is noise.  In this formulation, the image is vectorized.  For example, 2D FT sampled data and the corresponding 2D image would be converted to:</p>
<div class="math notranslate nohighlight">
\[\begin{split} y = \left[ 
    \begin{array}{c}
s_1(t_1) \\
s_1(t_2) \\
\vdots \\
s_1(t_{Nx}) \\
s_2(t_1) \\
\vdots \\
s_{Ny}(t_{Nx})\\
\end{array}
\right]\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(s_m(t_n)\)</span> is the data from the <span class="math notranslate nohighlight">\(m\)</span>th TR at the <span class="math notranslate nohighlight">\(n\)</span>th sample.</p>
<div class="math notranslate nohighlight">
\[\begin{split} x = \left[ 
    \begin{array}{c}
m(x_1,y_1) \\
m(x_2,y_1) \\
\vdots \\
m(x_{Nx},y_1) \\
m(x_{1},y_2) \\
\vdots \\
m(x_{Nx},y_{Ny}) 
\end{array}
\right]\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(x_i\)</span> and <span class="math notranslate nohighlight">\(y_i\)</span> are equally spaced locations in image space.</p>
<p>The encoding matrix, <span class="math notranslate nohighlight">\(\mathbf{E}\)</span>, at a minimum includes a discrete Fourier Transform matrix, <span class="math notranslate nohighlight">\(\mathbf{F}\)</span>, representing our data is the Fourier Transform of the transverse magnetization, evaluated at k-space locations.  For this matrix, the entries are defined by k-space location being sampled, <span class="math notranslate nohighlight">\(\vec{k}_i\)</span> and the spatial locations, <span class="math notranslate nohighlight">\(\vec{r}_j\)</span>:</p>
<div class="math notranslate nohighlight">
\[ \mathbf{f}_{i,j} = \exp(-i 2 \pi \vec{k}_i \cdot \vec{r}_j)\]</div>
<p>In this case, the measurement is the discrete Fourier Transform of the image</p>
<div class="math notranslate nohighlight">
\[  y = \mathbf{F}x + n \]</div>
<p>and image reconstruction is performed by inverse discrete Fourier Transform, which for fully sampled 2D FT imaging is well defined by matrix inversion:</p>
<div class="math notranslate nohighlight">
\[ \hat{x} = \mathbf{F^{H}} y \]</div>
</section>
<section id="partial-fourier-imaging">
<h2>Partial Fourier Imaging<a class="headerlink" href="#partial-fourier-imaging" title="Permalink to this heading">#</a></h2>
<p>Partial Fourier imaging, also known as fractional NEX or partial k-space, utilizes the conjugate symmetry property of the Fourier Transform.  This property states that the Fourier Transform of a real-valued function has conjugate symmetry.  If our image, <span class="math notranslate nohighlight">\(m(\vec{r})\)</span>, is real-valued, then the k-space data satisfies</p>
<div class="math notranslate nohighlight">
\[ M(\vec{k}) = M(-\vec{k})^*\]</div>
<p>In this case, only half of k-space is required, and the other half can be filled in by this property.</p>
<p>In practice, there is typically low spatial frequency phase components in the image so the initial assumption of a real-valued image is violated.  However, the data acquisition can still be accelerated by acquiring slightly more than half of k-space, and the fully sampled center of k-space can provide sufficient information about the low spatial frequency phase to still allow for accelerationg based on this conjugate symmetry property.</p>
</section>
<section id="parallel-imaging">
<h2>Parallel Imaging<a class="headerlink" href="#parallel-imaging" title="Permalink to this heading">#</a></h2>
<p>For parallel imaging (PI), we need to consider the coil sensitivity profiles, <span class="math notranslate nohighlight">\(\mathbf{C}_q\)</span>, for each RF coil into encoding matrix along with a Fourier Transform encoding matrix, <span class="math notranslate nohighlight">\(\mathbf{F}\)</span>, as well as a k-space sub-sampling operator, <span class="math notranslate nohighlight">\(\mathbf{S}\)</span>, for the measurements from each RF coil, <span class="math notranslate nohighlight">\(\mathbf{y}_q\)</span>:</p>
<div class="math notranslate nohighlight">
\[ y_q = \mathbf{E}_q x + n_q = \mathbf{S} \mathbf{F} \mathbf{C_q} x + n_q  \]</div>
<p>The coil sensitivity profiles <span class="math notranslate nohighlight">\(\mathbf{C}_q\)</span> is a diagonal matrix with entries corresponding to the coil sensitivity profile at each location in <span class="math notranslate nohighlight">\(\mathbf{x}\)</span>.</p>
<p>The k-space sub-sampling operator <span class="math notranslate nohighlight">\(\mathbf{S}\)</span>, is a diagnoal matrix with entries of 1 or 0, describing whether an expect grid location was sampled.  It is convenient to use when describing image reconstruction as filling in points in k-space.</p>
<p>Here we can return to our original formulation by creating augmented matrices, concatenating along the coil elements dimension for example as:</p>
<div class="math notranslate nohighlight">
\[\mathbf{y} = [y_1 \ y_2 \ldots y_N]\]</div>
<div class="math notranslate nohighlight">
\[\mathbf{E} = [\mathbf{E}_1 \ \mathbf{E}_2 \ldots \mathbf{E}_N]\]</div>
<div class="math notranslate nohighlight">
\[\mathbf{n} = [n_1 \ n_2 \ldots n_N]\]</div>
<p>resulting in:</p>
<div class="math notranslate nohighlight">
\[ \mathbf{y} = \mathbf{Ex} + \mathbf{n} \]</div>
<section id="model-based-methods">
<h3>Model-based Methods<a class="headerlink" href="#model-based-methods" title="Permalink to this heading">#</a></h3>
<p>Model-based parallel imaging methods use some simulation of the MRI system and include the methods of SENSE, ESPIRiT, and NLINV.  These reconstruct a single underlying image by solving an optimization problem.  The popular SENSE methods solves</p>
<div class="math notranslate nohighlight">
\[\mathbf{\hat{x}}_{PI} = \arg \min_\mathbf{x} \frac{1}{2} \| \mathbf{y} - \mathbf{Ex} \|^2_2\]</div>
<p>This can be solved directly by a pseudo-inverse, but requires measurements of the coil sensitivity profiles to calculate <span class="math notranslate nohighlight">\(\mathbf{E}\)</span>:</p>
<div class="math notranslate nohighlight">
\[\mathbf{\hat{x}}_{PI} = (\mathbf{E}^H\mathbf{E})^{-1} \mathbf{E}^H \mathbf{y} \]</div>
<p>The k-space sampling patterns used for these methods typically use regular undersampling, meaning there is a consistent pattern of acquired and skipped k-space lines.</p>
</section>
<section id="linear-predictability-methods">
<h3>Linear Predictability Methods<a class="headerlink" href="#linear-predictability-methods" title="Permalink to this heading">#</a></h3>
<p>Linear predictability parallel imaging methods assume that each k-space sample is a linear combination of other k-space samples and inlcude the methods of AUTO-SMASH, GRAPPA, and SPIRiT.  These utilize a calibration kernel, computed from the data itself and captured in the matrix <span class="math notranslate nohighlight">\(\mathbf{G}\)</span>, and can be generally formulated as the following optimization problem</p>
<div class="math notranslate nohighlight">
\[\mathbf{\hat{x}}_{PI} = \arg \min_\mathbf{x} \| \mathbf{y} - \mathbf{Ex} \|^2_2 + \lambda \| (\mathbf{G} - \mathbf{I}) \mathbf{x} \|^2_2 \]</div>
<p>Where <span class="math notranslate nohighlight">\(\lambda\)</span> is a tuning or regularization parameter and <span class="math notranslate nohighlight">\(\mathbf{I}\)</span> is the identity matrix.  This simultaneous enforces data consistency (first term) as well as self-consistency of the calibration (sescond term).</p>
<p>The calibration kernel, <span class="math notranslate nohighlight">\(\mathbf{G}\)</span>, can either be directly measured from the data as in GRAPPA, or iteratively estimated while solving the optimization, as in SPIRiT.</p>
<p>The k-space sampling patterns used for these methods typically use regular undersampling, meaning there is a consistent pattern of acquired and skipped k-space lines, combined with full sampling in the center of k-space.</p>
</section>
<section id="snr-in-parallel-imaging">
<h3>SNR in Parallel Imaging<a class="headerlink" href="#snr-in-parallel-imaging" title="Permalink to this heading">#</a></h3>
<p>There is an SNR penalty when using these methods that varies in severity depending on the conditioning of the undersampled reconstruction matrix.  Variation in RF coil element sensitivity profiles in the direction of the undersampling leads to a more well-conditioned reconstruction and lower SNR penalty.  Conversely, less RF coil element sensitivity profile variation in the direction of the undersampling leads to a more ill-conditioned reconstruction matrix and higher SNR penatly.  Also, regions will little difference betweeen RF coils (typically in the center of the body), also tend to have larger SNR penalties.</p>
<p>This is characterized by the “g-factor”, where <span class="math notranslate nohighlight">\(g(\vec{r}) \geq 1\)</span> characterizes a spatially-varying SNR loss that is dependent on the coil loading and geometry, k-space sampling pattern, and parallel imaging reconstruction method.  When appyling an acceleration factor of <span class="math notranslate nohighlight">\(R\)</span>, the total readout time reduces the SNR by <span class="math notranslate nohighlight">\(\sqrt{R}\)</span> as well, leading to the SNR relationship:</p>
<div class="math notranslate nohighlight">
\[SNR_{PI} = \frac{SNR_{full}}{g(\vec{r})\sqrt{R}}\]</div>
</section>
<section id="artifacts-with-parallel-imaging">
<h3>Artifacts with Parallel Imaging<a class="headerlink" href="#artifacts-with-parallel-imaging" title="Permalink to this heading">#</a></h3>
<p>Parallel Imaging artifacts typically appear as aliasing.  The undersampled data will have aliasing when not using a parallel imaging reconstruction method, and sometimes the aliasing is not completely removed.  There are also aliasing like artifacts when there is a mismatch between the data and measured coil sensitivity profiles.</p>
</section>
</section>
<section id="compressed-sensing-methods">
<h2>Compressed Sensing Methods<a class="headerlink" href="#compressed-sensing-methods" title="Permalink to this heading">#</a></h2>
<p>Compressed Sensing (CS) theory says that an image that is compressible in some domain can then be reconstructed from a subset of data samples.  In other words, we can further accelerate our data acquisition.</p>
<p>Compressed Sensing is formulated as the following optimization problem, specifically using the <span class="math notranslate nohighlight">\(\ell_1\)</span>-norm (<span class="math notranslate nohighlight">\(\|x\|_1 = \sum_{i=1}^n |x_i|\)</span>) that promotes sparsity in the solution:</p>
<div class="math notranslate nohighlight">
\[\mathbf{\hat{x}}_{CS} = \arg \min_\mathbf{x} \frac{1}{2} \| \mathbf{y} - \mathbf{Ex} \|^2_2 + \lambda_{CS} \| \mathbf{Wx} \|_1 \]</div>
<p>which includes a data consistency term where the data multiplied by the encoding matrix must match the reconstructed image, and a regularization term that enforces that the image is sparse using the <span class="math notranslate nohighlight">\(\ell_1\)</span> norm in some domain through the sparsifying transform, <span class="math notranslate nohighlight">\(\mathbf{W}\)</span>.  There is a regularization factor, <span class="math notranslate nohighlight">\(\lambda_{CS}\)</span>, that must be chosen to balance the data consistency and sparsity terms.</p>
<p>These methods specifically require k-space sampling patterns with pseudo-random undersampling, which is illustratic by the diagram below of the undersampled reconstruction procedure:</p>
<p><img alt="Compressed Sensing Illustration" src="_images/compressed_sensing_concept.gif" /></p>
<p><strong>Caption</strong> (Figure from <a class="reference external" href="https://doi.org/10.1109/MSP.2007.914728">https://doi.org/10.1109/MSP.2007.914728</a> ):
Heuristic procedure for reconstruction from undersampled data. A sparse signal (a) is 8-fold undersampled in its 1-D k -space domain (b). Equispaced undersampling results in signal aliasing (d) preventing recovery. Pseudo-random undersampling results in incoherent interference (c). Some strong signal components stick above the interference level, are detected and recovered by thresholding (e) and (f). The interference of these components is computed (g) and subtracted (h), thus lowering the total interference level and enabling recovery of weaker components.</p>
<p>Popular sparsifying transforms include total variation (TV), total generalized variation (TGV), and wavelets, where MRI data is typically more sparse.  The pseudo-random undersampling typically uses a variable density that preferentially has more samples near the center of k-space.</p>
<p>This regularization term, <span class="math notranslate nohighlight">\(\| \mathbf{Wx} \|_1\)</span> can also be combined with iterative parallel imaging reconstruction methods as well, for example in the <span class="math notranslate nohighlight">\(\ell_1\)</span>-ESPIRiT method.</p>
<section id="snr-in-compressed-sensing">
<h3>SNR in Compressed Sensing<a class="headerlink" href="#snr-in-compressed-sensing" title="Permalink to this heading">#</a></h3>
<p>It is difficult to define SNR when using compressed sensing reconstruction methods, as they inherently perform some denoising when constraining the reconstruction based on sparsity.  The apparent SNR can also vary significantly depending on the choice of the regularization factor, <span class="math notranslate nohighlight">\(\lambda_{CS}\)</span>.</p>
</section>
<section id="artifacts-with-compressed-sensing">
<h3>Artifacts with Compressed Sensing<a class="headerlink" href="#artifacts-with-compressed-sensing" title="Permalink to this heading">#</a></h3>
<p>The most common artifacts from compressed sensing come from overfitting to the sparsity penalty.  This result in either an over-smoothed, unnatural appearance or, in the case of a wavelet sparsifying transform, blocking artifacts.</p>
</section>
</section>
<section id="deep-learning-reconstructions">
<h2>Deep Learning Reconstructions<a class="headerlink" href="#deep-learning-reconstructions" title="Permalink to this heading">#</a></h2>
<p>Deep learning (DL) can be used to reconstructed undersampled k-space into image data from a subset of data samples as well.  Conceptually, these methods can be trained to learn how to incorporate coil sensitivity information like parallel imaging and typical image sparsity patterns like compressed sensing.  Since they learn from real-world data, they can learn information that is the most relevant to MRI data and thus have been shown to support higher acceleration factors.  For example, they can learn what patterns within the image and/or k-space domain and most relevant and most common in MRI.</p>
<p>These methods can often be considered general solutions to a regularized least-squares objective</p>
<div class="math notranslate nohighlight">
\[\mathbf{\hat{x}}_{reg} = \arg \min_\mathbf{x} \frac{1}{2} \| \mathbf{y} - \mathbf{Ex} \|^2_2 + \mathcal{R}(\mathbf{x}) \]</div>
<p>where <span class="math notranslate nohighlight">\(\mathcal{R}(\cdot)\)</span> can be a parallel imaging or compressed sensing regularizer as above, but can also be implicitly implemented via machine learning techniques.  This means that the machine learning reconstruction is attempting to constrain or regularize the reconstruction.</p>
<p>The most straightforward approach using deep learning is to train a CNN to invert the encoding operation in image space, e.g. after applying the inverse Fourier Transform to the data:</p>
<div class="math notranslate nohighlight">
\[\mathbf{\hat{x}}_{DL} = g_{DNN}(\mathbf{E^{H} y})\]</div>
<p>The learned deep neural network, <span class="math notranslate nohighlight">\(g_{DNN}()\)</span>, includes many weights that must be trained prior to being able to perform the reconstruction.</p>
<p>However, so-called un-rolled networks have become more popular for MRI reconstruction, as they can better incorporate parallel imaging information, data consistency, and also are often more compact.  They are designed to mimic iterations of classical algorithms to solve optimization problems, and each iteration has been “un-rolled” into a series of cascaded neural networks.  Some popular methods include MoDL and Variational Networks.</p>
<p>Variational Networks (VarNets) for undersampled MRI reconstruction are formulated as the above regularlized least-squares objective, but models the architecture after a single gradient update in iterative gradient descent (used to solve optimization problems) and uses a CNN (e.g. UNet) within the iterations</p>
<p><img alt="Variational Network for MRI Reconstruction" src="_images/end-to-end_varnet.jpg" /></p>
<p>Caption (from <a class="reference external" href="https://arxiv.org/abs/2004.06688">https://arxiv.org/abs/2004.06688</a>):
The E2E-VN model takes under-sampled k-space as input and applies several cascades, followed by IFT and RSS. Bottom: The DC module brings intermediate k-space closer to measured values, the Refinement module maps multi-coil k-space to one image, applies a U-Net and maps back to k-space, and the SME estimates sensitivity maps used in the refinement step.</p>
<p>The Model-based Deep Learning (MoDL) method uses the formulation where the regularizer is a CNN that estimates the noise and aliasing patterns</p>
<div class="math notranslate nohighlight">
\[ \mathcal{R}_{MoDL}(\mathbf{x}) = \lambda \| \mathcal{N}_w(\mathbf{x}) \|^2\]</div>
<p>and the estimate depends on a set of learned parameters, <span class="math notranslate nohighlight">\(w\)</span>, in the neural network, <span class="math notranslate nohighlight">\(\mathcal{N}_\mathbf{w}(\cdot)\)</span>.  It’s structure is overall similar to VarNets, as both are unrolled architectures, but with slightly different formulations.</p>
<section id="deep-learning-requirements">
<h3>Deep Learning Requirements<a class="headerlink" href="#deep-learning-requirements" title="Permalink to this heading">#</a></h3>
<ol class="arabic simple">
<li><p>Data</p>
<ul class="simple">
<li><p>Generally a lot of data (<span class="math notranslate nohighlight">\(10^4\)</span> in many radiology applications, but also depends a lot on the question being answered and data quality)</p></li>
<li><p>Fully sampled data typically required for supervised learning of undersampled MRI reconstruction</p></li>
<li><p>Data augmentation – realistic modifications of existing data to increase training data size</p></li>
<li><p>For reconstruction, fastMRI provides thousands of high quality training data: <a class="reference external" href="http://fastmri.med.nyu.edu">http://fastmri.med.nyu.edu</a>, <a class="reference external" href="https://doi.org/10.48550/arXiv.1811.08839">https://doi.org/10.48550/arXiv.1811.08839</a></p></li>
</ul>
</li>
<li><p>Architecture</p>
<ul class="simple">
<li><p>U-net, ResNet popular for working in image-domain</p></li>
<li><p>Un-rolled networks popular for image reconstruction.</p></li>
<li><p>Generative models possible</p></li>
<li><p>Transformers</p></li>
</ul>
</li>
<li><p>Computation</p>
<ul class="simple">
<li><p>GPUs are essential for training of deep networks</p></li>
</ul>
</li>
<li><p>Training</p>
<ul class="simple">
<li><p>Send input data forward through network, compare to the expected output (e.g. fully sampled image or data) update the network weights through back-propagation</p></li>
<li><p>Choose loss function, such as l1 or l2</p></li>
<li><p>Choose batch sizes, Learning rate, etc</p></li>
</ul>
</li>
</ol>
</section>
<section id="snr-in-dl-reconstructions">
<h3>SNR in DL Reconstructions<a class="headerlink" href="#snr-in-dl-reconstructions" title="Permalink to this heading">#</a></h3>
<p>It is difficult to define SNR when using machine learning reconstruction methods, as they inherently perform some denoising when constraining the reconstruction.</p>
</section>
<section id="artifacts-with-dl-reconstructions">
<h3>Artifacts with DL Reconstructions<a class="headerlink" href="#artifacts-with-dl-reconstructions" title="Permalink to this heading">#</a></h3>
<p>A challenge with machine learning reconstructions is that artifacts can be difficult to identify.  They can result in an over-smoothed appearance, but often a well-trained network will retain realistic texture and noise appearance features.  These methods can also overfit to the learned anatomy and data, meaning features might be erased or hallucinated, although using physics-based techniques provide some assurances of data-consistency.</p>
</section>
<section id="reference">
<h3>Reference<a class="headerlink" href="#reference" title="Permalink to this heading">#</a></h3>
<p>For a recent, comprehensive reference on thes methods I reccommend:</p>
<p>Hammernik K, Küstner T, Yaman B, Huang Z, Rueckert D, Knoll F, Akçakaya M. Physics-Driven Deep Learning for Computational Magnetic Resonance Imaging: Combining physics and machine learning for improved medical imaging. IEEE Signal Process Mag. 2023 Jan;40(1):98-114. doi: 10.1109/msp.2022.3215288. Epub 2023 Jan 2. PMID: 37304755; PMCID: PMC10249732.</p>
<p><a class="reference external" href="https://arxiv.org/pdf/2203.12215.pdf">https://arxiv.org/pdf/2203.12215.pdf</a></p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "octave"
        },
        kernelOptions: {
            name: "octave",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'octave'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Fast%20Imaging%20Pulse%20Sequences.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Fast Imaging Pulse Sequences</p>
      </div>
    </a>
    <a class="right-next"
       href="Key%20MRI%20Concepts.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Key MRI Concepts and Equations</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-goals">Learning Goals</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#general-formulation-of-mri-reconstruction">General Formulation of MRI Reconstruction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#partial-fourier-imaging">Partial Fourier Imaging</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#parallel-imaging">Parallel Imaging</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#model-based-methods">Model-based Methods</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-predictability-methods">Linear Predictability Methods</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#snr-in-parallel-imaging">SNR in Parallel Imaging</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#artifacts-with-parallel-imaging">Artifacts with Parallel Imaging</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compressed-sensing-methods">Compressed Sensing Methods</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#snr-in-compressed-sensing">SNR in Compressed Sensing</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#artifacts-with-compressed-sensing">Artifacts with Compressed Sensing</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#deep-learning-reconstructions">Deep Learning Reconstructions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deep-learning-requirements">Deep Learning Requirements</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#snr-in-dl-reconstructions">SNR in DL Reconstructions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#artifacts-with-dl-reconstructions">Artifacts with DL Reconstructions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reference">Reference</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Peder Larson
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  Citation - DOI <a href="https://doi.org/10.5281/zenodo.5547020">10.5281/zenodo.5547020</a>
</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>