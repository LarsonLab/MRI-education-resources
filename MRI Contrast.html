

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>MRI Contrast &#8212; Principles of MRI</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=UA-51903906-1"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'UA-51903906-1');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'MRI Contrast';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Spatial Encoding" href="Spatial%20Encoding.html" />
    <link rel="prev" title="Gradient and Spin Echo Pulse Sequences" href="Gradient%20and%20Spin%20Echoes.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="Introduction.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/HPBrain-Anime.png" class="logo__image only-light" alt="Principles of MRI - Home"/>
    <script>document.write(`<img src="_static/HPBrain-Anime.png" class="logo__image only-dark" alt="Principles of MRI - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="Introduction.html">
                    Introduction to Principles of MRI
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Magnetic Resonance Physics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="MRI%20System.html">The MRI System</a></li>
<li class="toctree-l1"><a class="reference internal" href="Spin%20Physics.html">Spin Physics</a></li>
<li class="toctree-l1"><a class="reference internal" href="MR%20Physics%20-%20Bloch%20Equation.html">Bloch Equation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Magnetic%20Fields%20and%20RF%20Coils.html">Magnetic fields in MRI</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">MR Experiment</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Pulse%20Sequence.html">The Pulse Sequence</a></li>
<li class="toctree-l1"><a class="reference internal" href="Gradient%20and%20Spin%20Echoes.html">Gradient and Spin Echo Pulse Sequences</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">MRI Contrast</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Image Formation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Spatial%20Encoding.html">Spatial Encoding</a></li>
<li class="toctree-l1"><a class="reference internal" href="Image%20Reconstruction.html">Image Reconstruction</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Image Characteristics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Signal%20to%20Noise%20Ratio.html">Signal to Noise Ratio (SNR)</a></li>

<li class="toctree-l1"><a class="reference internal" href="FOV%20and%20Resolution.html">Field of View (FOV) and Resolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="MRI%20Signal%20Equation.html">The MRI Signal Equation and K-space</a></li>
<li class="toctree-l1"><a class="reference internal" href="Artifacts.html">Artifacts</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Radiofrequency Pulses</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="RF%20Pulses.html">RF Pulses</a></li>
<li class="toctree-l1"><a class="reference internal" href="Spectral-Spatial%20RF%20Pulses.html">Spectral-Spatial RF Pulses</a></li>
<li class="toctree-l1"><a class="reference internal" href="Fun%20with%20RF%20Pulses.html">Fun with RF Pulses?</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Fast Imaging</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Fast%20Imaging%20Pulse%20Sequences.html">Fast Imaging Pulse Sequences</a></li>
<li class="toctree-l1"><a class="reference internal" href="Accelerated%20Imaging%20Methods.html">Accelerated Imaging Methods</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Reference Material</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="MRI%20Notation.html">MRI Notation and Terminology</a></li>
<li class="toctree-l1"><a class="reference internal" href="MRI%20Math%20Concepts.html">MRI Math Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="Software_Resources.html">MRI Software Resources</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/larsonlab/MRI-education-resources" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/larsonlab/MRI-education-resources/issues/new?title=Issue%20on%20page%20%2FMRI Contrast.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/MRI Contrast.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>MRI Contrast</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-goals">Learning Goals</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-determines-t1-and-t2-values">What determines T1 and T2 values?</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#t1">T1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#t2">T2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">T2*</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#typical-t1-and-t2-values">Typical T1 and T2 values</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#t">1.5 T</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">3 T</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#te-and-t2-t2">TE and T2/T2*</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tr-and-t1">TR and T1</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#degree-flip-angles">90-degree flip angles</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">&lt; 90-degree flip angles</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#t1-t2-and-proton-density-weighting">T1, T2 and Proton Density Weighting</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#t2-weighting-and-t2-weighting">T2-weighting and T2*-weighting</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#t1-weighting">T1-weighting</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pd-weighting">PD-weighting</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inversion-recovery">Inversion Recovery</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#contrast-agents">Contrast Agents</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fat-water-imaging">Fat/Water Imaging</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#image-contrast-examples">Image Contrast Examples</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simple-contrast-phantom">Simple Contrast Phantom</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#challenge-yourself">Challenge Yourself!</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="mri-contrast">
<h1>MRI Contrast<a class="headerlink" href="#mri-contrast" title="Permalink to this heading">#</a></h1>
<p>MRI contrast is a rich dimension of information and the variety of contrasts achieveable is arguably the main advantage of MRI.  This section introduces the fundamental techniques of T1, T2, and proton density weighted contrasts, inversion recovery, Gd-based contrast agents, and fat/water imaging.</p>
<p><img alt="MRI is a modality with a multiple Contrasts" src="_images/3DMagic.gif" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-octave notranslate"><div class="highlight"><pre><span></span><span class="c">% setup MRI-education-resources path and requirements</span>
<span class="n">cd</span> <span class="p">.</span><span class="o">./</span>
<span class="n">startup</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>loading image
loading signal
</pre></div>
</div>
</div>
</div>
<section id="learning-goals">
<h2>Learning Goals<a class="headerlink" href="#learning-goals" title="Permalink to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Describe how various types of MRI contrast are created</p>
<ul class="simple">
<li><p>Describe how T1, T2, and proton density weighted images are formed</p></li>
<li><p>Describe how inversion recovery works</p></li>
<li><p>Describe how Gd-based contrast agents work</p></li>
<li><p>Describe how fat/water imaging works</p></li>
<li><p>Identify various image contrasts</p></li>
</ul>
</li>
<li><p>Manipulate MRI sequence parameters to improve performance</p>
<ul class="simple">
<li><p>Choose flip angle, TE, TR, and TI for desired contrast</p></li>
</ul>
</li>
</ol>
</section>
<section id="what-determines-t1-and-t2-values">
<h2>What determines T1 and T2 values?<a class="headerlink" href="#what-determines-t1-and-t2-values" title="Permalink to this heading">#</a></h2>
<p>T1 and T2 are intrinsic properties of materials that are determined by the molecular environment and structure, and provide a significant sources of tissue contrast.  While a precise understanding of what determines T1 and T2 requires quantum mechanics, typical patterns in these values can be described based on typical types of tissues found in the body.
human tissues can be approximately be divided into 4 classes of tissues that have similar T1 and T2 values:</p>
<ol class="arabic simple">
<li><p>Liquids/fluids</p></li>
<li><p>Solids (e.g. Cortical bone, tendons, fibrosis)</p></li>
<li><p>Fat</p></li>
<li><p>Proteinaceous materials (e.g. internal organs)</p></li>
</ol>
<section id="t1">
<h3>T1<a class="headerlink" href="#t1" title="Permalink to this heading">#</a></h3>
<p>T1 is also known as the spin-lattice relaxation time.  T1 is determined by the exchange of energy between spins and the surrounding “lattice” - the molecular structure around the spins.  The lattice is in constant motion, and will have characteristic motional frequencies.
The most efficient transfer of energy occurs when the natural motional frequencies are near the Larmor frequency(<span class="math notranslate nohighlight">\(f_0 = \bar{\gamma} B_0\)</span>), and natural motional frequencies depend on physical states of tissues:</p>
<ol class="arabic simple">
<li><p>Liquids/fluids: <strong>Longer T1</strong> due to higher natural motional frequencies of protons</p></li>
<li><p>Solids (e.g. Cortical bone, tendons, fibrosis): <strong>Intermediate T1</strong> due to lower natural motional frequencies of protons</p></li>
<li><p>Fat (lipids): <strong>Shorter T1</strong> since natural motion frequencies are similar to <span class="math notranslate nohighlight">\(f_0\)</span></p></li>
<li><p>Proteinaceous materials (e.g. internal organs): <strong>Intermediate T1</strong> due to lower natural motional frequencies of protons</p></li>
<li><p>Proteinaceous fluids (e.g. Edema): <strong>Shorter T1</strong> since water protons lose freedom of motion due to macromolecules, so natural motion frequencies are similar to  <span class="math notranslate nohighlight">\(f_0\)</span></p></li>
</ol>
</section>
<section id="t2">
<h3>T2<a class="headerlink" href="#t2" title="Permalink to this heading">#</a></h3>
<p>T2 is also known as the spin-spin relaxation time.  T2 is determined by coupling between adjacent spins.  This also includes the transfer of energy to the lattice that determines T1, meaning that T2 is always shorter that T1.
Stronger coupling between spins leads to more microscopic dephasing and shorter T2 values.</p>
<ol class="arabic simple">
<li><p>Liquids/fluids: <strong>Longer T2</strong> due to sparsity between water molecules and limited interaction between protons within a water molecule</p></li>
<li><p>Solids (e.g. Cortical bone, tendons, fibrosis): <strong>Shorter T2</strong> due to strong, fixed spin-spin coupling</p></li>
<li><p>Fat (lipids): <strong>Intermediate T2</strong> due to intermediate coupling</p></li>
<li><p>Proteinaceous materials (e.g. internal organs): <strong>Intermediate T2</strong> due to intermediate coupling</p></li>
</ol>
</section>
<section id="id1">
<h3>T2*<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h3>
<p>T2* is also a transverse decay time, and includes T2 as well as additional macroscopic dephasing due to local magnetic field inhomogeneities.  This means <span class="math notranslate nohighlight">\( T_2^* \leq T_2\)</span>.  The microscopic dephasing (T2) cannot be refocused, but the macroscopic dephasing effects can be refocused by using a spin echo sequence.  The macroscopic dephasing is caused by differences in magnetic susceptibility between materials and tissues.</p>
<p>While often the macroscopic dephasing effects creating T2* are often undesirable and considered artifacts, T2* is also an important source of contrast to reflect differences in magnetic susceptibility:</p>
<ol class="arabic simple">
<li><p>Iron deposition: The presence of iron in a tissue will create shorter T2* due to the strong magnetic susceptibility of iron.</p></li>
<li><p>Calcifications: The presence of calcium in a tissue will create shorter T2* due to the strong magnetic susceptibility of calcium.</p></li>
<li><p>Oxygenated vs deoxygenated blood: Deoxygenated blood will have shorter T2* than oxygenated blood due to the magnetic susceptibility of deoxygenated hemoglobin.  This can be used for selectively imaging veins, and is also the basis of blood oxygen level dependent (BOLD) functional MRI.</p></li>
</ol>
</section>
<section id="typical-t1-and-t2-values">
<h3>Typical T1 and T2 values<a class="headerlink" href="#typical-t1-and-t2-values" title="Permalink to this heading">#</a></h3>
<section id="t">
<h4>1.5 T<a class="headerlink" href="#t" title="Permalink to this heading">#</a></h4>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Tissue</p></th>
<th class="head"><p>T1 (ms)</p></th>
<th class="head"><p>T2 (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Brain white matter</p></td>
<td><p>790</p></td>
<td><p>90</p></td>
</tr>
<tr class="row-odd"><td><p>Brain gray matter</p></td>
<td><p>920</p></td>
<td><p>100</p></td>
</tr>
<tr class="row-even"><td><p>Cerebrospinal fluid (CSF)</p></td>
<td><p>&gt;4000</p></td>
<td><p>∼2000</p></td>
</tr>
<tr class="row-odd"><td><p>Blood (arterial)</p></td>
<td><p>1200</p></td>
<td><p>50</p></td>
</tr>
<tr class="row-even"><td><p>Liver parenchyma</p></td>
<td><p>490</p></td>
<td><p>40</p></td>
</tr>
<tr class="row-odd"><td><p>Lung</p></td>
<td><p>830</p></td>
<td><p>80</p></td>
</tr>
<tr class="row-even"><td><p>Myocardium</p></td>
<td><p>870</p></td>
<td><p>60</p></td>
</tr>
<tr class="row-odd"><td><p>Skeletal muscle</p></td>
<td><p>870</p></td>
<td><p>50</p></td>
</tr>
<tr class="row-even"><td><p>Lipids</p></td>
<td><p>260</p></td>
<td><p>80</p></td>
</tr>
</tbody>
</table>
<p>Source: <a class="reference external" href="https://www.sciencedirect.com/science/article/pii/B9780120928613500261#p961">Handbook of MRI Pulse Sequences</a></p>
</section>
<section id="id2">
<h4>3 T<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h4>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Tissue</p></th>
<th class="head"><p>T1 [ms]</p></th>
<th class="head"><p>T2 [ms]</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>White Matter</p></td>
<td><p>800</p></td>
<td><p>110</p></td>
</tr>
<tr class="row-odd"><td><p>Gray Matter</p></td>
<td><p>1300</p></td>
<td><p>80</p></td>
</tr>
<tr class="row-even"><td><p>CSF</p></td>
<td><p>3700</p></td>
<td><p>1700</p></td>
</tr>
<tr class="row-odd"><td><p>Muscle</p></td>
<td><p>1000</p></td>
<td><p>30</p></td>
</tr>
<tr class="row-even"><td><p>Fat</p></td>
<td><p>400</p></td>
<td><p>100</p></td>
</tr>
<tr class="row-odd"><td><p>Liver</p></td>
<td><p>800</p></td>
<td><p>40</p></td>
</tr>
<tr class="row-even"><td><p>Cartilage</p></td>
<td><p>1200</p></td>
<td><p>40</p></td>
</tr>
</tbody>
</table>
<p>Sources: <a class="reference external" href="https://www.cambridge.org/9781107011088">MRI from Picture to Proton</a>, <a class="reference external" href="https://www.sciencedirect.com/science/article/pii/B9780123744861000024">MRI: The Basics</a></p>
</section>
</section>
</section>
<section id="te-and-t2-t2">
<h2>TE and T2/T2*<a class="headerlink" href="#te-and-t2-t2" title="Permalink to this heading">#</a></h2>
<p>The transverse magnetization decays with <span class="math notranslate nohighlight">\(T_2\)</span> (spin-echoes) or <span class="math notranslate nohighlight">\(T_2^*\)</span> (gradient-echoes) once it is flipped by an RF pulse away from the z-axis.  Therefore, the <span class="math notranslate nohighlight">\(T_2/T_2^*\)</span> contrast can be controlled by choosing the echo time (TE), which is the time between the center of the RF excitation pulse and the center of the data acquisition (when the center of k-space is acquired).  The signal is then proportional to</p>
<div class="math notranslate nohighlight">
\[S_{GE} \propto M_0 \exp(-TE/T_2^*)\]</div>
<div class="math notranslate nohighlight">
\[S_{SE} \propto M_0 \exp(-TE/T_2)\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-octave notranslate"><div class="highlight"><pre><span></span><span class="c">% TE contrast</span>

<span class="n">TE</span> <span class="p">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">200</span><span class="p">);</span> <span class="c">% ms</span>
<span class="n">T2v</span> <span class="p">=</span> <span class="p">[</span><span class="mi">30</span><span class="p">;</span><span class="mi">60</span><span class="p">;</span><span class="mi">80</span><span class="p">;</span><span class="mi">100</span><span class="p">;</span><span class="mi">130</span><span class="p">;</span><span class="mi">200</span><span class="p">];</span>
<span class="p">[</span><span class="n">T2</span> <span class="n">TE</span><span class="p">]</span> <span class="p">=</span> <span class="nb">meshgrid</span><span class="p">(</span><span class="n">T2v</span><span class="p">,</span><span class="n">TE</span><span class="p">);</span>
<span class="n">M0</span> <span class="p">=</span> <span class="nb">ones</span><span class="p">(</span><span class="nb">size</span><span class="p">(</span><span class="n">T2</span><span class="p">));</span>

<span class="n">S_TE</span> <span class="p">=</span> <span class="n">M0</span><span class="o">.*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">TE</span><span class="o">./</span><span class="n">T2</span><span class="p">);</span>

<span class="nb">plot</span><span class="p">(</span><span class="n">TE</span><span class="p">,</span><span class="n">S_TE</span><span class="p">)</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;TE (ms)&#39;</span><span class="p">),</span> <span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;signal&#39;</span><span class="p">)</span>
<span class="nb">legend</span><span class="p">(</span><span class="n">int2str</span><span class="p">(</span><span class="n">T2v</span><span class="p">))</span>
<span class="nb">title</span><span class="p">(</span><span class="s">&#39;Signal versus TE for various T_2 values&#39;</span><span class="p">)</span>

<span class="n">TE</span> <span class="p">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">200</span><span class="p">);</span> <span class="c">% ms</span>
<span class="n">T2</span> <span class="p">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">150</span><span class="p">);</span> <span class="c">% ms</span>
<span class="p">[</span><span class="n">T2</span> <span class="n">TE</span><span class="p">]</span> <span class="p">=</span> <span class="nb">meshgrid</span><span class="p">(</span><span class="n">T2</span><span class="p">,</span><span class="n">TE</span><span class="p">);</span>
<span class="n">M0</span> <span class="p">=</span> <span class="nb">ones</span><span class="p">(</span><span class="nb">size</span><span class="p">(</span><span class="n">T2</span><span class="p">));</span>

<span class="n">S_TE</span> <span class="p">=</span> <span class="n">M0</span> <span class="o">.*</span> <span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">TE</span><span class="o">./</span><span class="n">T2</span><span class="p">);</span>

<span class="nb">figure</span>

<span class="nb">mesh</span><span class="p">(</span><span class="n">T2</span><span class="p">,</span><span class="n">TE</span><span class="p">,</span><span class="n">S_TE</span><span class="p">)</span>
<span class="nb">view</span><span class="p">([</span><span class="mi">155</span> <span class="mi">30</span><span class="p">])</span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;TE (ms)&#39;</span><span class="p">),</span> <span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;T_2 (ms)&#39;</span><span class="p">),</span> <span class="nb">zlabel</span><span class="p">(</span><span class="s">&#39;signal&#39;</span><span class="p">)</span>
<span class="nb">colorbar</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/923047e0d8c596167e3a9138ad869a8bd2fd9bce8e36b8fbb59a3b45364de9f6.png" src="_images/923047e0d8c596167e3a9138ad869a8bd2fd9bce8e36b8fbb59a3b45364de9f6.png" />
<img alt="_images/8f50f8e8bd21658cf2e9af7ccf38fcaf46453733fbc4077a5ed694f5bf20d1b2.png" src="_images/8f50f8e8bd21658cf2e9af7ccf38fcaf46453733fbc4077a5ed694f5bf20d1b2.png" />
</div>
</div>
</section>
<section id="tr-and-t1">
<h2>TR and T1<a class="headerlink" href="#tr-and-t1" title="Permalink to this heading">#</a></h2>
<p>The longitudinal magnetization recovers with <span class="math notranslate nohighlight">\(T_1\)</span> back to its equilibrium amplitude, <span class="math notranslate nohighlight">\(M_0\)</span>.  However, we do not directly measure the longitudinal magnetization.  In order to create <span class="math notranslate nohighlight">\(T_1\)</span> contrast in the MR signal, repeated RF pulses are applied with a given repetition time (TR), such that there is incomplete recovery of the longitudinal magnetization.  Then, after excitation, incomplete recovery appears in the transverse magnetization, creating <span class="math notranslate nohighlight">\(T_1\)</span> contrast.</p>
<section id="degree-flip-angles">
<h3>90-degree flip angles<a class="headerlink" href="#degree-flip-angles" title="Permalink to this heading">#</a></h3>
<p>The simplest case is using 90-degree flip angles every TR, in which case</p>
<div class="math notranslate nohighlight">
\[S \propto M_0 (1- \exp(-TR/T_1) )\]</div>
<p>Illustrated in the first example below.  This shows that the magnetization reaches steady state in the 2nd TR.</p>
</section>
<section id="id3">
<h3>&lt; 90-degree flip angles<a class="headerlink" href="#id3" title="Permalink to this heading">#</a></h3>
<p>For T1-weighting, it is generally more efficient in terms of signal acqruied per time to use &lt; 90-degree flip angles every TR, in which case</p>
<div class="math notranslate nohighlight">
\[S \propto M_0 \sin(\theta) \frac{1- \exp(-TR/T_1)}{1- \cos(\theta) \exp(-TR/T_1)}\]</div>
<p>Illustrated in this second example below.  This shows that the magnetization can take many TRs to reach steady state.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-octave notranslate"><div class="highlight"><pre><span></span><span class="c">% Signal evolution between TRs with 90-degree pulses</span>

<span class="n">M0</span> <span class="p">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">;</span><span class="mi">1</span><span class="p">;</span><span class="mi">1</span><span class="p">;</span><span class="mi">1</span><span class="p">];</span> 

<span class="n">T1</span> <span class="p">=</span> <span class="p">[</span><span class="mi">400</span><span class="p">;</span> <span class="mi">800</span><span class="p">;</span> <span class="mi">1200</span><span class="p">;</span> <span class="mi">2000</span><span class="p">];</span> <span class="c">%linspace(200,2000)&#39;; % ms</span>

<span class="n">NTR</span> <span class="p">=</span> <span class="mi">8</span><span class="p">;</span>
<span class="n">flip</span> <span class="p">=</span> <span class="mi">90</span><span class="p">;</span>
<span class="n">TR</span> <span class="p">=</span> <span class="mi">500</span><span class="p">;</span> <span class="c">%ms</span>
<span class="n">Nt_per_TR</span> <span class="p">=</span> <span class="mi">100</span><span class="p">;</span>
<span class="n">t_per_TR</span> <span class="p">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">Nt_per_TR</span><span class="p">]</span><span class="o">*</span><span class="n">TR</span><span class="o">/</span><span class="n">Nt_per_TR</span><span class="p">;</span>
<span class="n">t_minus</span> <span class="p">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">NTR</span><span class="p">]</span><span class="o">*</span><span class="n">TR</span><span class="p">;</span> <span class="n">t_plus</span> <span class="p">=</span> <span class="n">t_minus</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>

<span class="c">% magnetization before each RF pulse</span>
<span class="n">Mz_minus</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="nb">length</span><span class="p">(</span><span class="n">T1</span><span class="p">),</span> <span class="n">NTR</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
<span class="c">% magnetization after each RF pulse</span>
<span class="n">Mz_plus</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="nb">length</span><span class="p">(</span><span class="n">T1</span><span class="p">),</span> <span class="n">NTR</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>

<span class="c">% initial condition</span>
<span class="n">Mz_minus</span><span class="p">(:,</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="n">M0</span><span class="p">;</span>
<span class="n">Mz_plus</span><span class="p">(:,</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="n">Mz_minus</span><span class="p">(:,</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="nb">cos</span><span class="p">(</span><span class="n">flip</span><span class="o">*</span><span class="nb">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">);</span>
<span class="n">t</span> <span class="p">=</span> <span class="p">[</span><span class="mi">0</span> <span class="nb">eps</span><span class="p">];</span>
<span class="n">Mz_all</span> <span class="p">=</span> <span class="p">[</span><span class="n">Mz_minus</span><span class="p">(:,</span><span class="mi">1</span><span class="p">),</span><span class="n">Mz_plus</span><span class="p">(:,</span><span class="mi">1</span><span class="p">)];</span>


<span class="k">for</span> <span class="no">I</span> <span class="p">=</span> <span class="mi">1</span><span class="p">:</span><span class="n">NTR</span>
    <span class="n">t</span> <span class="p">=</span> <span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="n">t_per_TR</span> <span class="o">+</span> <span class="p">(</span><span class="no">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">TR</span><span class="p">];</span>

    <span class="k">for</span> <span class="n">It</span> <span class="p">=</span> <span class="mi">1</span><span class="p">:</span><span class="n">Nt_per_TR</span>
        <span class="n">Mz_all</span> <span class="p">=</span> <span class="p">[</span><span class="n">Mz_all</span><span class="p">,</span> <span class="n">Mz_plus</span><span class="p">(:,</span><span class="no">I</span><span class="p">)</span><span class="o">.*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t_per_TR</span><span class="p">(</span><span class="n">It</span><span class="p">)</span><span class="o">./</span><span class="n">T1</span><span class="p">)</span> <span class="o">+</span> <span class="n">M0</span><span class="o">.*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t_per_TR</span><span class="p">(</span><span class="n">It</span><span class="p">)</span><span class="o">./</span><span class="n">T1</span><span class="p">))];</span>
    <span class="k">end</span>
    
    <span class="n">Mz_minus</span><span class="p">(:,</span><span class="no">I</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="n">Mz_plus</span><span class="p">(:,</span><span class="no">I</span><span class="p">)</span><span class="o">.*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">TR</span><span class="o">./</span><span class="n">T1</span><span class="p">)</span> <span class="o">+</span> <span class="n">M0</span><span class="o">.*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">TR</span><span class="o">./</span><span class="n">T1</span><span class="p">));</span>
    <span class="n">Mz_plus</span><span class="p">(:,</span><span class="no">I</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="n">Mz_minus</span><span class="p">(:,</span><span class="no">I</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">.*</span><span class="nb">cos</span><span class="p">(</span><span class="n">flip</span><span class="o">*</span><span class="nb">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">);</span>


<span class="k">end</span>

<span class="nb">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Mz_all</span><span class="p">,</span> <span class="n">t_minus</span><span class="p">,</span> <span class="n">Mz_minus</span><span class="p">,</span> <span class="s">&#39;x&#39;</span><span class="p">,</span> <span class="n">t_plus</span><span class="p">,</span> <span class="n">Mz_plus</span><span class="p">,</span><span class="s">&#39;o&#39;</span><span class="p">)</span>
<span class="nb">legend</span><span class="p">(</span><span class="n">int2str</span><span class="p">(</span><span class="n">T1</span><span class="p">))</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;time (ms)&#39;</span><span class="p">),</span> <span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;M_Z&#39;</span><span class="p">)</span>
<span class="nb">title</span><span class="p">([</span><span class="n">num2str</span><span class="p">(</span><span class="n">flip</span><span class="p">)</span> <span class="s">&#39;-degree RF pulses applied every &#39;</span> <span class="n">num2str</span><span class="p">(</span><span class="n">TR</span><span class="p">)</span> <span class="s">&#39; ms&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/0d4eecd95f8a44e1d2fa4ca6934debcf78ff64cdcef47dbc4765d6553316e748.png" src="_images/0d4eecd95f8a44e1d2fa4ca6934debcf78ff64cdcef47dbc4765d6553316e748.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-octave notranslate"><div class="highlight"><pre><span></span><span class="c">% TR contrast with T1</span>

<span class="n">TR</span> <span class="p">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2000</span><span class="p">);</span> <span class="c">% ms</span>
<span class="n">T1v</span> <span class="p">=</span> <span class="p">[</span><span class="mi">400</span><span class="p">;</span> <span class="mi">800</span><span class="p">;</span> <span class="mi">1200</span><span class="p">;</span> <span class="mi">2000</span><span class="p">];</span> <span class="c">%linspace(200,2000)&#39;; % ms</span>
<span class="p">[</span><span class="n">T1</span> <span class="n">TR</span><span class="p">]</span> <span class="p">=</span> <span class="nb">meshgrid</span><span class="p">(</span><span class="n">T1v</span><span class="p">,</span><span class="n">TR</span><span class="p">);</span>
<span class="n">M0</span> <span class="p">=</span> <span class="nb">ones</span><span class="p">(</span><span class="nb">size</span><span class="p">(</span><span class="n">T1</span><span class="p">));</span>

<span class="n">S_TR</span> <span class="p">=</span> <span class="n">M0</span><span class="o">.*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">TR</span><span class="o">./</span><span class="n">T1</span><span class="p">));</span>

<span class="nb">plot</span><span class="p">(</span><span class="n">TR</span><span class="p">,</span><span class="n">S_TR</span><span class="p">)</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;TR (ms)&#39;</span><span class="p">),</span> <span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;signal&#39;</span><span class="p">)</span>
<span class="nb">legend</span><span class="p">(</span><span class="n">int2str</span><span class="p">(</span><span class="n">T1v</span><span class="p">))</span>
<span class="nb">title</span><span class="p">([</span><span class="s">&#39;Signal versus TR for various T_1 values with &#39;</span> <span class="n">num2str</span><span class="p">(</span><span class="n">flip</span><span class="p">)</span> <span class="s">&#39;-degree flip&#39;</span><span class="p">])</span>

<span class="n">TR</span> <span class="p">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2000</span><span class="p">);</span> <span class="c">% ms</span>
<span class="n">T1</span> <span class="p">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span><span class="mi">2500</span><span class="p">);</span> <span class="c">% ms</span>
<span class="p">[</span><span class="n">T1</span> <span class="n">TR</span><span class="p">]</span> <span class="p">=</span> <span class="nb">meshgrid</span><span class="p">(</span><span class="n">T1</span><span class="p">,</span><span class="n">TR</span><span class="p">);</span>
<span class="n">M0</span> <span class="p">=</span> <span class="nb">ones</span><span class="p">(</span><span class="nb">size</span><span class="p">(</span><span class="n">T1</span><span class="p">));</span>

<span class="n">S_TR</span> <span class="p">=</span> <span class="n">M0</span> <span class="o">.*</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">TR</span><span class="o">./</span><span class="n">T1</span><span class="p">));</span>

<span class="nb">figure</span>

<span class="nb">mesh</span><span class="p">(</span><span class="n">T1</span><span class="p">,</span><span class="n">TR</span><span class="p">,</span><span class="n">S_TR</span><span class="p">)</span>
<span class="nb">view</span><span class="p">([</span><span class="mi">110</span> <span class="mi">30</span><span class="p">])</span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;TR (ms)&#39;</span><span class="p">),</span> <span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;T_1 (ms)&#39;</span><span class="p">),</span> <span class="nb">zlabel</span><span class="p">(</span><span class="s">&#39;signal&#39;</span><span class="p">)</span>
<span class="nb">colorbar</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/51155c872e295067466de6b9eb18dfc55f2d03f2bde1464ca351604f4353fc47.png" src="_images/51155c872e295067466de6b9eb18dfc55f2d03f2bde1464ca351604f4353fc47.png" />
<img alt="_images/eda58af1383601bd31799acf1da6673f51aedf43bb9071f27aa042e63808fbbb.png" src="_images/eda58af1383601bd31799acf1da6673f51aedf43bb9071f27aa042e63808fbbb.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-octave notranslate"><div class="highlight"><pre><span></span><span class="c">% Signal evolution between TRs with &lt;90-degree pulses</span>

<span class="n">M0</span> <span class="p">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">;</span><span class="mi">1</span><span class="p">;</span><span class="mi">1</span><span class="p">;</span><span class="mi">1</span><span class="p">];</span> 
<span class="n">T1</span> <span class="p">=</span> <span class="p">[</span><span class="mi">400</span><span class="p">;</span> <span class="mi">800</span><span class="p">;</span> <span class="mi">1200</span><span class="p">;</span> <span class="mi">2000</span><span class="p">];</span> <span class="c">%linspace(200,2000)&#39;; % ms</span>

<span class="n">NTR</span> <span class="p">=</span> <span class="mi">30</span><span class="p">;</span>
<span class="n">flip</span> <span class="p">=</span> <span class="mi">30</span><span class="p">;</span>
<span class="n">TR</span> <span class="p">=</span> <span class="mi">100</span><span class="p">;</span> <span class="c">%ms</span>
<span class="n">Nt_per_TR</span> <span class="p">=</span> <span class="mi">100</span><span class="p">;</span>
<span class="n">t_per_TR</span> <span class="p">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">Nt_per_TR</span><span class="p">]</span><span class="o">*</span><span class="n">TR</span><span class="o">/</span><span class="n">Nt_per_TR</span><span class="p">;</span>
<span class="n">t_minus</span> <span class="p">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">NTR</span><span class="p">]</span><span class="o">*</span><span class="n">TR</span><span class="p">;</span> <span class="n">t_plus</span> <span class="p">=</span> <span class="n">t_minus</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>

<span class="c">% magnetization before each RF pulse</span>
<span class="n">Mz_minus</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="nb">length</span><span class="p">(</span><span class="n">T1</span><span class="p">),</span> <span class="n">NTR</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
<span class="c">% magnetization after each RF pulse</span>
<span class="n">Mz_plus</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="nb">length</span><span class="p">(</span><span class="n">T1</span><span class="p">),</span> <span class="n">NTR</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>

<span class="c">% initial condition</span>
<span class="n">Mz_minus</span><span class="p">(:,</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="n">M0</span><span class="p">;</span>
<span class="n">Mz_plus</span><span class="p">(:,</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="n">Mz_minus</span><span class="p">(:,</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="nb">cos</span><span class="p">(</span><span class="n">flip</span><span class="o">*</span><span class="nb">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">);</span>
<span class="n">t</span> <span class="p">=</span> <span class="p">[</span><span class="mi">0</span> <span class="nb">eps</span><span class="p">];</span>
<span class="n">Mz_all</span> <span class="p">=</span> <span class="p">[</span><span class="n">Mz_minus</span><span class="p">(:,</span><span class="mi">1</span><span class="p">),</span><span class="n">Mz_plus</span><span class="p">(:,</span><span class="mi">1</span><span class="p">)];</span>


<span class="k">for</span> <span class="no">I</span> <span class="p">=</span> <span class="mi">1</span><span class="p">:</span><span class="n">NTR</span>
    <span class="n">t</span> <span class="p">=</span> <span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="n">t_per_TR</span> <span class="o">+</span> <span class="p">(</span><span class="no">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">TR</span><span class="p">];</span>

    <span class="k">for</span> <span class="n">It</span> <span class="p">=</span> <span class="mi">1</span><span class="p">:</span><span class="n">Nt_per_TR</span>
        <span class="n">Mz_all</span> <span class="p">=</span> <span class="p">[</span><span class="n">Mz_all</span><span class="p">,</span> <span class="n">Mz_plus</span><span class="p">(:,</span><span class="no">I</span><span class="p">)</span><span class="o">.*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t_per_TR</span><span class="p">(</span><span class="n">It</span><span class="p">)</span><span class="o">./</span><span class="n">T1</span><span class="p">)</span> <span class="o">+</span> <span class="n">M0</span><span class="o">.*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t_per_TR</span><span class="p">(</span><span class="n">It</span><span class="p">)</span><span class="o">./</span><span class="n">T1</span><span class="p">))];</span>
    <span class="k">end</span>
    
    <span class="n">Mz_minus</span><span class="p">(:,</span><span class="no">I</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="n">Mz_plus</span><span class="p">(:,</span><span class="no">I</span><span class="p">)</span><span class="o">.*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">TR</span><span class="o">./</span><span class="n">T1</span><span class="p">)</span> <span class="o">+</span> <span class="n">M0</span><span class="o">.*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">TR</span><span class="o">./</span><span class="n">T1</span><span class="p">));</span>
    <span class="n">Mz_plus</span><span class="p">(:,</span><span class="no">I</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="n">Mz_minus</span><span class="p">(:,</span><span class="no">I</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">.*</span><span class="nb">cos</span><span class="p">(</span><span class="n">flip</span><span class="o">*</span><span class="nb">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">);</span>


<span class="k">end</span>

<span class="nb">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Mz_all</span><span class="p">,</span> <span class="n">t_minus</span><span class="p">,</span> <span class="n">Mz_minus</span><span class="p">,</span> <span class="s">&#39;x&#39;</span><span class="p">,</span> <span class="n">t_plus</span><span class="p">,</span> <span class="n">Mz_plus</span><span class="p">,</span><span class="s">&#39;o&#39;</span><span class="p">)</span>
<span class="nb">legend</span><span class="p">(</span><span class="n">int2str</span><span class="p">(</span><span class="n">T1</span><span class="p">))</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;time (ms)&#39;</span><span class="p">),</span> <span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;M_Z&#39;</span><span class="p">)</span>
<span class="nb">title</span><span class="p">([</span><span class="n">num2str</span><span class="p">(</span><span class="n">flip</span><span class="p">)</span> <span class="s">&#39;-degree RF pulses applied every &#39;</span> <span class="n">num2str</span><span class="p">(</span><span class="n">TR</span><span class="p">)</span> <span class="s">&#39; ms&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/92107963d8eef84f6f66f726b296d28c0b6532090f58481cdb8f8bd8e95aa231.png" src="_images/92107963d8eef84f6f66f726b296d28c0b6532090f58481cdb8f8bd8e95aa231.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-octave notranslate"><div class="highlight"><pre><span></span><span class="c">% TR and flip angle contrast with T1</span>

<span class="n">flip</span> <span class="p">=</span> <span class="mi">30</span><span class="p">;</span> <span class="c">% degrees</span>
<span class="n">TR</span> <span class="p">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2000</span><span class="p">);</span> <span class="c">% ms</span>
<span class="n">T1v</span> <span class="p">=</span> <span class="p">[</span><span class="mi">400</span><span class="p">;</span> <span class="mi">800</span><span class="p">;</span> <span class="mi">1200</span><span class="p">;</span> <span class="mi">2000</span><span class="p">];</span> <span class="c">%linspace(200,2000)&#39;; % ms</span>
<span class="p">[</span><span class="n">T1</span> <span class="n">TR</span><span class="p">]</span> <span class="p">=</span> <span class="nb">meshgrid</span><span class="p">(</span><span class="n">T1v</span><span class="p">,</span><span class="n">TR</span><span class="p">);</span>
<span class="n">M0</span> <span class="p">=</span> <span class="nb">ones</span><span class="p">(</span><span class="nb">size</span><span class="p">(</span><span class="n">T1</span><span class="p">));</span>

<span class="n">S_TR</span> <span class="p">=</span> <span class="nb">sin</span><span class="p">(</span><span class="n">flip</span><span class="o">*</span><span class="nb">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span> <span class="o">.*</span> <span class="n">M0</span> <span class="o">.*</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">TR</span><span class="o">./</span><span class="n">T1</span><span class="p">))</span> <span class="o">./</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="nb">cos</span><span class="p">(</span><span class="n">flip</span><span class="o">*</span><span class="nb">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span><span class="o">.*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">TR</span><span class="o">./</span><span class="n">T1</span><span class="p">));</span>

<span class="nb">plot</span><span class="p">(</span><span class="n">TR</span><span class="p">,</span><span class="n">S_TR</span><span class="p">)</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;TR (ms)&#39;</span><span class="p">),</span> <span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;signal&#39;</span><span class="p">)</span>
<span class="nb">legend</span><span class="p">(</span><span class="n">int2str</span><span class="p">(</span><span class="n">T1v</span><span class="p">))</span>
<span class="nb">title</span><span class="p">([</span><span class="s">&#39;Signal versus TR for various T_1 values with &#39;</span> <span class="n">num2str</span><span class="p">(</span><span class="n">flip</span><span class="p">)</span> <span class="s">&#39;-degree flip&#39;</span><span class="p">])</span>

<span class="n">TR</span> <span class="p">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2000</span><span class="p">);</span> <span class="c">% ms</span>
<span class="n">T1</span> <span class="p">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span><span class="mi">2500</span><span class="p">);</span> <span class="c">% ms</span>
<span class="p">[</span><span class="n">T1</span> <span class="n">TR</span><span class="p">]</span> <span class="p">=</span> <span class="nb">meshgrid</span><span class="p">(</span><span class="n">T1</span><span class="p">,</span><span class="n">TR</span><span class="p">);</span>
<span class="n">M0</span> <span class="p">=</span> <span class="nb">ones</span><span class="p">(</span><span class="nb">size</span><span class="p">(</span><span class="n">T1</span><span class="p">));</span>

<span class="n">S_TR</span> <span class="p">=</span> <span class="nb">sin</span><span class="p">(</span><span class="n">flip</span><span class="o">*</span><span class="nb">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span> <span class="o">.*</span> <span class="n">M0</span> <span class="o">.*</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">TR</span><span class="o">./</span><span class="n">T1</span><span class="p">))</span> <span class="o">./</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="nb">cos</span><span class="p">(</span><span class="n">flip</span><span class="o">*</span><span class="nb">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span><span class="o">.*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">TR</span><span class="o">./</span><span class="n">T1</span><span class="p">));</span>

<span class="nb">figure</span>

<span class="nb">mesh</span><span class="p">(</span><span class="n">T1</span><span class="p">,</span><span class="n">TR</span><span class="p">,</span><span class="n">S_TR</span><span class="p">)</span>
<span class="nb">view</span><span class="p">([</span><span class="mi">110</span> <span class="mi">30</span><span class="p">])</span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;TR (ms)&#39;</span><span class="p">),</span> <span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;T_1 (ms)&#39;</span><span class="p">),</span> <span class="nb">zlabel</span><span class="p">(</span><span class="s">&#39;signal&#39;</span><span class="p">)</span>
<span class="nb">title</span><span class="p">([</span> <span class="n">num2str</span><span class="p">(</span><span class="n">flip</span><span class="p">)</span> <span class="s">&#39;-degree flip&#39;</span><span class="p">])</span>
<span class="nb">colorbar</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c6c3ff86804fc90d6db5212bfaffb4036b4f55fb68b1aacabd4595848ea18bc0.png" src="_images/c6c3ff86804fc90d6db5212bfaffb4036b4f55fb68b1aacabd4595848ea18bc0.png" />
<img alt="_images/0d4792035a35c44d664f8baf02e3d129793ca861b5510c1e4b46e1482e65d58a.png" src="_images/0d4792035a35c44d664f8baf02e3d129793ca861b5510c1e4b46e1482e65d58a.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-octave notranslate"><div class="highlight"><pre><span></span><span class="n">TR</span> <span class="p">=</span> <span class="mi">100</span><span class="p">;</span>
<span class="n">flip</span> <span class="p">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">90</span><span class="p">);</span> <span class="c">% degrees</span>
<span class="n">T1v</span> <span class="p">=</span> <span class="p">[</span><span class="mi">400</span><span class="p">;</span> <span class="mi">800</span><span class="p">;</span> <span class="mi">1200</span><span class="p">;</span> <span class="mi">2000</span><span class="p">];</span> <span class="c">%linspace(200,2000)&#39;; % ms</span>
<span class="p">[</span><span class="n">T1</span> <span class="n">flip</span><span class="p">]</span> <span class="p">=</span> <span class="nb">meshgrid</span><span class="p">(</span><span class="n">T1v</span><span class="p">,</span><span class="n">flip</span><span class="p">);</span>
<span class="n">M0</span> <span class="p">=</span> <span class="nb">ones</span><span class="p">(</span><span class="nb">size</span><span class="p">(</span><span class="n">T1</span><span class="p">));</span>

<span class="n">S_flip</span> <span class="p">=</span> <span class="nb">sin</span><span class="p">(</span><span class="n">flip</span><span class="o">*</span><span class="nb">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span> <span class="o">.*</span> <span class="n">M0</span> <span class="o">.*</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">TR</span><span class="o">./</span><span class="n">T1</span><span class="p">))</span> <span class="o">./</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="nb">cos</span><span class="p">(</span><span class="n">flip</span><span class="o">*</span><span class="nb">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span><span class="o">.*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">TR</span><span class="o">./</span><span class="n">T1</span><span class="p">));</span>

<span class="nb">figure</span>
<span class="nb">plot</span><span class="p">(</span><span class="n">flip</span><span class="p">,</span><span class="n">S_flip</span><span class="p">)</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;flip angle (degrees)&#39;</span><span class="p">),</span> <span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;signal&#39;</span><span class="p">)</span>
<span class="nb">legend</span><span class="p">(</span><span class="n">int2str</span><span class="p">(</span><span class="n">T1v</span><span class="p">))</span>
<span class="nb">title</span><span class="p">([</span><span class="s">&#39;Signal versus flip angles for various T_1 values with TR = &#39;</span> <span class="n">num2str</span><span class="p">(</span><span class="n">TR</span><span class="p">)</span> <span class="s">&#39; ms&#39;</span><span class="p">])</span>


<span class="n">flip</span> <span class="p">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">90</span><span class="p">);</span> <span class="c">% degrees</span>
<span class="n">T1</span> <span class="p">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span><span class="mi">2500</span><span class="p">);</span> <span class="c">% ms</span>
<span class="p">[</span><span class="n">T1</span> <span class="n">flip</span><span class="p">]</span> <span class="p">=</span> <span class="nb">meshgrid</span><span class="p">(</span><span class="n">T1</span><span class="p">,</span><span class="n">flip</span><span class="p">);</span>
<span class="n">M0</span> <span class="p">=</span> <span class="nb">ones</span><span class="p">(</span><span class="nb">size</span><span class="p">(</span><span class="n">T1</span><span class="p">));</span>

<span class="n">S_flip</span> <span class="p">=</span> <span class="nb">sin</span><span class="p">(</span><span class="n">flip</span><span class="o">*</span><span class="nb">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span> <span class="o">.*</span> <span class="n">M0</span> <span class="o">.*</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">TR</span><span class="o">./</span><span class="n">T1</span><span class="p">))</span> <span class="o">./</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="nb">cos</span><span class="p">(</span><span class="n">flip</span><span class="o">*</span><span class="nb">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span><span class="o">.*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">TR</span><span class="o">./</span><span class="n">T1</span><span class="p">));</span>

<span class="nb">figure</span>

<span class="nb">mesh</span><span class="p">(</span><span class="n">T1</span><span class="p">,</span><span class="n">flip</span><span class="p">,</span><span class="n">S_flip</span><span class="p">)</span>
<span class="nb">view</span><span class="p">([</span><span class="mi">110</span> <span class="mi">30</span><span class="p">])</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;flip angle (degrees)&#39;</span><span class="p">),</span> <span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;T_1 (ms)&#39;</span><span class="p">),</span> <span class="nb">zlabel</span><span class="p">(</span><span class="s">&#39;signal&#39;</span><span class="p">)</span>
<span class="nb">title</span><span class="p">([</span><span class="s">&#39;TR = &#39;</span> <span class="n">num2str</span><span class="p">(</span><span class="n">TR</span><span class="p">)</span> <span class="s">&#39; ms&#39;</span><span class="p">])</span>
<span class="nb">colorbar</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/52233a0f28abe80974f1b637e60d8cc5cb1aa08bf61a4595b128cabc5cf9f3f0.png" src="_images/52233a0f28abe80974f1b637e60d8cc5cb1aa08bf61a4595b128cabc5cf9f3f0.png" />
<img alt="_images/e65e8bb9aad84cb0397af76301679e6145ae6a311f4e81457cf143c75d3b9071.png" src="_images/e65e8bb9aad84cb0397af76301679e6145ae6a311f4e81457cf143c75d3b9071.png" />
</div>
</div>
</section>
</section>
<section id="t1-t2-and-proton-density-weighting">
<h2>T1, T2 and Proton Density Weighting<a class="headerlink" href="#t1-t2-and-proton-density-weighting" title="Permalink to this heading">#</a></h2>
<p>By choosing the TE, TR and flip angle values in our pulse sequences and the relationships described above, we can create images that “weighted” by the MR properties of T1, T2, and proton density.  This means that the resulting images will have contrast between tissues that have different T1, T2 or proton density.</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>Short TE</p></th>
<th class="head"><p>Long TE</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Short TR</p></td>
<td><p>T1-weighted</p></td>
<td><p>Not used</p></td>
</tr>
<tr class="row-odd"><td><p>Long TR</p></td>
<td><p>PD-weighted</p></td>
<td><p>T2/T2*-weighted</p></td>
</tr>
</tbody>
</table>
<section id="t2-weighting-and-t2-weighting">
<h3>T2-weighting and T2*-weighting<a class="headerlink" href="#t2-weighting-and-t2-weighting" title="Permalink to this heading">#</a></h3>
<p>To create T2 weighting, the TE is chosen to be long enough such that the there are different amounts of transverse magnetization depending on the T2 value.  For example, at TE = 80 ms we can expect to see good contrast between white matter (<span class="math notranslate nohighlight">\(T_2 \approx 60\)</span> ms), gray matter (<span class="math notranslate nohighlight">\(T_2 \approx 80\)</span> ms), and cerebrospinal fluid (<span class="math notranslate nohighlight">\(T_2 \approx 1500\)</span> ms) in the brain (see simulations above).</p>
<p>The TR is chosen to be long relative to T1 values.  This allows the net magnetization to fully recover each repetition, and thereby eliminating any T1-weighting.</p>
<p>In T2/T2* weighting, longer T2/T2* tissues have higher signal than shorter T2/T2* tissues.</p>
<p>The difference between <span class="math notranslate nohighlight">\(T_2\)</span> and <span class="math notranslate nohighlight">\(T_2^*\)</span> weighting depends on the choice of pulse sequence: <span class="math notranslate nohighlight">\(T_2\)</span>-weighting comes from spin-echoes while <span class="math notranslate nohighlight">\(T_2^*\)</span>-weighting comes from gradient-echoes.   These are discussed later.  The same principle applies of choosing a long enough TE, and a long TR.</p>
</section>
<section id="t1-weighting">
<h3>T1-weighting<a class="headerlink" href="#t1-weighting" title="Permalink to this heading">#</a></h3>
<p>To create T1 weighting, the TR is chosen to be short enough such that there is incomplete recovery of the net magnetization each repetition.  This means that the signal acquired will depend on T1.  For example. choosing a TR = 500 ms with a 90-degree flip angle we can expect to see contrast between fat (<span class="math notranslate nohighlight">\(T_1 \approx 400\)</span> ms) and muscle (<span class="math notranslate nohighlight">\(T_1 \approx 1200\)</span> ms)  (see simulations above).</p>
<p>For T1-weighting, we also can use smaller flip angles and smaller TRs to boost the overall signal.  For example. choosing a TR = 200 ms with a 30-degree flip angle we can expect to see contrast between fat (<span class="math notranslate nohighlight">\(T_1 \approx 400\)</span> ms) and muscle (<span class="math notranslate nohighlight">\(T_1 \approx 1200\)</span> ms) but more overall signal (see simulations above).</p>
<p>The TE is chosen to be short relative to T2 values.  This reduces T2-weighting.</p>
<p>In T1 weighting, shorter T1 tissues have higher signal than longer T1 tissues.</p>
</section>
<section id="pd-weighting">
<h3>PD-weighting<a class="headerlink" href="#pd-weighting" title="Permalink to this heading">#</a></h3>
<p>To create proton density (PD) weighting, we choose a short TE to reduce T2-weighting and a long TR to reduce T1-weighting.  This leaves the image contrast dependent on the proton density, which is captured in the equilibrium magnetization, <span class="math notranslate nohighlight">\(M_0\)</span>.</p>
<p>In PD weighting, higher PD tissues have higher signal than lower PD tissues.</p>
<p>Proton-density weighting can be achieved with short TRs when using very small flip angles.  This weighting applies up to a certain <span class="math notranslate nohighlight">\(TR/T_1\)</span> ratio.  This can be seen in the following by zooming in on the low flip angle area from the plots above and noting that there is no difference between the signal for different <span class="math notranslate nohighlight">\(T_1\)</span> values, meaning the T1-weighting has been removed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-octave notranslate"><div class="highlight"><pre><span></span><span class="n">TR</span> <span class="p">=</span> <span class="mi">10</span><span class="p">;</span>
<span class="n">flip</span> <span class="p">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">);</span> <span class="c">% degrees</span>
<span class="n">T1v</span> <span class="p">=</span> <span class="p">[</span><span class="mi">400</span><span class="p">;</span> <span class="mi">800</span><span class="p">;</span> <span class="mi">1200</span><span class="p">;</span> <span class="mi">2000</span><span class="p">];</span> <span class="c">%linspace(200,2000)&#39;; % ms</span>
<span class="p">[</span><span class="n">T1</span> <span class="n">flip</span><span class="p">]</span> <span class="p">=</span> <span class="nb">meshgrid</span><span class="p">(</span><span class="n">T1v</span><span class="p">,</span><span class="n">flip</span><span class="p">);</span>
<span class="n">M0</span> <span class="p">=</span> <span class="nb">ones</span><span class="p">(</span><span class="nb">size</span><span class="p">(</span><span class="n">T1</span><span class="p">));</span>

<span class="n">S_flip</span> <span class="p">=</span> <span class="nb">sin</span><span class="p">(</span><span class="n">flip</span><span class="o">*</span><span class="nb">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span> <span class="o">.*</span> <span class="n">M0</span> <span class="o">.*</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">TR</span><span class="o">./</span><span class="n">T1</span><span class="p">))</span> <span class="o">./</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="nb">cos</span><span class="p">(</span><span class="n">flip</span><span class="o">*</span><span class="nb">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span><span class="o">.*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">TR</span><span class="o">./</span><span class="n">T1</span><span class="p">));</span>

<span class="nb">figure</span>
<span class="nb">plot</span><span class="p">(</span><span class="n">flip</span><span class="p">,</span><span class="n">S_flip</span><span class="p">)</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;flip angle (degrees)&#39;</span><span class="p">),</span> <span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;signal&#39;</span><span class="p">)</span>
<span class="nb">legend</span><span class="p">(</span><span class="n">int2str</span><span class="p">(</span><span class="n">T1v</span><span class="p">))</span>
<span class="nb">title</span><span class="p">([</span><span class="s">&#39;Signal versus flip angles for various T_1 values with TR = &#39;</span> <span class="n">num2str</span><span class="p">(</span><span class="n">TR</span><span class="p">)</span> <span class="s">&#39; ms&#39;</span><span class="p">])</span>


<span class="n">flip</span> <span class="p">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">);</span> <span class="c">% degrees</span>
<span class="n">T1</span> <span class="p">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span><span class="mi">2500</span><span class="p">);</span> <span class="c">% ms</span>
<span class="p">[</span><span class="n">T1</span> <span class="n">flip</span><span class="p">]</span> <span class="p">=</span> <span class="nb">meshgrid</span><span class="p">(</span><span class="n">T1</span><span class="p">,</span><span class="n">flip</span><span class="p">);</span>
<span class="n">M0</span> <span class="p">=</span> <span class="nb">ones</span><span class="p">(</span><span class="nb">size</span><span class="p">(</span><span class="n">T1</span><span class="p">));</span>

<span class="n">S_flip</span> <span class="p">=</span> <span class="nb">sin</span><span class="p">(</span><span class="n">flip</span><span class="o">*</span><span class="nb">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span> <span class="o">.*</span> <span class="n">M0</span> <span class="o">.*</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">TR</span><span class="o">./</span><span class="n">T1</span><span class="p">))</span> <span class="o">./</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="nb">cos</span><span class="p">(</span><span class="n">flip</span><span class="o">*</span><span class="nb">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span><span class="o">.*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">TR</span><span class="o">./</span><span class="n">T1</span><span class="p">));</span>

<span class="nb">figure</span>

<span class="nb">mesh</span><span class="p">(</span><span class="n">T1</span><span class="p">,</span><span class="n">flip</span><span class="p">,</span><span class="n">S_flip</span><span class="p">)</span>
<span class="nb">view</span><span class="p">([</span><span class="mi">110</span> <span class="mi">30</span><span class="p">])</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;flip angle (degrees)&#39;</span><span class="p">),</span> <span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;T_1 (ms)&#39;</span><span class="p">),</span> <span class="nb">zlabel</span><span class="p">(</span><span class="s">&#39;signal&#39;</span><span class="p">)</span>
<span class="nb">title</span><span class="p">([</span><span class="s">&#39;TR = &#39;</span> <span class="n">num2str</span><span class="p">(</span><span class="n">TR</span><span class="p">)</span> <span class="s">&#39; ms&#39;</span><span class="p">])</span>
<span class="nb">colorbar</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/32c7c2697e4c495b7dd92e7266cf7c91442b8542fdedcec2f962653d181da4d5.png" src="_images/32c7c2697e4c495b7dd92e7266cf7c91442b8542fdedcec2f962653d181da4d5.png" />
<img alt="_images/1479be1734020c10caacc2d742465f39a30e5f249d4ea87cc85214af1fdedb47.png" src="_images/1479be1734020c10caacc2d742465f39a30e5f249d4ea87cc85214af1fdedb47.png" />
</div>
</div>
</section>
</section>
<section id="inversion-recovery">
<h2>Inversion Recovery<a class="headerlink" href="#inversion-recovery" title="Permalink to this heading">#</a></h2>
<p>Another way to create <span class="math notranslate nohighlight">\(T_1\)</span> contrast are “Inversion Recovery” techniques.  These use a 180-degree inversion pulse, following by an Inversion Time <span class="math notranslate nohighlight">\(TI\)</span> delay during which <span class="math notranslate nohighlight">\(T_1\)</span> contrast is created.  Then the magnetization is excited with a 90-degree pulse.</p>
<p>This strategy is commonly used to null tissue types.  For example, so-called short-time inversion recovery (STIR) is used to null fat signals, while fluid attenuated inversion recovery (FLAIR) is used to null fluids.</p>
<div class="math notranslate nohighlight">
\[S_{IR} \propto M_0 (1 - 2\exp(-TI/T_1) + \exp(-TR/T_1) )\]</div>
<p>The illustration below shows that the magnetization reaches steady state in the 2nd TR of inversion recovery.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-octave notranslate"><div class="highlight"><pre><span></span><span class="c">% Inversion Recovery</span>

<span class="n">T1</span> <span class="p">=</span> <span class="p">[</span><span class="mi">400</span><span class="p">;</span> <span class="mi">800</span><span class="p">;</span> <span class="mi">1200</span><span class="p">;</span> <span class="mi">2000</span><span class="p">];</span>
<span class="n">M0</span> <span class="p">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">;</span><span class="mi">1</span><span class="p">;</span><span class="mi">1</span><span class="p">;</span><span class="mi">1</span><span class="p">];</span> 

<span class="n">NTR</span> <span class="p">=</span> <span class="mi">3</span><span class="p">;</span>
<span class="n">flip1</span> <span class="p">=</span> <span class="mi">180</span><span class="p">;</span> <span class="n">flip2</span> <span class="p">=</span> <span class="mi">90</span><span class="p">;</span>
<span class="n">TR</span> <span class="p">=</span> <span class="mi">2000</span><span class="p">;</span> <span class="c">%ms</span>
<span class="n">TI</span> <span class="p">=</span> <span class="mi">750</span><span class="p">;</span> <span class="c">% ms</span>

<span class="n">dt</span> <span class="p">=</span> <span class="mi">5</span><span class="p">;</span> <span class="c">% ms</span>
<span class="n">t_per_TR</span> <span class="p">=</span> <span class="n">dt</span><span class="p">:</span><span class="n">dt</span><span class="p">:</span><span class="n">TR</span><span class="p">;</span>

<span class="c">% magnetization before each RF pulse</span>
<span class="n">Mz1_minus</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="nb">length</span><span class="p">(</span><span class="n">T1</span><span class="p">),</span> <span class="n">NTR</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
<span class="n">Mz2_minus</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="nb">length</span><span class="p">(</span><span class="n">T1</span><span class="p">),</span> <span class="n">NTR</span><span class="p">);</span>

<span class="c">% magnetization after each RF pulse</span>
<span class="n">Mz1_plus</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="nb">length</span><span class="p">(</span><span class="n">T1</span><span class="p">),</span> <span class="n">NTR</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
<span class="n">Mz2_plus</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="nb">length</span><span class="p">(</span><span class="n">T1</span><span class="p">),</span> <span class="n">NTR</span><span class="p">);</span>

<span class="c">% time of RF pulses</span>
<span class="n">t1_minus</span> <span class="p">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">NTR</span><span class="p">]</span><span class="o">*</span><span class="n">TR</span><span class="p">;</span> <span class="n">t1_plus</span> <span class="p">=</span> <span class="n">t1_minus</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>  <span class="c">% flip1, 180-degrees</span>
<span class="n">t2_minus</span> <span class="p">=</span> <span class="n">t1_minus</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="k">end</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">TI</span><span class="p">;</span> <span class="n">t2_plus</span> <span class="p">=</span> <span class="n">t1_plus</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="k">end</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">TI</span><span class="p">;</span>


<span class="c">% initial condition</span>
<span class="n">Mz1_minus</span><span class="p">(:,</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="n">M0</span><span class="p">;</span>
<span class="n">Mz1_plus</span><span class="p">(:,</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="n">Mz1_minus</span><span class="p">(:,</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="nb">cos</span><span class="p">(</span><span class="n">flip1</span><span class="o">*</span><span class="nb">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">);</span>
<span class="n">Mz_all</span> <span class="p">=</span> <span class="p">[</span><span class="n">Mz1_minus</span><span class="p">(:,</span><span class="mi">1</span><span class="p">),</span><span class="n">Mz1_plus</span><span class="p">(:,</span><span class="mi">1</span><span class="p">)];</span>
<span class="n">t</span><span class="p">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="nb">eps</span><span class="p">];</span>

<span class="k">for</span> <span class="no">I</span> <span class="p">=</span> <span class="mi">1</span><span class="p">:</span><span class="n">NTR</span>
    <span class="n">t</span> <span class="p">=</span> <span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="n">t_per_TR</span> <span class="o">+</span> <span class="p">(</span><span class="no">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">TR</span><span class="p">];</span>

    <span class="c">% evolve for TI period after 180-pulse</span>
    <span class="k">for</span> <span class="n">It</span> <span class="p">=</span> <span class="nb">find</span><span class="p">(</span><span class="n">t_per_TR</span> <span class="o">&lt;</span> <span class="n">TI</span><span class="p">)</span>
        <span class="n">Mz_all</span> <span class="p">=</span> <span class="p">[</span><span class="n">Mz_all</span><span class="p">,</span> <span class="n">Mz1_plus</span><span class="p">(:,</span><span class="no">I</span><span class="p">)</span><span class="o">.*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t_per_TR</span><span class="p">(</span><span class="n">It</span><span class="p">)</span><span class="o">./</span><span class="n">T1</span><span class="p">)</span> <span class="o">+</span> <span class="n">M0</span><span class="o">.*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t_per_TR</span><span class="p">(</span><span class="n">It</span><span class="p">)</span><span class="o">./</span><span class="n">T1</span><span class="p">))];</span>
    <span class="k">end</span>
    
    <span class="n">Mz2_minus</span><span class="p">(:,</span><span class="no">I</span><span class="p">)</span> <span class="p">=</span> <span class="n">Mz1_plus</span><span class="p">(:,</span><span class="no">I</span><span class="p">)</span><span class="o">.*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">TI</span><span class="o">./</span><span class="n">T1</span><span class="p">)</span> <span class="o">+</span> <span class="n">M0</span><span class="o">.*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">TI</span><span class="o">./</span><span class="n">T1</span><span class="p">));</span>
    <span class="n">Mz2_plus</span><span class="p">(:,</span><span class="no">I</span><span class="p">)</span> <span class="p">=</span> <span class="n">Mz2_minus</span><span class="p">(:,</span><span class="no">I</span><span class="p">)</span><span class="o">.*</span><span class="nb">cos</span><span class="p">(</span><span class="n">flip2</span><span class="o">*</span><span class="nb">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">);</span>

    <span class="k">for</span> <span class="n">It</span> <span class="p">=</span> <span class="nb">find</span><span class="p">(</span><span class="n">t_per_TR</span> <span class="o">&gt;</span><span class="p">=</span> <span class="n">TI</span><span class="p">)</span>
        <span class="n">Mz_all</span> <span class="p">=</span> <span class="p">[</span><span class="n">Mz_all</span><span class="p">,</span> <span class="n">Mz2_plus</span><span class="p">(:,</span><span class="no">I</span><span class="p">)</span><span class="o">.*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">t_per_TR</span><span class="p">(</span><span class="n">It</span><span class="p">)</span><span class="o">-</span><span class="n">TI</span><span class="p">)</span><span class="o">./</span><span class="n">T1</span><span class="p">)</span> <span class="o">+</span> <span class="n">M0</span><span class="o">.*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">t_per_TR</span><span class="p">(</span><span class="n">It</span><span class="p">)</span><span class="o">-</span><span class="n">TI</span><span class="p">)</span><span class="o">./</span><span class="n">T1</span><span class="p">))];</span>
    <span class="k">end</span>
    
    <span class="n">Mz1_minus</span><span class="p">(:,</span><span class="no">I</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="n">Mz2_plus</span><span class="p">(:,</span><span class="no">I</span><span class="p">)</span><span class="o">.*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">TR</span><span class="o">-</span><span class="n">TI</span><span class="p">)</span><span class="o">./</span><span class="n">T1</span><span class="p">)</span> <span class="o">+</span> <span class="n">M0</span><span class="o">.*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">TR</span><span class="o">-</span><span class="n">TI</span><span class="p">)</span><span class="o">./</span><span class="n">T1</span><span class="p">));</span>
    <span class="n">Mz1_plus</span><span class="p">(:,</span><span class="no">I</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="n">Mz1_minus</span><span class="p">(:,</span><span class="no">I</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">.*</span><span class="nb">cos</span><span class="p">(</span><span class="n">flip1</span><span class="o">*</span><span class="nb">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">);</span>

<span class="k">end</span>

<span class="nb">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Mz_all</span><span class="p">,</span> <span class="n">t1_minus</span><span class="p">,</span> <span class="n">Mz1_minus</span><span class="p">.</span><span class="o">&#39;</span><span class="p">,</span> <span class="s">&#39;x&#39;</span><span class="p">,</span> <span class="n">t1_plus</span><span class="p">,</span> <span class="n">Mz1_plus</span><span class="p">.</span><span class="o">&#39;</span><span class="p">,</span><span class="s">&#39;o&#39;</span><span class="p">,</span> <span class="n">t2_minus</span><span class="p">,</span> <span class="n">Mz2_minus</span><span class="p">,</span> <span class="s">&#39;x&#39;</span><span class="p">,</span> <span class="n">t2_plus</span><span class="p">,</span> <span class="n">Mz2_plus</span><span class="p">,</span><span class="s">&#39;o&#39;</span><span class="p">)</span>
<span class="nb">legend</span><span class="p">(</span><span class="n">int2str</span><span class="p">(</span><span class="n">T1</span><span class="p">))</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;time (ms)&#39;</span><span class="p">),</span> <span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;M_Z&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>t1_plus =

      1   2001   4001   6001

t2_plus =

    751   2751   4751
</pre></div>
</div>
<img alt="_images/7da249473254ed1ffbf7e130f32a5dc76cec0ff2f273ef1bdb81210d30557731.png" src="_images/7da249473254ed1ffbf7e130f32a5dc76cec0ff2f273ef1bdb81210d30557731.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-octave notranslate"><div class="highlight"><pre><span></span><span class="c">% Inversion Recovery, TI vs T1</span>

<span class="n">TR</span> <span class="p">=</span> <span class="mi">2000</span><span class="p">;</span> <span class="c">% ms</span>
<span class="n">TI</span> <span class="p">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2000</span><span class="p">);</span> <span class="c">% ms</span>
<span class="n">T1v</span> <span class="p">=</span> <span class="p">[</span><span class="mi">400</span><span class="p">;</span> <span class="mi">800</span><span class="p">;</span> <span class="mi">1200</span><span class="p">;</span> <span class="mi">2000</span><span class="p">];</span> <span class="c">%linspace(200,2000)&#39;; % ms</span>
<span class="p">[</span><span class="n">T1</span> <span class="n">TI</span><span class="p">]</span> <span class="p">=</span> <span class="nb">meshgrid</span><span class="p">(</span><span class="n">T1v</span><span class="p">,</span><span class="n">TI</span><span class="p">);</span>
<span class="n">M0</span> <span class="p">=</span> <span class="nb">ones</span><span class="p">(</span><span class="nb">size</span><span class="p">(</span><span class="n">T1</span><span class="p">));</span>

<span class="n">S_TI</span> <span class="p">=</span> <span class="n">M0</span><span class="o">.*</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">TI</span><span class="o">./</span><span class="n">T1</span><span class="p">)</span> <span class="o">+</span> <span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">TR</span><span class="o">./</span><span class="n">T1</span><span class="p">));</span>

<span class="nb">plot</span><span class="p">(</span><span class="n">TI</span><span class="p">,</span><span class="n">S_TI</span><span class="p">)</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;TI (ms)&#39;</span><span class="p">),</span> <span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;signal&#39;</span><span class="p">)</span>
<span class="nb">legend</span><span class="p">(</span><span class="n">int2str</span><span class="p">(</span><span class="n">T1v</span><span class="p">))</span>
<span class="nb">title</span><span class="p">([</span><span class="s">&#39;Signal versus TI for various T_1 values with TR = &#39;</span> <span class="n">num2str</span><span class="p">(</span><span class="n">TR</span><span class="p">)</span> <span class="s">&#39; ms&#39;</span><span class="p">])</span>

<span class="n">TR</span> <span class="p">=</span> <span class="mi">2000</span><span class="p">;</span>
<span class="n">TI</span> <span class="p">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2000</span><span class="p">);</span> <span class="c">% ms</span>
<span class="n">T1</span> <span class="p">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span><span class="mi">2500</span><span class="p">);</span> <span class="c">% ms</span>
<span class="p">[</span><span class="n">T1</span> <span class="n">TI</span><span class="p">]</span> <span class="p">=</span> <span class="nb">meshgrid</span><span class="p">(</span><span class="n">T1</span><span class="p">,</span><span class="n">TI</span><span class="p">);</span>
<span class="n">M0</span> <span class="p">=</span> <span class="nb">ones</span><span class="p">(</span><span class="nb">size</span><span class="p">(</span><span class="n">T1</span><span class="p">));</span>

<span class="n">S_TI</span> <span class="p">=</span> <span class="n">M0</span><span class="o">.*</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">TI</span><span class="o">./</span><span class="n">T1</span><span class="p">)</span> <span class="o">+</span> <span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">TR</span><span class="o">./</span><span class="n">T1</span><span class="p">));</span>

<span class="nb">figure</span>

<span class="nb">mesh</span><span class="p">(</span><span class="n">T1</span><span class="p">,</span><span class="n">TI</span><span class="p">,</span><span class="n">S_TI</span><span class="p">)</span>
<span class="nb">view</span><span class="p">([</span><span class="mi">110</span> <span class="mi">30</span><span class="p">])</span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;TI (ms)&#39;</span><span class="p">),</span> <span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;T_1 (ms)&#39;</span><span class="p">),</span> <span class="nb">zlabel</span><span class="p">(</span><span class="s">&#39;signal&#39;</span><span class="p">)</span>
<span class="nb">colorbar</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c04df850b80cee23d28fc11f804602ddc0cf9a1d70d3790fdef2ad283b961004.png" src="_images/c04df850b80cee23d28fc11f804602ddc0cf9a1d70d3790fdef2ad283b961004.png" />
<img alt="_images/4fa0b11786811417d054720695cd8f59dcc588f5487d734e5d9c45971f63f1be.png" src="_images/4fa0b11786811417d054720695cd8f59dcc588f5487d734e5d9c45971f63f1be.png" />
</div>
</div>
</section>
<section id="contrast-agents">
<h2>Contrast Agents<a class="headerlink" href="#contrast-agents" title="Permalink to this heading">#</a></h2>
<p>Contrast agents used in MRI, such as gadolinium chelates and superparamagnetic iron oxides, shorten the relaxation rates wherever they are present.
This is quantified by their relaxivities, <span class="math notranslate nohighlight">\(r_1, r_2\)</span>, typiclaly in units of [L / (mmol s)]:</p>
<div class="math notranslate nohighlight">
\[\frac{1}{\hat{T}_1} = \frac{1}{T_1} + r_1 \cdot [CM]\]</div>
<div class="math notranslate nohighlight">
\[\frac{1}{\hat{T}_2} = \frac{1}{T_2} + r_2 \cdot [CM]\]</div>
<p>Where <span class="math notranslate nohighlight">\(\hat{T}_1, \hat{T}_2\)</span> are the relaxation time constants with the agent present, and <span class="math notranslate nohighlight">\([CM]\)</span> is the contrast agent concentration, typically in units of [mM = mmol/L].</p>
<!-- 

https://doi.org/10.1097/01.rli.0000184756.66360.d3

% MAGNETVIST R1 = 4.3 l/MMOL/S R2 = 4.4
% resovist (iron) r1 = 7  r2 = 77
% 0.5 mM 
></section>
<section id="fat-water-imaging">
<h2>Fat/Water Imaging<a class="headerlink" href="#fat-water-imaging" title="Permalink to this heading">#</a></h2>
<p>The major sources of signal in MRI are hydrogen atoms in water molecules and hydrogen atoms in lipids.  In lipids, the protons experience a different chemical shift, meaning they have a different resonance frequence from water protons.  This can be exploited to create images that isolate fat and water signals.</p>
<p>While lipids have a relatively complex set of chemical shifts, in MRI a general “fat” signal is typically modeled as a single peak that has a -3.5 parts per million (ppm) shift from water.  This leads to a resonance frequency shift <span class="math notranslate nohighlight">\(\Delta f_{cs}\)</span> of approximately 220 Hz at 1.5 T and 440 Hz at 3 T.</p>
<p>Separate fat and water images are created by so-called “Dixon” methods, which acquire images at multiple echo times and then use the phase differences that result from the different resonance frequencies to separate them.  Ideally, the signal in these images can be represented as</p>
<div class="math notranslate nohighlight">
\[S(TE) = S_{water} + S_{fat} exp(-i 2 \pi \Delta f_{cs} TE)\]</div>
<p>Then fat and water images can be created from in-phase TE, <span class="math notranslate nohighlight">\(TE_{in-phase} = n / \Delta f_{cs}\)</span> and out-of-phase TE, <span class="math notranslate nohighlight">\(TE_{out-of-phase} = (n+ 1/2) / \Delta f_{cs}\)</span>, images:</p>
<div class="math notranslate nohighlight">
\[ S(TE_{in-phase}) = S_{water} + S_{fat}\]</div>
<div class="math notranslate nohighlight">
\[ S(TE_{out-of-phase}) = S_{water} - S_{fat}\]</div>
<div class="math notranslate nohighlight">
\[ \hat S_{water} = S(TE_{in-phase}) + S(TE_{out-of-phase})\]</div>
<div class="math notranslate nohighlight">
\[ \hat S_{fat} = S(TE_{in-phase}) - S(TE_{out-of-phase})\]</div>
<p>In reality, additional corrections are required to account for off-resonance, <span class="math notranslate nohighlight">\(\Delta f_r(\vec r)\)</span>, and more advanced methods also use a multi-peak model accounting for the various chemical shifts in fatty tissue.</p>
</section>
<section id="image-contrast-examples">
<h2>Image Contrast Examples<a class="headerlink" href="#image-contrast-examples" title="Permalink to this heading">#</a></h2>
<p><img alt="Brain contrast from Pauly and Gold" src="_images/contrast_brain_example.png" /></p>
<p><img alt="Brain contrast from Vasily Yarnkh" src="_images/contrast_brain_example-all.png" /></p>
<p><img alt="Knee contrast" src="_images/contrast_knee_example.png" /></p>
</section>
<section id="simple-contrast-phantom">
<h2>Simple Contrast Phantom<a class="headerlink" href="#simple-contrast-phantom" title="Permalink to this heading">#</a></h2>
<p>Below is a simple contrast phantom consisting of three circular objects, each with a different <span class="math notranslate nohighlight">\(T_1\)</span> and <span class="math notranslate nohighlight">\(T_2\)</span>.  The k-space data for these phantoms is created using a “jinc” function, which is the Fourier Transform of a circle:</p>
<div class="math notranslate nohighlight">
\[\mathcal{F}\{ \mathrm{circ}(r) \} = \mathrm{jinc}(k_r)\]</div>
<p>The signal is simulated for varying sequence parameters (TE, TR) with a 90-degree flip angle in a gradient-echo scheme by using the helper function:</p>
<div class="highlight-Octave notranslate"><div class="highlight"><pre><span></span><span class="n">signal_gre</span> <span class="p">=</span> <span class="n">MRsignal_spoiled_gradient_echo</span><span class="p">(</span><span class="n">flip</span><span class="p">,</span> <span class="n">TE</span><span class="p">,</span> <span class="n">TR</span><span class="p">,</span> <span class="n">M0</span><span class="p">,</span> <span class="n">T1</span><span class="p">,</span> <span class="n">T2</span><span class="p">)</span>
</pre></div>
</div>
<section id="challenge-yourself">
<h3>Challenge Yourself!<a class="headerlink" href="#challenge-yourself" title="Permalink to this heading">#</a></h3>
<p>Based on the images and TE/TR parameters below, can you estimate T1 and T2 relaxation times of the 3 objects?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-octave notranslate"><div class="highlight"><pre><span></span><span class="c">% contrast_phantom</span>


<span class="n">Nphan</span> <span class="p">=</span> <span class="mi">3</span><span class="p">;</span>
<span class="c">% phantom parameters</span>
<span class="n">xc</span> <span class="p">=</span> <span class="p">[</span><span class="o">-</span><span class="p">.</span><span class="mi">3</span> <span class="mi">0</span> <span class="p">.</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="mi">256</span><span class="p">;</span>  <span class="c">% x centers</span>
<span class="n">yc</span> <span class="p">=</span> <span class="p">[</span><span class="o">-</span><span class="p">.</span><span class="mi">25</span> <span class="p">.</span><span class="mi">25</span> <span class="o">-</span><span class="p">.</span><span class="mi">25</span><span class="p">]</span><span class="o">*</span><span class="mi">256</span><span class="p">;</span>  <span class="c">% y centers</span>
<span class="n">M0</span> <span class="p">=</span> <span class="p">[</span><span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span><span class="p">];</span> <span class="c">% relative proton densities</span>
<span class="n">T1</span> <span class="p">=</span> <span class="p">[.</span><span class="mi">3</span> <span class="p">.</span><span class="mi">8</span> <span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="mf">1e3</span><span class="p">;</span>  <span class="c">% T1 relaxation times (ms)</span>
<span class="n">T2</span> <span class="p">=</span> <span class="p">[.</span><span class="mi">06</span> <span class="p">.</span><span class="mi">06</span> <span class="p">.</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="mf">1e3</span><span class="p">;</span>  <span class="c">% T2 relaxation times (ms)</span>
<span class="n">r</span> <span class="p">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">64</span><span class="p">;</span>  <span class="c">% ball radius, where FOV = 1</span>

<span class="n">flip</span> <span class="p">=</span> <span class="mi">90</span><span class="o">*</span><span class="nb">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">;</span>
<span class="n">TEs</span> <span class="p">=</span> <span class="p">[</span><span class="mi">20</span> <span class="mi">160</span><span class="p">];</span> <span class="n">TRs</span> <span class="p">=</span> <span class="p">[</span><span class="mi">400</span> <span class="mi">3000</span><span class="p">];</span>

<span class="n">N</span> <span class="p">=</span> <span class="mi">256</span><span class="p">;</span>

<span class="c">% matrices with kx, ky coordinates</span>
<span class="p">[</span><span class="n">kx</span> <span class="n">ky</span><span class="p">]</span> <span class="p">=</span> <span class="nb">meshgrid</span><span class="p">([</span><span class="o">-</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">:</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">N</span><span class="p">);</span>

<span class="k">for</span> <span class="n">TE</span> <span class="p">=</span> <span class="n">TEs</span>
    <span class="k">for</span> <span class="n">TR</span> <span class="p">=</span> <span class="n">TRs</span>

<span class="c">% initialize k-space data matrix</span>
<span class="n">M</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">);</span>

<span class="c">% Generate k-space data by adding together k-space data for each</span>
<span class="c">% individual phantom</span>

<span class="k">for</span> <span class="n">n</span><span class="p">=</span> <span class="mi">1</span><span class="p">:</span><span class="n">Nphan</span>
    <span class="c">% Generates data using Fourier Transform of a circle (jinc) multiplied by complex exponential to shift center location</span>
    <span class="n">M</span> <span class="p">=</span> <span class="n">M</span><span class="o">+</span><span class="n">jinc</span><span class="p">(</span><span class="nb">sqrt</span><span class="p">(</span><span class="n">kx</span><span class="o">.^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">ky</span><span class="o">.^</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="p">)</span> <span class="o">.*</span> <span class="nb">exp</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="o">*</span> <span class="p">(</span><span class="n">kx</span><span class="o">*</span><span class="n">xc</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">+</span> <span class="n">ky</span><span class="o">*</span><span class="n">yc</span><span class="p">(</span><span class="n">n</span><span class="p">)))</span> <span class="o">*</span> <span class="p">...</span>
        <span class="n">MRsignal_spoiled_gradient_echo</span><span class="p">(</span><span class="n">flip</span><span class="p">,</span> <span class="n">TE</span><span class="p">,</span> <span class="n">TR</span><span class="p">,</span> <span class="n">M0</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="n">T1</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="n">T2</span><span class="p">(</span><span class="n">n</span><span class="p">));</span>


<span class="k">end</span>

<span class="c">% reconstruct and display ideal image</span>
<span class="n">m</span> <span class="p">=</span> <span class="n">ifft2c</span><span class="p">(</span><span class="n">M</span><span class="p">);</span>
<span class="nb">figure</span>
<span class="nb">imagesc</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">m</span><span class="p">)),</span> <span class="nb">colormap</span><span class="p">(</span><span class="nb">gray</span><span class="p">),</span> <span class="nb">axis</span> <span class="n">equal</span> <span class="n">tight</span>
<span class="nb">title</span><span class="p">([</span><span class="s">&#39;TE = &#39;</span> <span class="n">int2str</span><span class="p">(</span><span class="n">TE</span><span class="p">)</span> <span class="s">&#39;, TR = &#39;</span> <span class="n">int2str</span><span class="p">(</span><span class="n">TR</span><span class="p">)])</span>

<span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/0f3151f9be632d4fc9b5543236d0f0678bcb36ed60eba2d8ff0927b1d5b09e32.png" src="_images/0f3151f9be632d4fc9b5543236d0f0678bcb36ed60eba2d8ff0927b1d5b09e32.png" />
<img alt="_images/7b59b209dae5149737f95158b66c453f013240a5dc89fde70b8ff5a015bed45f.png" src="_images/7b59b209dae5149737f95158b66c453f013240a5dc89fde70b8ff5a015bed45f.png" />
<img alt="_images/5d9ad4aced7093eea3fae0966553ca8db2a3e0ec8f797efceb548707e64dc7a2.png" src="_images/5d9ad4aced7093eea3fae0966553ca8db2a3e0ec8f797efceb548707e64dc7a2.png" />
<img alt="_images/03b97f10f51c0541981866f210657bdf0512e1458495d474287dff422cf2540f.png" src="_images/03b97f10f51c0541981866f210657bdf0512e1458495d474287dff422cf2540f.png" />
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "octave"
        },
        kernelOptions: {
            name: "octave",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'octave'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Gradient%20and%20Spin%20Echoes.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Gradient and Spin Echo Pulse Sequences</p>
      </div>
    </a>
    <a class="right-next"
       href="Spatial%20Encoding.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Spatial Encoding</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-goals">Learning Goals</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-determines-t1-and-t2-values">What determines T1 and T2 values?</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#t1">T1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#t2">T2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">T2*</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#typical-t1-and-t2-values">Typical T1 and T2 values</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#t">1.5 T</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">3 T</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#te-and-t2-t2">TE and T2/T2*</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tr-and-t1">TR and T1</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#degree-flip-angles">90-degree flip angles</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">&lt; 90-degree flip angles</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#t1-t2-and-proton-density-weighting">T1, T2 and Proton Density Weighting</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#t2-weighting-and-t2-weighting">T2-weighting and T2*-weighting</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#t1-weighting">T1-weighting</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pd-weighting">PD-weighting</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inversion-recovery">Inversion Recovery</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#contrast-agents">Contrast Agents</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fat-water-imaging">Fat/Water Imaging</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#image-contrast-examples">Image Contrast Examples</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simple-contrast-phantom">Simple Contrast Phantom</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#challenge-yourself">Challenge Yourself!</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Peder Larson
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  Citation - DOI <a href="https://doi.org/10.5281/zenodo.5547020">10.5281/zenodo.5547020</a>
</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>