

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>MRI Contrast &#8212; Principles of MRI</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=UA-51903906-1"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'UA-51903906-1');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'MRI Contrast';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Building Up the MRI Signal Equation" href="MRI%20Signal%20Equation.html" />
    <link rel="prev" title="Magnetic fields in MRI" href="Magnetic%20Fields%20and%20RF%20Coils.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="Introduction.html">
  
  
  
  
    
    
      
    
    
    <img src="_static/HPBrain-Anime.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="_static/HPBrain-Anime.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="Introduction.html">
                    Introduction to Principles of MRI
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">MR Physics</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Spin%20Physics.html">Spin Physics</a></li>
<li class="toctree-l1"><a class="reference internal" href="MRI%20System.html">The MRI System</a></li>
<li class="toctree-l1"><a class="reference internal" href="MR%20Physics%20-%20Bloch%20Equation.html">Bloch Equation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Magnetic%20Fields%20and%20RF%20Coils.html">Magnetic fields in MRI</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">MRI Contrast</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Image Formation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="MRI%20Signal%20Equation.html">Building Up the MRI Signal Equation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Spatial%20Encoding.html">Spatial Encoding</a></li>
<li class="toctree-l1"><a class="reference internal" href="Image%20Reconstruction.html">Image Reconstruction (In Progress Page)</a></li>
<li class="toctree-l1"><a class="reference internal" href="Signal%20to%20Noise%20Ratio.html">Signal to Noise Ratio (SNR)</a></li>

<li class="toctree-l1"><a class="reference internal" href="Artifacts.html">Artifacts</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">RF Pulses</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="RF%20Pulses.html">RF Pulses</a></li>
<li class="toctree-l1"><a class="reference internal" href="Spectral-Spatial%20RF%20Pulses.html">Spectral-Spatial RF Pulses</a></li>
<li class="toctree-l1"><a class="reference internal" href="Fun%20with%20RF%20Pulses.html">Fun? RF Pulses?</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Reference Material</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="MRI%20Notation.html">MRI Notation</a></li>
<li class="toctree-l1"><a class="reference internal" href="MRI%20Math%20Concepts.html">MRI Math Concepts</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/larsonlab/MRI-education-resources" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/larsonlab/MRI-education-resources/issues/new?title=Issue%20on%20page%20%2FMRI Contrast.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/MRI Contrast.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>MRI Contrast</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">MRI Contrast</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#te-and-t2-t2">TE and T2/T2*</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tr-and-t1">TR and T1</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#degree-flip-angles">90-degree flip angles</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">&lt; 90-degree flip angles</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#proton-density-weighting-with-short-tr-and-small-flip-angles">Proton Density Weighting with short TR and small flip angles</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inversion-recovery">Inversion Recovery</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simple-contrast-phantom">Simple Contrast Phantom</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#challenge-yourself">Challenge Yourself!</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#contrast-agents">Contrast Agents</a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="mri-contrast">
<h1>MRI Contrast<a class="headerlink" href="#mri-contrast" title="Permalink to this heading">#</a></h1>
<p>MRI contrast is a rich dimension of information.  The following examples illustrate how MR contrast can vary in common pulse sequences.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-octave notranslate"><div class="highlight"><pre><span></span><span class="c">% setup MRI-education-resources path and requirements</span>
<span class="n">cd</span> <span class="p">.</span><span class="o">./</span>
<span class="n">startup</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>warning: using the gnuplot graphics toolkit is discouraged

The gnuplot graphics toolkit is not actively maintained and has a number
of limitations that are ulikely to be fixed.  Communication with gnuplot
uses a one-directional pipe and limited information is passed back to the
Octave interpreter so most changes made interactively in the plot window
will not be reflected in the graphics properties managed by Octave.  For
example, if the plot window is closed with a mouse click, Octave will not
be notified and will not update it&#39;s internal list of open figure windows.
We recommend using the qt toolkit instead.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>loading image
loading signal
</pre></div>
</div>
</div>
</div>
<section id="te-and-t2-t2">
<h2>TE and T2/T2*<a class="headerlink" href="#te-and-t2-t2" title="Permalink to this heading">#</a></h2>
<p>The transverse magnetization decays with <span class="math notranslate nohighlight">\(T_2\)</span> (spin-echoes) or <span class="math notranslate nohighlight">\(T_2^*\)</span> (gradient-echoes) once it is flipped by an RF pulse away from the z-axis.  Therefore, the <span class="math notranslate nohighlight">\(T_2/T_2^*\)</span> contrast can be controlled by choosing the echo time (TE), which is the time between the center of the RF excitation pulse and the center of the data acquisition (when the center of k-space is acquired).  The signal is then proportional to</p>
<div class="math notranslate nohighlight">
\[S_{GE} \propto M_0 \exp(-TE/T_2^*)\]</div>
<div class="math notranslate nohighlight">
\[S_{SE} \propto M_0 \exp(-TE/T_2)\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-octave notranslate"><div class="highlight"><pre><span></span><span class="c">% TE contrast</span>

<span class="n">TE</span> <span class="p">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">200</span><span class="p">);</span> <span class="c">% ms</span>
<span class="n">T2v</span> <span class="p">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">;</span><span class="mi">10</span><span class="p">;</span><span class="mi">20</span><span class="p">;</span><span class="mi">80</span><span class="p">;</span><span class="mi">160</span><span class="p">];</span>
<span class="p">[</span><span class="n">T2</span> <span class="n">TE</span><span class="p">]</span> <span class="p">=</span> <span class="nb">meshgrid</span><span class="p">(</span><span class="n">T2v</span><span class="p">,</span><span class="n">TE</span><span class="p">);</span>
<span class="n">M0</span> <span class="p">=</span> <span class="nb">ones</span><span class="p">(</span><span class="nb">size</span><span class="p">(</span><span class="n">T2</span><span class="p">));</span>

<span class="n">S_TE</span> <span class="p">=</span> <span class="n">M0</span><span class="o">.*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">TE</span><span class="o">./</span><span class="n">T2</span><span class="p">);</span>

<span class="nb">plot</span><span class="p">(</span><span class="n">TE</span><span class="p">,</span><span class="n">S_TE</span><span class="p">)</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;TE (ms)&#39;</span><span class="p">),</span> <span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;signal&#39;</span><span class="p">)</span>
<span class="nb">legend</span><span class="p">(</span><span class="n">int2str</span><span class="p">(</span><span class="n">T2v</span><span class="p">))</span>
<span class="nb">title</span><span class="p">(</span><span class="s">&#39;Signal versus TE for various T_2 values&#39;</span><span class="p">)</span>

<span class="n">TE</span> <span class="p">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">200</span><span class="p">);</span> <span class="c">% ms</span>
<span class="n">T2</span> <span class="p">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">150</span><span class="p">);</span> <span class="c">% ms</span>
<span class="p">[</span><span class="n">T2</span> <span class="n">TE</span><span class="p">]</span> <span class="p">=</span> <span class="nb">meshgrid</span><span class="p">(</span><span class="n">T2</span><span class="p">,</span><span class="n">TE</span><span class="p">);</span>
<span class="n">M0</span> <span class="p">=</span> <span class="nb">ones</span><span class="p">(</span><span class="nb">size</span><span class="p">(</span><span class="n">T2</span><span class="p">));</span>

<span class="n">S_TE</span> <span class="p">=</span> <span class="n">M0</span> <span class="o">.*</span> <span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">TE</span><span class="o">./</span><span class="n">T2</span><span class="p">);</span>

<span class="nb">figure</span>

<span class="nb">mesh</span><span class="p">(</span><span class="n">T2</span><span class="p">,</span><span class="n">TE</span><span class="p">,</span><span class="n">S_TE</span><span class="p">)</span>
<span class="nb">view</span><span class="p">([</span><span class="mi">155</span> <span class="mi">30</span><span class="p">])</span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;TE (ms)&#39;</span><span class="p">),</span> <span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;T_2 (ms)&#39;</span><span class="p">),</span> <span class="nb">zlabel</span><span class="p">(</span><span class="s">&#39;signal&#39;</span><span class="p">)</span>
<span class="nb">colorbar</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ans = -11.629
</pre></div>
</div>
<img alt="_images/c95216a32454bfa2cefc8b28bb8c6964fb917884bb491464c4199f588517606c.png" src="_images/c95216a32454bfa2cefc8b28bb8c6964fb917884bb491464c4199f588517606c.png" />
<img alt="_images/247df58244358475d479d39e9f2cb8b0249e7dd85fb7ae4373383ba9a000cc0d.png" src="_images/247df58244358475d479d39e9f2cb8b0249e7dd85fb7ae4373383ba9a000cc0d.png" />
</div>
</div>
</section>
<section id="tr-and-t1">
<h2>TR and T1<a class="headerlink" href="#tr-and-t1" title="Permalink to this heading">#</a></h2>
<p>The longitudinal magnetization recovers with <span class="math notranslate nohighlight">\(T_1\)</span> back to its equilibrium amplitude, <span class="math notranslate nohighlight">\(M_0\)</span>.  However, we do not directly measure the longitudinal magnetization.  In order to create <span class="math notranslate nohighlight">\(T_1\)</span> contrast in the MR signal, repeated RF pulses are applied with a given repetition time (TR), such that there is incomplete recovery of the longitudinal magnetization.  Then, after excitation, incomplete recovery appears in the transverse magnetization, creating <span class="math notranslate nohighlight">\(T_1\)</span> contrast.</p>
<section id="degree-flip-angles">
<h3>90-degree flip angles<a class="headerlink" href="#degree-flip-angles" title="Permalink to this heading">#</a></h3>
<p>The simplest case is using 90-degree flip angles every TR, in which case</p>
<div class="math notranslate nohighlight">
\[S \propto M_0 (1- \exp(-TR/T_1) )\]</div>
<p>Illustrated in the first example below.  This shows that the magnetization reaches steady state in the 2nd TR.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-octave notranslate"><div class="highlight"><pre><span></span><span class="c">% Signal evolution between TRs with 90-degree pulses</span>

<span class="n">M0</span> <span class="p">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">;</span><span class="mi">1</span><span class="p">;</span><span class="mi">1</span><span class="p">;</span><span class="mi">1</span><span class="p">];</span> 

<span class="n">T1</span> <span class="p">=</span> <span class="p">[</span><span class="mi">400</span><span class="p">;</span> <span class="mi">800</span><span class="p">;</span> <span class="mi">1200</span><span class="p">;</span> <span class="mi">2000</span><span class="p">];</span> <span class="c">%linspace(200,2000)&#39;; % ms</span>

<span class="n">NTR</span> <span class="p">=</span> <span class="mi">8</span><span class="p">;</span>
<span class="n">flip</span> <span class="p">=</span> <span class="mi">90</span><span class="p">;</span>
<span class="n">TR</span> <span class="p">=</span> <span class="mi">500</span><span class="p">;</span> <span class="c">%ms</span>
<span class="n">Nt_per_TR</span> <span class="p">=</span> <span class="mi">100</span><span class="p">;</span>
<span class="n">t_per_TR</span> <span class="p">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">Nt_per_TR</span><span class="p">]</span><span class="o">*</span><span class="n">TR</span><span class="o">/</span><span class="n">Nt_per_TR</span><span class="p">;</span>
<span class="n">t_minus</span> <span class="p">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">NTR</span><span class="p">]</span><span class="o">*</span><span class="n">TR</span><span class="p">;</span> <span class="n">t_plus</span> <span class="p">=</span> <span class="n">t_minus</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>

<span class="c">% magnetization before each RF pulse</span>
<span class="n">Mz_minus</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="nb">length</span><span class="p">(</span><span class="n">T1</span><span class="p">),</span> <span class="n">NTR</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
<span class="c">% magnetization after each RF pulse</span>
<span class="n">Mz_plus</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="nb">length</span><span class="p">(</span><span class="n">T1</span><span class="p">),</span> <span class="n">NTR</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>

<span class="c">% initial condition</span>
<span class="n">Mz_minus</span><span class="p">(:,</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="n">M0</span><span class="p">;</span>
<span class="n">Mz_plus</span><span class="p">(:,</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="n">Mz_minus</span><span class="p">(:,</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="nb">cos</span><span class="p">(</span><span class="n">flip</span><span class="o">*</span><span class="nb">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">);</span>
<span class="n">t</span> <span class="p">=</span> <span class="p">[</span><span class="mi">0</span> <span class="nb">eps</span><span class="p">];</span>
<span class="n">Mz_all</span> <span class="p">=</span> <span class="p">[</span><span class="n">Mz_minus</span><span class="p">(:,</span><span class="mi">1</span><span class="p">),</span><span class="n">Mz_plus</span><span class="p">(:,</span><span class="mi">1</span><span class="p">)];</span>


<span class="k">for</span> <span class="no">I</span> <span class="p">=</span> <span class="mi">1</span><span class="p">:</span><span class="n">NTR</span>
    <span class="n">t</span> <span class="p">=</span> <span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="n">t_per_TR</span> <span class="o">+</span> <span class="p">(</span><span class="no">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">TR</span><span class="p">];</span>

    <span class="k">for</span> <span class="n">It</span> <span class="p">=</span> <span class="mi">1</span><span class="p">:</span><span class="n">Nt_per_TR</span>
        <span class="n">Mz_all</span> <span class="p">=</span> <span class="p">[</span><span class="n">Mz_all</span><span class="p">,</span> <span class="n">Mz_plus</span><span class="p">(:,</span><span class="no">I</span><span class="p">)</span><span class="o">.*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t_per_TR</span><span class="p">(</span><span class="n">It</span><span class="p">)</span><span class="o">./</span><span class="n">T1</span><span class="p">)</span> <span class="o">+</span> <span class="n">M0</span><span class="o">.*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t_per_TR</span><span class="p">(</span><span class="n">It</span><span class="p">)</span><span class="o">./</span><span class="n">T1</span><span class="p">))];</span>
    <span class="k">end</span>
    
    <span class="n">Mz_minus</span><span class="p">(:,</span><span class="no">I</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="n">Mz_plus</span><span class="p">(:,</span><span class="no">I</span><span class="p">)</span><span class="o">.*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">TR</span><span class="o">./</span><span class="n">T1</span><span class="p">)</span> <span class="o">+</span> <span class="n">M0</span><span class="o">.*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">TR</span><span class="o">./</span><span class="n">T1</span><span class="p">));</span>
    <span class="n">Mz_plus</span><span class="p">(:,</span><span class="no">I</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="n">Mz_minus</span><span class="p">(:,</span><span class="no">I</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">.*</span><span class="nb">cos</span><span class="p">(</span><span class="n">flip</span><span class="o">*</span><span class="nb">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">);</span>


<span class="k">end</span>

<span class="nb">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Mz_all</span><span class="p">,</span> <span class="n">t_minus</span><span class="p">,</span> <span class="n">Mz_minus</span><span class="p">,</span> <span class="s">&#39;x&#39;</span><span class="p">,</span> <span class="n">t_plus</span><span class="p">,</span> <span class="n">Mz_plus</span><span class="p">,</span><span class="s">&#39;o&#39;</span><span class="p">)</span>
<span class="nb">legend</span><span class="p">(</span><span class="n">int2str</span><span class="p">(</span><span class="n">T1</span><span class="p">))</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;time (ms)&#39;</span><span class="p">),</span> <span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;M_Z&#39;</span><span class="p">)</span>
<span class="nb">title</span><span class="p">([</span><span class="n">num2str</span><span class="p">(</span><span class="n">flip</span><span class="p">)</span> <span class="s">&#39;-degree RF pulses applied every &#39;</span> <span class="n">num2str</span><span class="p">(</span><span class="n">TR</span><span class="p">)</span> <span class="s">&#39; ms&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ans = -22.971
</pre></div>
</div>
<img alt="_images/9dd2e30d18dc7efd209b3a2a27a39b2729dac1c10f9eb9fff9b4fce586301224.png" src="_images/9dd2e30d18dc7efd209b3a2a27a39b2729dac1c10f9eb9fff9b4fce586301224.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-octave notranslate"><div class="highlight"><pre><span></span><span class="c">% TR contrast with T1</span>

<span class="n">TR</span> <span class="p">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2000</span><span class="p">);</span> <span class="c">% ms</span>
<span class="n">T1v</span> <span class="p">=</span> <span class="p">[</span><span class="mi">400</span><span class="p">;</span> <span class="mi">800</span><span class="p">;</span> <span class="mi">1200</span><span class="p">;</span> <span class="mi">2000</span><span class="p">];</span> <span class="c">%linspace(200,2000)&#39;; % ms</span>
<span class="p">[</span><span class="n">T1</span> <span class="n">TR</span><span class="p">]</span> <span class="p">=</span> <span class="nb">meshgrid</span><span class="p">(</span><span class="n">T1v</span><span class="p">,</span><span class="n">TR</span><span class="p">);</span>
<span class="n">M0</span> <span class="p">=</span> <span class="nb">ones</span><span class="p">(</span><span class="nb">size</span><span class="p">(</span><span class="n">T1</span><span class="p">));</span>

<span class="n">S_TR</span> <span class="p">=</span> <span class="n">M0</span><span class="o">.*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">TR</span><span class="o">./</span><span class="n">T1</span><span class="p">));</span>

<span class="nb">plot</span><span class="p">(</span><span class="n">TR</span><span class="p">,</span><span class="n">S_TR</span><span class="p">)</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;TR (ms)&#39;</span><span class="p">),</span> <span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;signal&#39;</span><span class="p">)</span>
<span class="nb">legend</span><span class="p">(</span><span class="n">int2str</span><span class="p">(</span><span class="n">T1v</span><span class="p">))</span>
<span class="nb">title</span><span class="p">([</span><span class="s">&#39;Signal versus TR for various T_1 values with &#39;</span> <span class="n">num2str</span><span class="p">(</span><span class="n">flip</span><span class="p">)</span> <span class="s">&#39;-degree flip&#39;</span><span class="p">])</span>

<span class="n">TR</span> <span class="p">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2000</span><span class="p">);</span> <span class="c">% ms</span>
<span class="n">T1</span> <span class="p">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span><span class="mi">2500</span><span class="p">);</span> <span class="c">% ms</span>
<span class="p">[</span><span class="n">T1</span> <span class="n">TR</span><span class="p">]</span> <span class="p">=</span> <span class="nb">meshgrid</span><span class="p">(</span><span class="n">T1</span><span class="p">,</span><span class="n">TR</span><span class="p">);</span>
<span class="n">M0</span> <span class="p">=</span> <span class="nb">ones</span><span class="p">(</span><span class="nb">size</span><span class="p">(</span><span class="n">T1</span><span class="p">));</span>

<span class="n">S_TR</span> <span class="p">=</span> <span class="n">M0</span> <span class="o">.*</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">TR</span><span class="o">./</span><span class="n">T1</span><span class="p">));</span>

<span class="nb">figure</span>

<span class="nb">mesh</span><span class="p">(</span><span class="n">T1</span><span class="p">,</span><span class="n">TR</span><span class="p">,</span><span class="n">S_TR</span><span class="p">)</span>
<span class="nb">view</span><span class="p">([</span><span class="mi">110</span> <span class="mi">30</span><span class="p">])</span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;TR (ms)&#39;</span><span class="p">),</span> <span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;T_1 (ms)&#39;</span><span class="p">),</span> <span class="nb">zlabel</span><span class="p">(</span><span class="s">&#39;signal&#39;</span><span class="p">)</span>
<span class="nb">colorbar</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ans = -30.881
</pre></div>
</div>
<img alt="_images/75fc1ea0d75c3717052a3627523d60c05acc9f9af07c8b58167e7f4c4abef80b.png" src="_images/75fc1ea0d75c3717052a3627523d60c05acc9f9af07c8b58167e7f4c4abef80b.png" />
<img alt="_images/94a477658404efdaa650c6427fea10b0be585b10a96c200554e7d8a5d21c6b25.png" src="_images/94a477658404efdaa650c6427fea10b0be585b10a96c200554e7d8a5d21c6b25.png" />
</div>
</div>
</section>
<section id="id1">
<h3>&lt; 90-degree flip angles<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h3>
<p>For T1-weighting, it is generally more efficient in terms of signal acqruied per time to use &lt; 90-degree flip angles every TR, in which case</p>
<div class="math notranslate nohighlight">
\[S \propto M_0 \sin(\theta) \frac{1- \exp(-TR/T_1)}{1- \cos(\theta) \exp(-TR/T_1)}\]</div>
<p>Illustrated in this second example below.  This shows that the magnetization can take many TRs to reach steady state.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-octave notranslate"><div class="highlight"><pre><span></span><span class="c">% Signal evolution between TRs with &lt;90-degree pulses</span>

<span class="n">M0</span> <span class="p">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">;</span><span class="mi">1</span><span class="p">;</span><span class="mi">1</span><span class="p">;</span><span class="mi">1</span><span class="p">];</span> 
<span class="n">T1</span> <span class="p">=</span> <span class="p">[</span><span class="mi">400</span><span class="p">;</span> <span class="mi">800</span><span class="p">;</span> <span class="mi">1200</span><span class="p">;</span> <span class="mi">2000</span><span class="p">];</span> <span class="c">%linspace(200,2000)&#39;; % ms</span>

<span class="n">NTR</span> <span class="p">=</span> <span class="mi">30</span><span class="p">;</span>
<span class="n">flip</span> <span class="p">=</span> <span class="mi">30</span><span class="p">;</span>
<span class="n">TR</span> <span class="p">=</span> <span class="mi">100</span><span class="p">;</span> <span class="c">%ms</span>
<span class="n">Nt_per_TR</span> <span class="p">=</span> <span class="mi">100</span><span class="p">;</span>
<span class="n">t_per_TR</span> <span class="p">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">Nt_per_TR</span><span class="p">]</span><span class="o">*</span><span class="n">TR</span><span class="o">/</span><span class="n">Nt_per_TR</span><span class="p">;</span>
<span class="n">t_minus</span> <span class="p">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">NTR</span><span class="p">]</span><span class="o">*</span><span class="n">TR</span><span class="p">;</span> <span class="n">t_plus</span> <span class="p">=</span> <span class="n">t_minus</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>

<span class="c">% magnetization before each RF pulse</span>
<span class="n">Mz_minus</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="nb">length</span><span class="p">(</span><span class="n">T1</span><span class="p">),</span> <span class="n">NTR</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
<span class="c">% magnetization after each RF pulse</span>
<span class="n">Mz_plus</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="nb">length</span><span class="p">(</span><span class="n">T1</span><span class="p">),</span> <span class="n">NTR</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>

<span class="c">% initial condition</span>
<span class="n">Mz_minus</span><span class="p">(:,</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="n">M0</span><span class="p">;</span>
<span class="n">Mz_plus</span><span class="p">(:,</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="n">Mz_minus</span><span class="p">(:,</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="nb">cos</span><span class="p">(</span><span class="n">flip</span><span class="o">*</span><span class="nb">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">);</span>
<span class="n">t</span> <span class="p">=</span> <span class="p">[</span><span class="mi">0</span> <span class="nb">eps</span><span class="p">];</span>
<span class="n">Mz_all</span> <span class="p">=</span> <span class="p">[</span><span class="n">Mz_minus</span><span class="p">(:,</span><span class="mi">1</span><span class="p">),</span><span class="n">Mz_plus</span><span class="p">(:,</span><span class="mi">1</span><span class="p">)];</span>


<span class="k">for</span> <span class="no">I</span> <span class="p">=</span> <span class="mi">1</span><span class="p">:</span><span class="n">NTR</span>
    <span class="n">t</span> <span class="p">=</span> <span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="n">t_per_TR</span> <span class="o">+</span> <span class="p">(</span><span class="no">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">TR</span><span class="p">];</span>

    <span class="k">for</span> <span class="n">It</span> <span class="p">=</span> <span class="mi">1</span><span class="p">:</span><span class="n">Nt_per_TR</span>
        <span class="n">Mz_all</span> <span class="p">=</span> <span class="p">[</span><span class="n">Mz_all</span><span class="p">,</span> <span class="n">Mz_plus</span><span class="p">(:,</span><span class="no">I</span><span class="p">)</span><span class="o">.*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t_per_TR</span><span class="p">(</span><span class="n">It</span><span class="p">)</span><span class="o">./</span><span class="n">T1</span><span class="p">)</span> <span class="o">+</span> <span class="n">M0</span><span class="o">.*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t_per_TR</span><span class="p">(</span><span class="n">It</span><span class="p">)</span><span class="o">./</span><span class="n">T1</span><span class="p">))];</span>
    <span class="k">end</span>
    
    <span class="n">Mz_minus</span><span class="p">(:,</span><span class="no">I</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="n">Mz_plus</span><span class="p">(:,</span><span class="no">I</span><span class="p">)</span><span class="o">.*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">TR</span><span class="o">./</span><span class="n">T1</span><span class="p">)</span> <span class="o">+</span> <span class="n">M0</span><span class="o">.*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">TR</span><span class="o">./</span><span class="n">T1</span><span class="p">));</span>
    <span class="n">Mz_plus</span><span class="p">(:,</span><span class="no">I</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="n">Mz_minus</span><span class="p">(:,</span><span class="no">I</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">.*</span><span class="nb">cos</span><span class="p">(</span><span class="n">flip</span><span class="o">*</span><span class="nb">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">);</span>


<span class="k">end</span>

<span class="nb">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Mz_all</span><span class="p">,</span> <span class="n">t_minus</span><span class="p">,</span> <span class="n">Mz_minus</span><span class="p">,</span> <span class="s">&#39;x&#39;</span><span class="p">,</span> <span class="n">t_plus</span><span class="p">,</span> <span class="n">Mz_plus</span><span class="p">,</span><span class="s">&#39;o&#39;</span><span class="p">)</span>
<span class="nb">legend</span><span class="p">(</span><span class="n">int2str</span><span class="p">(</span><span class="n">T1</span><span class="p">))</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;time (ms)&#39;</span><span class="p">),</span> <span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;M_Z&#39;</span><span class="p">)</span>
<span class="nb">title</span><span class="p">([</span><span class="n">num2str</span><span class="p">(</span><span class="n">flip</span><span class="p">)</span> <span class="s">&#39;-degree RF pulses applied every &#39;</span> <span class="n">num2str</span><span class="p">(</span><span class="n">TR</span><span class="p">)</span> <span class="s">&#39; ms&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ans = -22.584
</pre></div>
</div>
<img alt="_images/0f9925dcb4ce33f3a6f2655d56748c7de0a6be989a0eede794cce970698076e3.png" src="_images/0f9925dcb4ce33f3a6f2655d56748c7de0a6be989a0eede794cce970698076e3.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-octave notranslate"><div class="highlight"><pre><span></span><span class="c">% TR and flip angle contrast with T1</span>

<span class="n">flip</span> <span class="p">=</span> <span class="mi">30</span><span class="p">;</span> <span class="c">% degrees</span>
<span class="n">TR</span> <span class="p">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2000</span><span class="p">);</span> <span class="c">% ms</span>
<span class="n">T1v</span> <span class="p">=</span> <span class="p">[</span><span class="mi">400</span><span class="p">;</span> <span class="mi">800</span><span class="p">;</span> <span class="mi">1200</span><span class="p">;</span> <span class="mi">2000</span><span class="p">];</span> <span class="c">%linspace(200,2000)&#39;; % ms</span>
<span class="p">[</span><span class="n">T1</span> <span class="n">TR</span><span class="p">]</span> <span class="p">=</span> <span class="nb">meshgrid</span><span class="p">(</span><span class="n">T1v</span><span class="p">,</span><span class="n">TR</span><span class="p">);</span>
<span class="n">M0</span> <span class="p">=</span> <span class="nb">ones</span><span class="p">(</span><span class="nb">size</span><span class="p">(</span><span class="n">T1</span><span class="p">));</span>

<span class="n">S_TR</span> <span class="p">=</span> <span class="nb">sin</span><span class="p">(</span><span class="n">flip</span><span class="o">*</span><span class="nb">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span> <span class="o">.*</span> <span class="n">M0</span> <span class="o">.*</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">TR</span><span class="o">./</span><span class="n">T1</span><span class="p">))</span> <span class="o">./</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="nb">cos</span><span class="p">(</span><span class="n">flip</span><span class="o">*</span><span class="nb">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span><span class="o">.*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">TR</span><span class="o">./</span><span class="n">T1</span><span class="p">));</span>

<span class="nb">plot</span><span class="p">(</span><span class="n">TR</span><span class="p">,</span><span class="n">S_TR</span><span class="p">)</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;TR (ms)&#39;</span><span class="p">),</span> <span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;signal&#39;</span><span class="p">)</span>
<span class="nb">legend</span><span class="p">(</span><span class="n">int2str</span><span class="p">(</span><span class="n">T1v</span><span class="p">))</span>
<span class="nb">title</span><span class="p">([</span><span class="s">&#39;Signal versus TR for various T_1 values with &#39;</span> <span class="n">num2str</span><span class="p">(</span><span class="n">flip</span><span class="p">)</span> <span class="s">&#39;-degree flip&#39;</span><span class="p">])</span>

<span class="n">TR</span> <span class="p">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2000</span><span class="p">);</span> <span class="c">% ms</span>
<span class="n">T1</span> <span class="p">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span><span class="mi">2500</span><span class="p">);</span> <span class="c">% ms</span>
<span class="p">[</span><span class="n">T1</span> <span class="n">TR</span><span class="p">]</span> <span class="p">=</span> <span class="nb">meshgrid</span><span class="p">(</span><span class="n">T1</span><span class="p">,</span><span class="n">TR</span><span class="p">);</span>
<span class="n">M0</span> <span class="p">=</span> <span class="nb">ones</span><span class="p">(</span><span class="nb">size</span><span class="p">(</span><span class="n">T1</span><span class="p">));</span>

<span class="n">S_TR</span> <span class="p">=</span> <span class="nb">sin</span><span class="p">(</span><span class="n">flip</span><span class="o">*</span><span class="nb">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span> <span class="o">.*</span> <span class="n">M0</span> <span class="o">.*</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">TR</span><span class="o">./</span><span class="n">T1</span><span class="p">))</span> <span class="o">./</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="nb">cos</span><span class="p">(</span><span class="n">flip</span><span class="o">*</span><span class="nb">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span><span class="o">.*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">TR</span><span class="o">./</span><span class="n">T1</span><span class="p">));</span>

<span class="nb">figure</span>

<span class="nb">mesh</span><span class="p">(</span><span class="n">T1</span><span class="p">,</span><span class="n">TR</span><span class="p">,</span><span class="n">S_TR</span><span class="p">)</span>
<span class="nb">view</span><span class="p">([</span><span class="mi">110</span> <span class="mi">30</span><span class="p">])</span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;TR (ms)&#39;</span><span class="p">),</span> <span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;T_1 (ms)&#39;</span><span class="p">),</span> <span class="nb">zlabel</span><span class="p">(</span><span class="s">&#39;signal&#39;</span><span class="p">)</span>
<span class="nb">title</span><span class="p">([</span> <span class="n">num2str</span><span class="p">(</span><span class="n">flip</span><span class="p">)</span> <span class="s">&#39;-degree flip&#39;</span><span class="p">])</span>
<span class="nb">colorbar</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ans = -30.004
</pre></div>
</div>
<img alt="_images/cd10c13a287fdddee276fc1fad2313e52a17517b60e0f6d8d34b118ff050e8df.png" src="_images/cd10c13a287fdddee276fc1fad2313e52a17517b60e0f6d8d34b118ff050e8df.png" />
<img alt="_images/ee8e2539308adac7ce2a5ac462b512589a48b8d8ccb03ccccf41457a0d952b93.png" src="_images/ee8e2539308adac7ce2a5ac462b512589a48b8d8ccb03ccccf41457a0d952b93.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-octave notranslate"><div class="highlight"><pre><span></span><span class="n">TR</span> <span class="p">=</span> <span class="mi">100</span><span class="p">;</span>
<span class="n">flip</span> <span class="p">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">90</span><span class="p">);</span> <span class="c">% degrees</span>
<span class="n">T1v</span> <span class="p">=</span> <span class="p">[</span><span class="mi">400</span><span class="p">;</span> <span class="mi">800</span><span class="p">;</span> <span class="mi">1200</span><span class="p">;</span> <span class="mi">2000</span><span class="p">];</span> <span class="c">%linspace(200,2000)&#39;; % ms</span>
<span class="p">[</span><span class="n">T1</span> <span class="n">flip</span><span class="p">]</span> <span class="p">=</span> <span class="nb">meshgrid</span><span class="p">(</span><span class="n">T1v</span><span class="p">,</span><span class="n">flip</span><span class="p">);</span>
<span class="n">M0</span> <span class="p">=</span> <span class="nb">ones</span><span class="p">(</span><span class="nb">size</span><span class="p">(</span><span class="n">T1</span><span class="p">));</span>

<span class="n">S_flip</span> <span class="p">=</span> <span class="nb">sin</span><span class="p">(</span><span class="n">flip</span><span class="o">*</span><span class="nb">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span> <span class="o">.*</span> <span class="n">M0</span> <span class="o">.*</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">TR</span><span class="o">./</span><span class="n">T1</span><span class="p">))</span> <span class="o">./</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="nb">cos</span><span class="p">(</span><span class="n">flip</span><span class="o">*</span><span class="nb">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span><span class="o">.*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">TR</span><span class="o">./</span><span class="n">T1</span><span class="p">));</span>

<span class="nb">figure</span>
<span class="nb">plot</span><span class="p">(</span><span class="n">flip</span><span class="p">,</span><span class="n">S_flip</span><span class="p">)</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;flip angle (degrees)&#39;</span><span class="p">),</span> <span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;signal&#39;</span><span class="p">)</span>
<span class="nb">legend</span><span class="p">(</span><span class="n">int2str</span><span class="p">(</span><span class="n">T1v</span><span class="p">))</span>
<span class="nb">title</span><span class="p">([</span><span class="s">&#39;Signal versus flip angles for various T_1 values with TR = &#39;</span> <span class="n">num2str</span><span class="p">(</span><span class="n">TR</span><span class="p">)</span> <span class="s">&#39; ms&#39;</span><span class="p">])</span>


<span class="n">flip</span> <span class="p">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">90</span><span class="p">);</span> <span class="c">% degrees</span>
<span class="n">T1</span> <span class="p">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span><span class="mi">2500</span><span class="p">);</span> <span class="c">% ms</span>
<span class="p">[</span><span class="n">T1</span> <span class="n">flip</span><span class="p">]</span> <span class="p">=</span> <span class="nb">meshgrid</span><span class="p">(</span><span class="n">T1</span><span class="p">,</span><span class="n">flip</span><span class="p">);</span>
<span class="n">M0</span> <span class="p">=</span> <span class="nb">ones</span><span class="p">(</span><span class="nb">size</span><span class="p">(</span><span class="n">T1</span><span class="p">));</span>

<span class="n">S_flip</span> <span class="p">=</span> <span class="nb">sin</span><span class="p">(</span><span class="n">flip</span><span class="o">*</span><span class="nb">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span> <span class="o">.*</span> <span class="n">M0</span> <span class="o">.*</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">TR</span><span class="o">./</span><span class="n">T1</span><span class="p">))</span> <span class="o">./</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="nb">cos</span><span class="p">(</span><span class="n">flip</span><span class="o">*</span><span class="nb">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span><span class="o">.*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">TR</span><span class="o">./</span><span class="n">T1</span><span class="p">));</span>

<span class="nb">figure</span>

<span class="nb">mesh</span><span class="p">(</span><span class="n">T1</span><span class="p">,</span><span class="n">flip</span><span class="p">,</span><span class="n">S_flip</span><span class="p">)</span>
<span class="nb">view</span><span class="p">([</span><span class="mi">110</span> <span class="mi">30</span><span class="p">])</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;flip angle (degrees)&#39;</span><span class="p">),</span> <span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;T_1 (ms)&#39;</span><span class="p">),</span> <span class="nb">zlabel</span><span class="p">(</span><span class="s">&#39;signal&#39;</span><span class="p">)</span>
<span class="nb">title</span><span class="p">([</span><span class="s">&#39;TR = &#39;</span> <span class="n">num2str</span><span class="p">(</span><span class="n">TR</span><span class="p">)</span> <span class="s">&#39; ms&#39;</span><span class="p">])</span>
<span class="nb">colorbar</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ans = -30.830
</pre></div>
</div>
<img alt="_images/25c5bcdbc0df281bf4750d7dc3bd36bac9bdc424f918945d3a6f2e85e087db19.png" src="_images/25c5bcdbc0df281bf4750d7dc3bd36bac9bdc424f918945d3a6f2e85e087db19.png" />
<img alt="_images/c239da07aa3f30be388e0925b89aa5633f9409b7684f2f9b5ef3a14d9f85bbdb.png" src="_images/c239da07aa3f30be388e0925b89aa5633f9409b7684f2f9b5ef3a14d9f85bbdb.png" />
</div>
</div>
</section>
<section id="proton-density-weighting-with-short-tr-and-small-flip-angles">
<h3>Proton Density Weighting with short TR and small flip angles<a class="headerlink" href="#proton-density-weighting-with-short-tr-and-small-flip-angles" title="Permalink to this heading">#</a></h3>
<p>Proton-density weighting can be achieved with short TRs when using very small flip angles.  This weighting applies up to a certain <span class="math notranslate nohighlight">\(TR/T_1\)</span> ratio.  This can be seen in the following by zooming in on the low flip angle area from the plots above and noting that there is no difference between the signal for different <span class="math notranslate nohighlight">\(T_1\)</span> values, meaning the T1-weighting has been removed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-octave notranslate"><div class="highlight"><pre><span></span><span class="n">TR</span> <span class="p">=</span> <span class="mi">10</span><span class="p">;</span>
<span class="n">flip</span> <span class="p">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">);</span> <span class="c">% degrees</span>
<span class="n">T1v</span> <span class="p">=</span> <span class="p">[</span><span class="mi">400</span><span class="p">;</span> <span class="mi">800</span><span class="p">;</span> <span class="mi">1200</span><span class="p">;</span> <span class="mi">2000</span><span class="p">];</span> <span class="c">%linspace(200,2000)&#39;; % ms</span>
<span class="p">[</span><span class="n">T1</span> <span class="n">flip</span><span class="p">]</span> <span class="p">=</span> <span class="nb">meshgrid</span><span class="p">(</span><span class="n">T1v</span><span class="p">,</span><span class="n">flip</span><span class="p">);</span>
<span class="n">M0</span> <span class="p">=</span> <span class="nb">ones</span><span class="p">(</span><span class="nb">size</span><span class="p">(</span><span class="n">T1</span><span class="p">));</span>

<span class="n">S_flip</span> <span class="p">=</span> <span class="nb">sin</span><span class="p">(</span><span class="n">flip</span><span class="o">*</span><span class="nb">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span> <span class="o">.*</span> <span class="n">M0</span> <span class="o">.*</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">TR</span><span class="o">./</span><span class="n">T1</span><span class="p">))</span> <span class="o">./</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="nb">cos</span><span class="p">(</span><span class="n">flip</span><span class="o">*</span><span class="nb">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span><span class="o">.*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">TR</span><span class="o">./</span><span class="n">T1</span><span class="p">));</span>

<span class="nb">figure</span>
<span class="nb">plot</span><span class="p">(</span><span class="n">flip</span><span class="p">,</span><span class="n">S_flip</span><span class="p">)</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;flip angle (degrees)&#39;</span><span class="p">),</span> <span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;signal&#39;</span><span class="p">)</span>
<span class="nb">legend</span><span class="p">(</span><span class="n">int2str</span><span class="p">(</span><span class="n">T1v</span><span class="p">))</span>
<span class="nb">title</span><span class="p">([</span><span class="s">&#39;Signal versus flip angles for various T_1 values with TR = &#39;</span> <span class="n">num2str</span><span class="p">(</span><span class="n">TR</span><span class="p">)</span> <span class="s">&#39; ms&#39;</span><span class="p">])</span>


<span class="n">flip</span> <span class="p">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">);</span> <span class="c">% degrees</span>
<span class="n">T1</span> <span class="p">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span><span class="mi">2500</span><span class="p">);</span> <span class="c">% ms</span>
<span class="p">[</span><span class="n">T1</span> <span class="n">flip</span><span class="p">]</span> <span class="p">=</span> <span class="nb">meshgrid</span><span class="p">(</span><span class="n">T1</span><span class="p">,</span><span class="n">flip</span><span class="p">);</span>
<span class="n">M0</span> <span class="p">=</span> <span class="nb">ones</span><span class="p">(</span><span class="nb">size</span><span class="p">(</span><span class="n">T1</span><span class="p">));</span>

<span class="n">S_flip</span> <span class="p">=</span> <span class="nb">sin</span><span class="p">(</span><span class="n">flip</span><span class="o">*</span><span class="nb">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span> <span class="o">.*</span> <span class="n">M0</span> <span class="o">.*</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">TR</span><span class="o">./</span><span class="n">T1</span><span class="p">))</span> <span class="o">./</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="nb">cos</span><span class="p">(</span><span class="n">flip</span><span class="o">*</span><span class="nb">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span><span class="o">.*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">TR</span><span class="o">./</span><span class="n">T1</span><span class="p">));</span>

<span class="nb">figure</span>

<span class="nb">mesh</span><span class="p">(</span><span class="n">T1</span><span class="p">,</span><span class="n">flip</span><span class="p">,</span><span class="n">S_flip</span><span class="p">)</span>
<span class="nb">view</span><span class="p">([</span><span class="mi">110</span> <span class="mi">30</span><span class="p">])</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;flip angle (degrees)&#39;</span><span class="p">),</span> <span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;T_1 (ms)&#39;</span><span class="p">),</span> <span class="nb">zlabel</span><span class="p">(</span><span class="s">&#39;signal&#39;</span><span class="p">)</span>
<span class="nb">title</span><span class="p">([</span><span class="s">&#39;TR = &#39;</span> <span class="n">num2str</span><span class="p">(</span><span class="n">TR</span><span class="p">)</span> <span class="s">&#39; ms&#39;</span><span class="p">])</span>
<span class="nb">colorbar</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ans = -30.305
</pre></div>
</div>
<img alt="_images/5bfa2236f0f35730149e14de4e85411e96ff2ef1cd02c214d77301b1bb07067a.png" src="_images/5bfa2236f0f35730149e14de4e85411e96ff2ef1cd02c214d77301b1bb07067a.png" />
<img alt="_images/7229096af8afc5ea50256b847661be287d4e3d0305834315fcdc375cccf23dc4.png" src="_images/7229096af8afc5ea50256b847661be287d4e3d0305834315fcdc375cccf23dc4.png" />
</div>
</div>
</section>
</section>
<section id="inversion-recovery">
<h2>Inversion Recovery<a class="headerlink" href="#inversion-recovery" title="Permalink to this heading">#</a></h2>
<p>Another way to create <span class="math notranslate nohighlight">\(T_1\)</span> contrast are Inversion Recovery techniques.  These use a 180-degree inversion pulse, following by an Inversion Time <span class="math notranslate nohighlight">\(TI\)</span> delay during which <span class="math notranslate nohighlight">\(T_1\)</span> contrast is created.  Then the magnetization is excited with a 90-degree pulse.</p>
<p>This strategy is commonly used to null tissue types.  For example, so-called short-time inversion recovery (STIR) is used to null fat signals, while fluid attenuated inversion recovery (FLAIR) is used to null fluids.</p>
<div class="math notranslate nohighlight">
\[S_{IR} \propto M_0 (1 - 2\exp(-TI/T_1) + \exp(-TR/T_1) )\]</div>
<p>The illustration below shows that the magnetization reaches steady state in the 2nd TR of inversion recovery.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-octave notranslate"><div class="highlight"><pre><span></span><span class="c">% Inversion Recovery</span>

<span class="n">T1</span> <span class="p">=</span> <span class="p">[</span><span class="mi">400</span><span class="p">;</span> <span class="mi">800</span><span class="p">;</span> <span class="mi">1200</span><span class="p">;</span> <span class="mi">2000</span><span class="p">];</span>
<span class="n">M0</span> <span class="p">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">;</span><span class="mi">1</span><span class="p">;</span><span class="mi">1</span><span class="p">;</span><span class="mi">1</span><span class="p">];</span> 

<span class="n">NTR</span> <span class="p">=</span> <span class="mi">3</span><span class="p">;</span>
<span class="n">flip1</span> <span class="p">=</span> <span class="mi">180</span><span class="p">;</span> <span class="n">flip2</span> <span class="p">=</span> <span class="mi">90</span><span class="p">;</span>
<span class="n">TR</span> <span class="p">=</span> <span class="mi">2000</span><span class="p">;</span> <span class="c">%ms</span>
<span class="n">TI</span> <span class="p">=</span> <span class="mi">750</span><span class="p">;</span> <span class="c">% ms</span>

<span class="n">dt</span> <span class="p">=</span> <span class="mi">5</span><span class="p">;</span> <span class="c">% ms</span>
<span class="n">t_per_TR</span> <span class="p">=</span> <span class="n">dt</span><span class="p">:</span><span class="n">dt</span><span class="p">:</span><span class="n">TR</span><span class="p">;</span>

<span class="c">% magnetization before each RF pulse</span>
<span class="n">Mz1_minus</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="nb">length</span><span class="p">(</span><span class="n">T1</span><span class="p">),</span> <span class="n">NTR</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
<span class="n">Mz2_minus</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="nb">length</span><span class="p">(</span><span class="n">T1</span><span class="p">),</span> <span class="n">NTR</span><span class="p">);</span>

<span class="c">% magnetization after each RF pulse</span>
<span class="n">Mz1_plus</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="nb">length</span><span class="p">(</span><span class="n">T1</span><span class="p">),</span> <span class="n">NTR</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
<span class="n">Mz2_plus</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="nb">length</span><span class="p">(</span><span class="n">T1</span><span class="p">),</span> <span class="n">NTR</span><span class="p">);</span>

<span class="c">% time of RF pulses</span>
<span class="n">t1_minus</span> <span class="p">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">NTR</span><span class="p">]</span><span class="o">*</span><span class="n">TR</span><span class="p">;</span> <span class="n">t1_plus</span> <span class="p">=</span> <span class="n">t1_minus</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>  <span class="c">% flip1, 180-degrees</span>
<span class="n">t2_minus</span> <span class="p">=</span> <span class="n">t1_minus</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="k">end</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">TI</span><span class="p">;</span> <span class="n">t2_plus</span> <span class="p">=</span> <span class="n">t1_plus</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="k">end</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">TI</span><span class="p">;</span>


<span class="c">% initial condition</span>
<span class="n">Mz1_minus</span><span class="p">(:,</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="n">M0</span><span class="p">;</span>
<span class="n">Mz1_plus</span><span class="p">(:,</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="n">Mz1_minus</span><span class="p">(:,</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="nb">cos</span><span class="p">(</span><span class="n">flip1</span><span class="o">*</span><span class="nb">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">);</span>
<span class="n">Mz_all</span> <span class="p">=</span> <span class="p">[</span><span class="n">Mz1_minus</span><span class="p">(:,</span><span class="mi">1</span><span class="p">),</span><span class="n">Mz1_plus</span><span class="p">(:,</span><span class="mi">1</span><span class="p">)];</span>
<span class="n">t</span><span class="p">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="nb">eps</span><span class="p">];</span>

<span class="k">for</span> <span class="no">I</span> <span class="p">=</span> <span class="mi">1</span><span class="p">:</span><span class="n">NTR</span>
    <span class="n">t</span> <span class="p">=</span> <span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="n">t_per_TR</span> <span class="o">+</span> <span class="p">(</span><span class="no">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">TR</span><span class="p">];</span>

    <span class="c">% evolve for TI period after 180-pulse</span>
    <span class="k">for</span> <span class="n">It</span> <span class="p">=</span> <span class="nb">find</span><span class="p">(</span><span class="n">t_per_TR</span> <span class="o">&lt;</span> <span class="n">TI</span><span class="p">)</span>
        <span class="n">Mz_all</span> <span class="p">=</span> <span class="p">[</span><span class="n">Mz_all</span><span class="p">,</span> <span class="n">Mz1_plus</span><span class="p">(:,</span><span class="no">I</span><span class="p">)</span><span class="o">.*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t_per_TR</span><span class="p">(</span><span class="n">It</span><span class="p">)</span><span class="o">./</span><span class="n">T1</span><span class="p">)</span> <span class="o">+</span> <span class="n">M0</span><span class="o">.*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t_per_TR</span><span class="p">(</span><span class="n">It</span><span class="p">)</span><span class="o">./</span><span class="n">T1</span><span class="p">))];</span>
    <span class="k">end</span>
    
    <span class="n">Mz2_minus</span><span class="p">(:,</span><span class="no">I</span><span class="p">)</span> <span class="p">=</span> <span class="n">Mz1_plus</span><span class="p">(:,</span><span class="no">I</span><span class="p">)</span><span class="o">.*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">TI</span><span class="o">./</span><span class="n">T1</span><span class="p">)</span> <span class="o">+</span> <span class="n">M0</span><span class="o">.*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">TI</span><span class="o">./</span><span class="n">T1</span><span class="p">));</span>
    <span class="n">Mz2_plus</span><span class="p">(:,</span><span class="no">I</span><span class="p">)</span> <span class="p">=</span> <span class="n">Mz2_minus</span><span class="p">(:,</span><span class="no">I</span><span class="p">)</span><span class="o">.*</span><span class="nb">cos</span><span class="p">(</span><span class="n">flip2</span><span class="o">*</span><span class="nb">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">);</span>

    <span class="k">for</span> <span class="n">It</span> <span class="p">=</span> <span class="nb">find</span><span class="p">(</span><span class="n">t_per_TR</span> <span class="o">&gt;</span><span class="p">=</span> <span class="n">TI</span><span class="p">)</span>
        <span class="n">Mz_all</span> <span class="p">=</span> <span class="p">[</span><span class="n">Mz_all</span><span class="p">,</span> <span class="n">Mz2_plus</span><span class="p">(:,</span><span class="no">I</span><span class="p">)</span><span class="o">.*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">t_per_TR</span><span class="p">(</span><span class="n">It</span><span class="p">)</span><span class="o">-</span><span class="n">TI</span><span class="p">)</span><span class="o">./</span><span class="n">T1</span><span class="p">)</span> <span class="o">+</span> <span class="n">M0</span><span class="o">.*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">t_per_TR</span><span class="p">(</span><span class="n">It</span><span class="p">)</span><span class="o">-</span><span class="n">TI</span><span class="p">)</span><span class="o">./</span><span class="n">T1</span><span class="p">))];</span>
    <span class="k">end</span>
    
    <span class="n">Mz1_minus</span><span class="p">(:,</span><span class="no">I</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="n">Mz2_plus</span><span class="p">(:,</span><span class="no">I</span><span class="p">)</span><span class="o">.*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">TR</span><span class="o">-</span><span class="n">TI</span><span class="p">)</span><span class="o">./</span><span class="n">T1</span><span class="p">)</span> <span class="o">+</span> <span class="n">M0</span><span class="o">.*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">TR</span><span class="o">-</span><span class="n">TI</span><span class="p">)</span><span class="o">./</span><span class="n">T1</span><span class="p">));</span>
    <span class="n">Mz1_plus</span><span class="p">(:,</span><span class="no">I</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="n">Mz1_minus</span><span class="p">(:,</span><span class="no">I</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">.*</span><span class="nb">cos</span><span class="p">(</span><span class="n">flip1</span><span class="o">*</span><span class="nb">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">);</span>

<span class="k">end</span>

<span class="nb">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Mz_all</span><span class="p">,</span> <span class="n">t1_minus</span><span class="p">,</span> <span class="n">Mz1_minus</span><span class="p">.</span><span class="o">&#39;</span><span class="p">,</span> <span class="s">&#39;x&#39;</span><span class="p">,</span> <span class="n">t1_plus</span><span class="p">,</span> <span class="n">Mz1_plus</span><span class="p">.</span><span class="o">&#39;</span><span class="p">,</span><span class="s">&#39;o&#39;</span><span class="p">,</span> <span class="n">t2_minus</span><span class="p">,</span> <span class="n">Mz2_minus</span><span class="p">,</span> <span class="s">&#39;x&#39;</span><span class="p">,</span> <span class="n">t2_plus</span><span class="p">,</span> <span class="n">Mz2_plus</span><span class="p">,</span><span class="s">&#39;o&#39;</span><span class="p">)</span>
<span class="nb">legend</span><span class="p">(</span><span class="n">int2str</span><span class="p">(</span><span class="n">T1</span><span class="p">))</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;time (ms)&#39;</span><span class="p">),</span> <span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;M_Z&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ans = -14.088
</pre></div>
</div>
<img alt="_images/0b514a0cb44b31279621c7727c4a14960075263d3d1b07eff0602df4922f01f1.png" src="_images/0b514a0cb44b31279621c7727c4a14960075263d3d1b07eff0602df4922f01f1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-octave notranslate"><div class="highlight"><pre><span></span><span class="c">% Inversion Recovery, TI vs T1</span>

<span class="n">TR</span> <span class="p">=</span> <span class="mi">2000</span><span class="p">;</span> <span class="c">% ms</span>
<span class="n">TI</span> <span class="p">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2000</span><span class="p">);</span> <span class="c">% ms</span>
<span class="n">T1v</span> <span class="p">=</span> <span class="p">[</span><span class="mi">400</span><span class="p">;</span> <span class="mi">800</span><span class="p">;</span> <span class="mi">1200</span><span class="p">;</span> <span class="mi">2000</span><span class="p">];</span> <span class="c">%linspace(200,2000)&#39;; % ms</span>
<span class="p">[</span><span class="n">T1</span> <span class="n">TI</span><span class="p">]</span> <span class="p">=</span> <span class="nb">meshgrid</span><span class="p">(</span><span class="n">T1v</span><span class="p">,</span><span class="n">TI</span><span class="p">);</span>
<span class="n">M0</span> <span class="p">=</span> <span class="nb">ones</span><span class="p">(</span><span class="nb">size</span><span class="p">(</span><span class="n">T1</span><span class="p">));</span>

<span class="n">S_TI</span> <span class="p">=</span> <span class="n">M0</span><span class="o">.*</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">TI</span><span class="o">./</span><span class="n">T1</span><span class="p">)</span> <span class="o">+</span> <span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">TR</span><span class="o">./</span><span class="n">T1</span><span class="p">));</span>

<span class="nb">plot</span><span class="p">(</span><span class="n">TI</span><span class="p">,</span><span class="n">S_TI</span><span class="p">)</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;TI (ms)&#39;</span><span class="p">),</span> <span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;signal&#39;</span><span class="p">)</span>
<span class="nb">legend</span><span class="p">(</span><span class="n">int2str</span><span class="p">(</span><span class="n">T1v</span><span class="p">))</span>
<span class="nb">title</span><span class="p">([</span><span class="s">&#39;Signal versus TI for various T_1 values with TR = &#39;</span> <span class="n">num2str</span><span class="p">(</span><span class="n">TR</span><span class="p">)</span> <span class="s">&#39; ms&#39;</span><span class="p">])</span>

<span class="n">TR</span> <span class="p">=</span> <span class="mi">2000</span><span class="p">;</span>
<span class="n">TI</span> <span class="p">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2000</span><span class="p">);</span> <span class="c">% ms</span>
<span class="n">T1</span> <span class="p">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span><span class="mi">2500</span><span class="p">);</span> <span class="c">% ms</span>
<span class="p">[</span><span class="n">T1</span> <span class="n">TI</span><span class="p">]</span> <span class="p">=</span> <span class="nb">meshgrid</span><span class="p">(</span><span class="n">T1</span><span class="p">,</span><span class="n">TI</span><span class="p">);</span>
<span class="n">M0</span> <span class="p">=</span> <span class="nb">ones</span><span class="p">(</span><span class="nb">size</span><span class="p">(</span><span class="n">T1</span><span class="p">));</span>

<span class="n">S_TI</span> <span class="p">=</span> <span class="n">M0</span><span class="o">.*</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">TI</span><span class="o">./</span><span class="n">T1</span><span class="p">)</span> <span class="o">+</span> <span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">TR</span><span class="o">./</span><span class="n">T1</span><span class="p">));</span>

<span class="nb">figure</span>

<span class="nb">mesh</span><span class="p">(</span><span class="n">T1</span><span class="p">,</span><span class="n">TI</span><span class="p">,</span><span class="n">S_TI</span><span class="p">)</span>
<span class="nb">view</span><span class="p">([</span><span class="mi">110</span> <span class="mi">30</span><span class="p">])</span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;TI (ms)&#39;</span><span class="p">),</span> <span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;T_1 (ms)&#39;</span><span class="p">),</span> <span class="nb">zlabel</span><span class="p">(</span><span class="s">&#39;signal&#39;</span><span class="p">)</span>
<span class="nb">colorbar</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ans = -30.492
</pre></div>
</div>
<img alt="_images/e38433691c56dc4f9fe48705f390e75c422071e67bc2040f8f730f6b8511233f.png" src="_images/e38433691c56dc4f9fe48705f390e75c422071e67bc2040f8f730f6b8511233f.png" />
<img alt="_images/010bd37705fdba240f37d665ed5664611f63d7916dec87a068300c4455b3183b.png" src="_images/010bd37705fdba240f37d665ed5664611f63d7916dec87a068300c4455b3183b.png" />
</div>
</div>
<section id="simple-contrast-phantom">
<h3>Simple Contrast Phantom<a class="headerlink" href="#simple-contrast-phantom" title="Permalink to this heading">#</a></h3>
<p>Below is a simple contrast phantom consisting of three circular objects, each with a different <span class="math notranslate nohighlight">\(T_1\)</span> and <span class="math notranslate nohighlight">\(T_2\)</span>.  The k-space data for these phantoms is created using a jinc function, which is the Fourier Transform of a circle:</p>
<div class="math notranslate nohighlight">
\[\mathcal{F}\{ \mathrm{circ}(r) \} = \mathrm{jinc}(k_r)\]</div>
<p>The signal is simulated for varying sequence parameters (TE, TR) with a 90-degree flip angle in a gradient-echo scheme by using the helper function:</p>
<div class="highlight-Octave notranslate"><div class="highlight"><pre><span></span><span class="n">signal_gre</span> <span class="p">=</span> <span class="n">MRsignal_spoiled_gradient_echo</span><span class="p">(</span><span class="n">flip</span><span class="p">,</span> <span class="n">TE</span><span class="p">,</span> <span class="n">TR</span><span class="p">,</span> <span class="n">M0</span><span class="p">,</span> <span class="n">T1</span><span class="p">,</span> <span class="n">T2</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-octave notranslate"><div class="highlight"><pre><span></span><span class="c">% contrast_phantom</span>


<span class="n">Nphan</span> <span class="p">=</span> <span class="mi">3</span><span class="p">;</span>
<span class="c">% phantom parameters</span>
<span class="n">xc</span> <span class="p">=</span> <span class="p">[</span><span class="o">-</span><span class="p">.</span><span class="mi">3</span> <span class="mi">0</span> <span class="p">.</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="mi">256</span><span class="p">;</span>  <span class="c">% x centers</span>
<span class="n">yc</span> <span class="p">=</span> <span class="p">[</span><span class="o">-</span><span class="p">.</span><span class="mi">25</span> <span class="p">.</span><span class="mi">25</span> <span class="o">-</span><span class="p">.</span><span class="mi">25</span><span class="p">]</span><span class="o">*</span><span class="mi">256</span><span class="p">;</span>  <span class="c">% y centers</span>
<span class="n">M0</span> <span class="p">=</span> <span class="p">[</span><span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span><span class="p">];</span> <span class="c">% relative proton densities</span>
<span class="n">T1</span> <span class="p">=</span> <span class="p">[.</span><span class="mi">3</span> <span class="p">.</span><span class="mi">8</span> <span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="mf">1e3</span><span class="p">;</span>  <span class="c">% T1 relaxation times (ms)</span>
<span class="n">T2</span> <span class="p">=</span> <span class="p">[.</span><span class="mi">06</span> <span class="p">.</span><span class="mi">06</span> <span class="p">.</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="mf">1e3</span><span class="p">;</span>  <span class="c">% T2 relaxation times (ms)</span>
<span class="n">r</span> <span class="p">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">64</span><span class="p">;</span>  <span class="c">% ball radius, where FOV = 1</span>

<span class="n">flip</span> <span class="p">=</span> <span class="mi">90</span><span class="o">*</span><span class="nb">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">;</span>
<span class="n">TEs</span> <span class="p">=</span> <span class="p">[</span><span class="mi">20</span> <span class="mi">160</span><span class="p">];</span> <span class="n">TRs</span> <span class="p">=</span> <span class="p">[</span><span class="mi">400</span> <span class="mi">3000</span><span class="p">];</span>

<span class="n">N</span> <span class="p">=</span> <span class="mi">256</span><span class="p">;</span>

<span class="c">% matrices with kx, ky coordinates</span>
<span class="p">[</span><span class="n">kx</span> <span class="n">ky</span><span class="p">]</span> <span class="p">=</span> <span class="nb">meshgrid</span><span class="p">([</span><span class="o">-</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">:</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">N</span><span class="p">);</span>

<span class="k">for</span> <span class="n">TE</span> <span class="p">=</span> <span class="n">TEs</span>
    <span class="k">for</span> <span class="n">TR</span> <span class="p">=</span> <span class="n">TRs</span>

<span class="c">% initialize k-space data matrix</span>
<span class="n">M</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">);</span>

<span class="c">% Generate k-space data by adding together k-space data for each</span>
<span class="c">% individual phantom</span>

<span class="k">for</span> <span class="n">n</span><span class="p">=</span> <span class="mi">1</span><span class="p">:</span><span class="n">Nphan</span>
    <span class="c">% Generates data using Fourier Transform of a circle (jinc) multiplied by complex exponential to shift center location</span>
    <span class="n">M</span> <span class="p">=</span> <span class="n">M</span><span class="o">+</span><span class="n">jinc</span><span class="p">(</span><span class="nb">sqrt</span><span class="p">(</span><span class="n">kx</span><span class="o">.^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">ky</span><span class="o">.^</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="p">)</span> <span class="o">.*</span> <span class="nb">exp</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="o">*</span> <span class="p">(</span><span class="n">kx</span><span class="o">*</span><span class="n">xc</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">+</span> <span class="n">ky</span><span class="o">*</span><span class="n">yc</span><span class="p">(</span><span class="n">n</span><span class="p">)))</span> <span class="o">*</span> <span class="p">...</span>
        <span class="n">MRsignal_spoiled_gradient_echo</span><span class="p">(</span><span class="n">flip</span><span class="p">,</span> <span class="n">TE</span><span class="p">,</span> <span class="n">TR</span><span class="p">,</span> <span class="n">M0</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="n">T1</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="n">T2</span><span class="p">(</span><span class="n">n</span><span class="p">));</span>


<span class="k">end</span>

<span class="c">% reconstruct and display ideal image</span>
<span class="n">m</span> <span class="p">=</span> <span class="n">ifft2c</span><span class="p">(</span><span class="n">M</span><span class="p">);</span>
<span class="nb">figure</span>
<span class="nb">imagesc</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">m</span><span class="p">)),</span> <span class="nb">colormap</span><span class="p">(</span><span class="nb">gray</span><span class="p">),</span> <span class="nb">axis</span> <span class="n">equal</span> <span class="n">tight</span>
<span class="nb">title</span><span class="p">([</span><span class="s">&#39;TE = &#39;</span> <span class="n">int2str</span><span class="p">(</span><span class="n">TE</span><span class="p">)</span> <span class="s">&#39;, TR = &#39;</span> <span class="n">int2str</span><span class="p">(</span><span class="n">TR</span><span class="p">)])</span>

<span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/bef7f329331a741e5ee5ceda4f94db8a48ff19ddd19cf1410818a305c232d0b5.png" src="_images/bef7f329331a741e5ee5ceda4f94db8a48ff19ddd19cf1410818a305c232d0b5.png" />
<img alt="_images/6e6a601e73556bd5bf337a9d72111f66e6e936b5351478a0553e8d23b30c06bd.png" src="_images/6e6a601e73556bd5bf337a9d72111f66e6e936b5351478a0553e8d23b30c06bd.png" />
<img alt="_images/ccc8a28703483e6908d2ecf943948b63a925d599801bd0e188ba610f2610dc2f.png" src="_images/ccc8a28703483e6908d2ecf943948b63a925d599801bd0e188ba610f2610dc2f.png" />
<img alt="_images/c3df6c4a8355ead03f63ecf57c460ebc7cc593b00f9e68decee88c094d5d6551.png" src="_images/c3df6c4a8355ead03f63ecf57c460ebc7cc593b00f9e68decee88c094d5d6551.png" />
</div>
</div>
<section id="challenge-yourself">
<h4>Challenge Yourself!<a class="headerlink" href="#challenge-yourself" title="Permalink to this heading">#</a></h4>
<p>Based on the images and TE/TR parameters above, can you estimate T1 and T2 relaxation times of the 3 objects?</p>
</section>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="contrast-agents">
<h1>Contrast Agents<a class="headerlink" href="#contrast-agents" title="Permalink to this heading">#</a></h1>
<p>Contrast agents used in MRI, such as gadolinium chelates and superparamagnetic iron oxides, shorten the relaxation rates wherever they are present.
This is quantified by their relaxivities, <span class="math notranslate nohighlight">\(r_1, r_2\)</span>, typiclaly in units of [L / (mmol s)]:</p>
<div class="math notranslate nohighlight">
\[\frac{1}{\hat{T}_1} = \frac{1}{T_1} + r_1 \cdot [CM]\]</div>
<div class="math notranslate nohighlight">
\[\frac{1}{\hat{T}_2} = \frac{1}{T_2} + r_2 \cdot [CM]\]</div>
<p>Where <span class="math notranslate nohighlight">\(\hat{T}_1, \hat{T}_2\)</span> are the relaxation time constants with the agent present, and <span class="math notranslate nohighlight">\([CM]\)</span> is the contrast agent concentration, typically in units of [mM = mmol/L].</p>
<!-- 

https://doi.org/10.1097/01.rli.0000184756.66360.d3

% MAGNETVIST R1 = 4.3 l/MMOL/S R2 = 4.4
% resovist (iron) r1 = 7  r2 = 77
% 0.5 mM 
></section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "octave"
        },
        kernelOptions: {
            name: "octave",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'octave'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="Magnetic%20Fields%20and%20RF%20Coils.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Magnetic fields in MRI</p>
      </div>
    </a>
    <a class="right-next"
       href="MRI%20Signal%20Equation.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Building Up the MRI Signal Equation</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">MRI Contrast</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#te-and-t2-t2">TE and T2/T2*</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tr-and-t1">TR and T1</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#degree-flip-angles">90-degree flip angles</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">&lt; 90-degree flip angles</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#proton-density-weighting-with-short-tr-and-small-flip-angles">Proton Density Weighting with short TR and small flip angles</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inversion-recovery">Inversion Recovery</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simple-contrast-phantom">Simple Contrast Phantom</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#challenge-yourself">Challenge Yourself!</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#contrast-agents">Contrast Agents</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Peder Larson
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
       Copyright 2021.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  Citation - DOI <a href="https://doi.org/10.5281/zenodo.5547020">10.5281/zenodo.5547020</a>
</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>